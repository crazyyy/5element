!function(){function b64_sha1(e){return binb2b64(core_sha1(str2binb(e),8*e.length))}function str_sha1(e){return binb2str(core_sha1(str2binb(e),8*e.length))}function b64_hmac_sha1(e,t){return binb2b64(core_hmac_sha1(e,t))}function str_hmac_sha1(e,t){return binb2str(core_hmac_sha1(e,t))}function core_sha1(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;var n,i,r,o,a,s,c,l,d=new Array(80),u=1732584193,p=-271733879,h=-1732584194,f=271733878,m=-1009589776;for(n=0;n<e.length;n+=16){for(o=u,a=p,s=h,c=f,l=m,i=0;80>i;i++)16>i?d[i]=e[n+i]:d[i]=rol(d[i-3]^d[i-8]^d[i-14]^d[i-16],1),r=safe_add(safe_add(rol(u,5),sha1_ft(i,p,h,f)),safe_add(safe_add(m,d[i]),sha1_kt(i))),m=f,f=h,h=rol(p,30),p=u,u=r;u=safe_add(u,o),p=safe_add(p,a),h=safe_add(h,s),f=safe_add(f,c),m=safe_add(m,l)}return[u,p,h,f,m]}function sha1_ft(e,t,n,i){return 20>e?t&n|~t&i:40>e?t^n^i:60>e?t&n|t&i|n&i:t^n^i}function sha1_kt(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function core_hmac_sha1(e,t){var n=str2binb(e);n.length>16&&(n=core_sha1(n,8*e.length));for(var i=new Array(16),r=new Array(16),o=0;16>o;o++)i[o]=909522486^n[o],r[o]=1549556828^n[o];var a=core_sha1(i.concat(str2binb(t)),512+8*t.length);return core_sha1(r.concat(a),672)}function safe_add(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}function rol(e,t){return e<<t|e>>>32-t}function str2binb(e){for(var t=[],n=255,i=0;i<8*e.length;i+=8)t[i>>5]|=(e.charCodeAt(i/8)&n)<<24-i%32;return t}function binb2str(e){for(var t="",n=255,i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>24-i%32&n);return t}function binb2b64(e){for(var t,n,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",o=0;o<4*e.length;o+=3)for(t=(e[o>>2]>>8*(3-o%4)&255)<<16|(e[o+1>>2]>>8*(3-(o+1)%4)&255)<<8|e[o+2>>2]>>8*(3-(o+2)%4)&255,n=0;4>n;n++)r+=8*o+6*n>32*e.length?"=":i.charAt(t>>6*(3-n)&63);return r}var rhLocalName="rhLocal"+Math.random().toString().substring(2,8);window.rhGlobal=window.rhGlobal||{},rhGlobal.modules=rhGlobal.modules||[];var old=rhGlobal.define;rhGlobal.define=function(e,t,n,i){function r(){define?define(e,t,n):setTimeout(r,100)}r(),i||rhGlobal.modules.push({a:e,b:t,c:n}),old&&old(e,t,n,!0)},rhGlobal.define.amd=!0,rhGlobal.define.rhLocalName=rhLocalName;var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,r){(n||!hasProp(e,r))&&(!i||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[r]=t:(e[r]||(e[r]={}),mixin(e[r],t,n,i)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,i){var r=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=i,n&&(r.originalError=n),r}function newContext(e){function t(e){var t,n;for(t=0;t<e.length;t++)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var r,o,a,s,c,l,d,u,p,h,f,m,E=n&&n.split("/"),_=S.map,v=_&&_["*"];if(e&&(e=e.split("/"),d=e.length-1,S.nodeIdCompat&&jsSuffixRegExp.test(e[d])&&(e[d]=e[d].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&E&&(m=E.slice(0,E.length-1),e=m.concat(e)),t(e),e=e.join("/")),i&&_&&(E||v)){a=e.split("/");e:for(s=a.length;s>0;s-=1){if(l=a.slice(0,s).join("/"),E)for(c=E.length;c>0;c-=1)if(o=getOwn(_,E.slice(0,c).join("/")),o&&(o=getOwn(o,l))){u=o,p=s;break e}!h&&v&&getOwn(v,l)&&(h=getOwn(v,l),f=s)}!u&&h&&(u=h,p=f),u&&(a.splice(0,p,u),e=a.join("/"))}return r=getOwn(S.pkgs,e),r?r:e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===O.contextName?(t.parentNode.removeChild(t),!0):void 0})}function r(e){var t=getOwn(S.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),O.require.undef(e),O.makeRequire(null,{skipMap:!0})([e]),!0):void 0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function a(e,t,i,r){var a,s,c,l,d=null,u=t?t.name:null,p=e,h=!0,f="";return e||(h=!1,e="_@r"+(w+=1)),l=o(e),d=l[0],e=l[1],d&&(d=n(d,u,r),s=getOwn(I,d)),e&&(d?f=s&&s.normalize?s.normalize(e,function(e){return n(e,u,r)}):-1===e.indexOf("!")?n(e,u,r):e:(f=n(e,u,r),l=o(f),d=l[0],f=l[1],i=!0,a=O.nameToUrl(f))),c=!d||s||i?"":"_unnormalized"+(x+=1),{prefix:d,name:f,parentMap:t,unnormalized:!!c,url:a,originalName:p,isDefine:h,id:(d?d+"!"+f:f)+c}}function s(e){var t=e.id,n=getOwn(L,t);return n||(n=L[t]=new O.Module(e)),n}function c(e,t,n){var i=e.id,r=getOwn(L,i);!hasProp(I,i)||r&&!r.defineEmitComplete?(r=s(e),r.error&&"error"===t?n(r.error):r.on(t,n)):"defined"===t&&n(I[i])}function l(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=getOwn(L,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function d(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(O.defQueueMap[t]=!0),R.push(e)}),globalDefQueue=[])}function u(e){delete L[e],delete N[e]}function p(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,r){var o=i.id,a=getOwn(L,o);!a||e.depMatched[r]||n[o]||(getOwn(t,o)?(e.defineDep(r,I[o]),e.check()):p(a,t,n))}),n[i]=!0)}function h(){var e,t,n=1e3*S.waitSeconds,o=n&&O.startTime+n<(new Date).getTime(),a=[],s=[],c=!1,d=!0;if(!v){if(v=!0,eachProp(N,function(e){var n=e.map,l=n.id;if(e.enabled&&(n.isDefine||s.push(e),!e.error))if(!e.inited&&o)r(l)?(t=!0,c=!0):(a.push(l),i(l));else if(!e.inited&&e.fetched&&n.isDefine&&(c=!0,!n.prefix))return d=!1}),o&&a.length)return e=makeError("timeout","Load timeout for modules: "+a,null,a),e.contextName=O.contextName,l(e);d&&each(s,function(e){p(e,{},{})}),o&&!t||!c||!isBrowser&&!isWebWorker||A||(A=setTimeout(function(){A=0,h()},50)),v=!1}}function f(e){hasProp(I,e[0])||s(a(e[0],null,!0)).init(e[1],e[2])}function m(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function E(e){var t=e.currentTarget||e.srcElement;return m(t,O.onScriptLoad,"load","onreadystatechange"),m(t,O.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function _(){var e;for(d();R.length;){if(e=R.shift(),null===e[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}O.defQueueMap={}}var v,g,O,T,A,S={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},L={},N={},y={},R=[],I={},C={},b={},w=1,x=1;return T={require:function(e){return e.require?e.require:e.require=O.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?I[e.map.id]=e.exports:e.exports=I[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(S.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},g=function(e){this.events=getOwn(y,e.id)||{},this.map=e,this.shim=getOwn(S.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},g.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,O.startTime=(new Date).getTime();var e=this.map;return this.shim?void O.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;C[e]||(C[e]=!0,O.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){try{r=O.execCb(n,o,i,r)}catch(a){e=a}if(this.map.isDefine&&void 0===r&&(t=this.module,t?r=t.exports:this.usingExports&&(r=this.exports)),e){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",l(this.error=e);"undefined"!=typeof console&&console.error||req.onError(e)}}else r=o;if(this.exports=r,this.map.isDefine&&!this.ignore&&(I[n]=r,req.onResourceLoad)){var s=[];each(this.depMaps,function(e){s.push(e.normalizedMap||e)}),req.onResourceLoad(O,this.map,s)}u(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(O.defQueueMap,n)||this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=a(e.prefix);this.depMaps.push(i),c(i,"defined",bind(this,function(i){var r,o,d,p=getOwn(b,this.map.id),h=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,m=O.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(h=i.normalize(h,function(e){return n(e,f,!0)})||""),o=a(e.prefix+"!"+h,this.map.parentMap),c(o,"defined",bind(this,function(e){this.map.normalizedMap=o,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),d=getOwn(L,o.id),void(d&&(this.depMaps.push(o),this.events.error&&d.on("error",bind(this,function(e){this.emit("error",e)})),d.enable()))):p?(this.map.url=O.nameToUrl(p),void this.load()):(r=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),r.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(L,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&u(e.map.id)}),l(e)}),r.fromText=bind(this,function(n,i){var o=e.name,c=a(o),d=useInteractive;i&&(n=i),d&&(useInteractive=!1),s(c),hasProp(S.config,t)&&(S.config[o]=S.config[t]);try{req.exec(n)}catch(u){return l(makeError("fromtexteval","fromText eval for "+t+" failed: "+u,u,[t]))}d&&(useInteractive=!0),this.depMaps.push(c),O.completeLoad(o),m([o],r)}),void i.load(e.name,m,r,S))})),O.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){N[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,r;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,r=getOwn(T,e.id))return void(this.depExports[t]=r(this));this.depCount+=1,c(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?c(e,"error",bind(this,this.errback)):this.events.error&&c(e,"error",bind(this,function(e){this.emit("error",e)}))}n=e.id,i=L[n],hasProp(T,n)||!i||i.enabled||O.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(L,e.id);t&&!t.enabled&&O.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},O={config:S,contextName:e,registry:L,defined:I,urlFetched:C,defQueue:R,defQueueMap:{},Module:g,makeModuleMap:a,nextTick:req.nextTick,onError:l,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=S.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(S[t]||(S[t]={}),mixin(S[t],e,!0,!0)):S[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(b[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,n){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=O.makeShimExports(e)),t[n]=e}),S.shim=t),e.packages&&each(e.packages,function(e){var t,n;e="string"==typeof e?{name:e}:e,n=e.name,t=e.location,t&&(S.paths[n]=e.location),S.pkgs[n]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(L,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t,null,!0))}),(e.deps||e.callback)&&O.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,r){function o(n,i,c){var d,u,p;return r.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof n?isFunction(i)?l(makeError("requireargs","Invalid require call"),c):t&&hasProp(T,n)?T[n](L[t.id]):req.get?req.get(O,n,t,o):(u=a(n,t,!1,!0),d=u.id,hasProp(I,d)?I[d]:l(makeError("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(_(),O.nextTick(function(){_(),p=s(a(null,t)),p.skipMap=r.skipMap,p.init(n,i,c,{enabled:!0}),h()}),o)}return r=r||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var i,r=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==r&&(!a||r>1)&&(i=e.substring(r,e.length),e=e.substring(0,r)),O.nameToUrl(n(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(I,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(I,e)||hasProp(L,e)}}),t||(o.undef=function(e){d();var n=a(e,t,!0),r=getOwn(L,e);r.undefed=!0,i(e),delete I[e],delete C[n.url],delete y[e],eachReverse(R,function(t,n){t[0]===e&&R.splice(n,1)}),delete O.defQueueMap[e],r&&(r.events.defined&&(y[e]=r.events),u(e))}),o},enable:function(e){var t=getOwn(L,e.id);t&&s(e).enable()},completeLoad:function(e){var t,n,i,o=getOwn(S.shim,e)||{},a=o.exports;for(d();R.length;){if(n=R.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);f(n)}if(O.defQueueMap={},i=getOwn(L,e),!t&&!hasProp(I,e)&&i&&!i.inited){if(!(!S.enforceDefine||a&&getGlobal(a)))return r(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));f([e,o.deps||[],o.exportsFn])}h()},nameToUrl:function(e,t,n){var i,r,o,a,s,c,l,d=getOwn(S.pkgs,e);if(d&&(e=d),l=getOwn(b,e))return O.nameToUrl(l,t,n);if(req.jsExtRegExp.test(e))s=e+(t||"");else{for(i=S.paths,r=e.split("/"),o=r.length;o>0;o-=1)if(a=r.slice(0,o).join("/"),c=getOwn(i,a)){isArray(c)&&(c=c[0]),r.splice(0,o,c);break}s=r.join("/"),s+=t||(/^data\:|\?/.test(s)||n?"":".js"),s=("/"===s.charAt(0)||s.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+s}return S.urlArgs?s+((-1===s.indexOf("?")?"?":"&")+S.urlArgs):s},load:function(e,t){req.load(O,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=E(e);O.completeLoad(t.id)}},onScriptError:function(e){var t=E(e);if(!r(t.id)){var n=[];return eachProp(L,function(e,i){0!==i.indexOf("_@r")&&each(e.depMaps,function(e){return e.id===t.id&&n.push(i),!0})}),l(makeError("scripterror",'Script error for "'+t.id+(n.length?'", needed by: '+n.join(", "):'"'),e,[t.id]))}}},O.require=O.makeRequire(),O}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.22",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var r,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=i):e=[]),o&&o.context&&(a=o.context),r=getOwn(contexts,a),r||(r=contexts[a]=req.s.newContext(a)),o&&r.configure(o),r.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var i=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return i.type=e.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i},req.load=function(e,t,n){var i,r=e&&e.config||{};if(isBrowser)return i=req.createNode(r,t,n),r.onNodeCreated&&r.onNodeCreated(i,r,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,n){var i,r;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),r=contexts[i.getAttribute("data-requirecontext")])),r?(r.defQueue.push([e,t,n]),r.defQueueMap[e]=!0):globalDefQueue.push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("almond",function(){}),define("common/extensions/compatibility",[],function(){"function"!=typeof Date.now&&(Date.now=function(){return(new Date).getTime()}),"bind"in Function.prototype||(Function.prototype.bind=function(e){var t=this;if(arguments.length<=1)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,0===arguments.length?n:n.concat(Array.prototype.slice.call(arguments)))}}),"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"indexOf"in Array.prototype&&"function"==typeof Array.prototype.indexOf&&-1==[].indexOf(0)||(Array.prototype.indexOf=function(e,t){void 0===t&&(t=0),0>t&&(t+=this.length),0>t&&(t=0);for(var n=this.length;n>t;t++)if(this[t]===e)return t;return-1}),"lastIndexOf"in Array.prototype||(Array.prototype.lastIndexOf=function(e,t){for(void 0===t&&(t=this.length-1),0>t&&(t+=this.length),t>this.length-1&&(t=this.length-1),t++;t-- >0;)if(t in this&&this[t]===e)return t;return-1}),"forEach"in Array.prototype||(Array.prototype.forEach=function(e,t){for(var n=0,i=this.length;i>n;n++)n in this&&e.call(t,this[n],n,this)}),"map"in Array.prototype||(Array.prototype.map=function(e,t){for(var n=new Array(this.length),i=0,r=this.length;r>i;i++)i in this&&(n[i]=e.call(t,this[i],i,this));return n}),"filter"in Array.prototype||(Array.prototype.filter=function(e,t){for(var n,i=[],r=0,o=this.length;o>r;r++)r in this&&e.call(t,n=this[r],r,this)&&i.push(n);return i}),"every"in Array.prototype||(Array.prototype.every=function(e,t){for(var n=0,i=this.length;i>n;n++)if(n in this&&!e.call(t,this[n],n,this))return!1;return!0}),"some"in Array.prototype||(Array.prototype.some=function(e,t){for(var n=0,i=this.length;i>n;n++)if(n in this&&e.call(t,this[n],n,this))return!0;return!1}),"reduce"in Array.prototype||(Array.prototype.reduce=function(e,t){if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,i,r=this.length>>>0,o=!1;for(1<arguments.length&&(i=t,o=!0),n=0;r>n;++n)this.hasOwnProperty(n)&&(o?i=e(i,this[n],n,this):(i=this[n],o=!0));if(!o)throw new TypeError("Reduce of empty array with no initial value");return i}),JSON&&"function"!=typeof JSON.stringify&&(JSON.stringify=JSON.encode),JSON&&"function"!=typeof JSON.parse&&(JSON.parse=JSON.decode),window.rhlpSetInterval=function(e,t){var n=function(){try{e()}catch(i){}setTimeout(n,t)};n()},window.rhlpSetRealInterval=function(e,t){var n=Math.ceil(1e3/t),i=function(){setTimeout(i,n*t);for(var r=0;n>r;r++)setTimeout(function(){e()},r*t)};i()}}),define("common/extensions/browserDetect",[],function(){var e={init:function(){this.browser=this.searchString(this.dataBrowser)||"-",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"",this.OS=this.searchString(this.dataOS)||"-","Opera"===this.browser&&(navigator.userAgent.split("Version/")[1]?this.version=navigator.userAgent.split("Version/")[1]:this.version=parseFloat(navigator.userAgent.split("OPR/")[1]).toFixed(1)),this.isMobile=navigator.userAgent.indexOf("Mobile")>-1},searchString:function(e){var t;for(t=0;t<e.length;t++){var n=e[t].string,i=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,n){if(-1!==n.indexOf(e[t].subString))return e[t].identity+(e[t].version?" "+e[t].version():"")}else if(i)return e[t].identity+(e[t].version?" "+e[t].version():"")}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);return-1!==t?parseFloat(e.substring(t+this.versionSearchString.length+1)):void 0},dataBrowser:[{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"OPR/",identity:"Opera"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:navigator.userAgent,subString:"Safari",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko/",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"}],dataOS:[{string:navigator.userAgent,subString:"Android",identity:"android",version:function(){return navigator.userAgent.substr(navigator.userAgent.indexOf("Android ")+8,3)}},{string:navigator.platform,subString:"Win",identity:"windows",version:function(){var e=navigator.userAgent.substr(navigator.userAgent.indexOf("NT ")+3,3);switch(e){case"6.3":return"8.1";case"6.2":return"8";case"6.1":return"7";case"6.0":return"Vista";case"5.1":return"XP";case"5.0":return"2000";case"4.1":return"NT 4.1";default:return""}}},{string:navigator.platform,subString:"Mac",identity:"mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.userAgent,subString:"iPod",identity:"iOS"},{string:navigator.platform,subString:"Linux",identity:"linux"}],isMobile:!1};return e.init(),e}),define("common/extensions/debug",[],function(){return{log:function(e){},eventLog:function(e){},sessionLog:function(e){},info:function(e){},clear:function(){},debug:function(e){},time:function(e){},timeEnd:function(e){},profile:function(){},profileEnd:function(){},error:function(e){},assert:function(e,t){}}}),define("common/application/eventTarget",["common/extensions/debug"],function(e){function t(e,t){this.message=t,this.name="Custom Event Exception",this.target=e}var n=function(e){this._listeners={},this.targetName=e};return n.prototype={addEventListener:function(n,i){var r="dispatcher_"+n;if(void 0===n||""===n||"number"==typeof n&&isNaN(n)||null===n)throw new t(this.targetName,"empty type");if("function"!=typeof i)throw new t(this.targetName,"provided listener for event type "+n+" is not a function");this._listeners[r]instanceof Array||(this._listeners[r]=[]);for(var o in this._listeners[r])if(this._listeners[o]===i)return void e.eventLog("Listener already exists:\ntargetName="+this.targetName+", type="+n);this._listeners[r].push(i);try{e.eventLog("New event listener added:\ntargetName="+this.targetName+", type="+n)}catch(a){}},addOneShotEventListener:function(e,t){var n=function(){this.removeEventListener(e,n),t.apply(this,arguments)};this.addEventListener(e,n)},removeAllEventListeners:function(t){var n="dispatcher_"+t;if(this._listeners[n]){this._listeners[n]=[];try{e.eventLog("All listeners were removed\ntargetName="+this.targetName+", type="+t)}catch(i){}}},removeEventListener:function(t,n){var i="dispatcher_"+t;if(this._listeners[i]){var r=this._listeners[i].indexOf(n);if(-1!==r){this._listeners[i].splice(r,1);try{e.eventLog("One listener was removed\ntargetName="+this.targetName+", type="+t)}catch(o){}}}},fire:function(n,i,r){var o=n;if("string"==typeof n&&(n={type:n}),n._target||(n._target=this),!n.type)throw new t(this.targetName,"Event missing 'type' property");if("object"==typeof i)for(var a in i)"webkitStorageInfo"!=a&&"webkitIndexedDB"!=a&&(i.hasOwnProperty=i.hasOwnProperty||Object.prototype.hasOwnProperty,i.hasOwnProperty(a)&&(n[a]=i[a]));else"function"==typeof i&&(r=i,i=null);var s=0,c="dispatcher_"+("string"==typeof o?o:n.type);if(this._listeners[c])for(var l=this._listeners[c].slice(0),d=l.length;d>s;s++)if(l[s])try{l[s].call(this,n)}catch(u){e.error(u)}if("*"!==n.type){var p="*";if(this._listeners[p])for(var l=this._listeners[p],d=l.length;d>s;s++)try{l[s].call(this,n)}catch(u){e.error(u)}}if("function"==typeof r)try{r()}catch(u){e.error(u)}if(i&&!i.isMessageTarget)try{e.eventLog("Event was fired, "+s+" listeners was called:\ntargetName="+this.targetName+", type="+n.type)}catch(u){}}},n}),define("application/dispatcher",["common/application/eventTarget"],function(e){var t=new e("Chat");return t}),define("jquery-private",["jquery"],function(e){return e.noConflict(!0)}),define("common/extensions/customScrollbar",["jquery"],function(e){!function(t,n){function i(e,n,i){e._eventHandlers=e._eventHandlers||[{element:e.scroller,handler:function(t){e.scroll(t)},type:"scroll"},{element:e.scroller,handler:function(){e.update()},type:"keyup"},{element:e.bar,handler:function(t){t.preventDefault(),e.selection(),e.drag.now=1},type:"touchstart mousedown"},{element:document,handler:function(){e.selection(1),e.drag.now=0},type:"mouseup blur touchend"},{element:document,handler:function(t){2!=t.button&&e._pos0(t)},type:"touchstart mousedown"},{element:document,handler:function(t){e.drag.now&&e.drag(t)},type:"mousemove touchmove"},{element:t,handler:function(){e.update()},type:"resize"},{element:e.root,handler:function(){e.update()},type:"sizeChange"}],p(e._eventHandlers,function(e){e.element&&n(e.element,e.type,e.handler,i)})}function r(e,t,n){var i="data-baron-"+t;if("on"==n)e.setAttribute(i,"inited");else{if("off"!=n)return e.getAttribute(i);e.removeAttribute(i)}}function o(e){if(r(e.root,e.direction))throw new Error("Second baron initialization");var t=new f.prototype.constructor(e);return i(t,e.event,"on"),r(t.root,e.direction,"on"),t.update({initMode:!0}),t}function a(e){var t={};e=e||{};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function s(e){var t=a(e);t.direction=t.direction||"v";var n=e.event||function(e,n,i,r){t.$(e)[r||"on"](n,i)};return t.event=function(e,t,i,r){p(e,function(e){n(e,t,i,r)})},t}function c(e){if(this.events&&this.events[e])for(var t=0;t<this.events[e].length;t++){var n=Array.prototype.slice.call(arguments,1);this.events[e][t].apply(this,n)}}if(t){var l=h,d=["left","top","right","bottom","width","height"],u={v:{x:"Y",pos:d[1],oppos:d[3],crossPos:d[0],crossOpPos:d[2],size:d[5],crossSize:d[4],client:"clientHeight",crossClient:"clientWidth",crossScroll:"scrollWidth",offset:"offsetHeight",crossOffset:"offsetWidth",offsetPos:"offsetTop",scroll:"scrollTop",scrollSize:"scrollHeight"},h:{x:"X",pos:d[0],oppos:d[2],crossPos:d[1],crossOpPos:d[3],size:d[4],crossSize:d[5],client:"clientWidth",crossClient:"clientHeight",crossScroll:"scrollHeight",offset:"offsetWidth",crossOffset:"offsetHeight",offsetPos:"offsetLeft",scroll:"scrollLeft",scrollSize:"scrollWidth"}},p=function(e,i){var r=0;for((e.length===n||e===t)&&(e=[e]);e[r];)i.call(this,e[r],r),r++},h=function(e){var n,i,r;return e=e||{},r=e.$||t.jQuery,n=this instanceof r,n?e.root=i=this:i=r(e.root||e.scroller),new h.fn.constructor(i,e,r)};h.fn={constructor:function(e,t,n){var i=s(t);i.$=n,p.call(this,e,function(e,t){var n=a(i);i.root&&i.scroller?(n.scroller=i.$(i.scroller,e),n.scroller.length||(n.scroller=e)):n.scroller=e,n.root=e,this[t]=o(n),this.length=t+1}),this.params=i},dispose:function(){var e=this.params;p(this,function(t){t.dispose(e)}),this.params=null},update:function(){for(var e=0;this[e];)this[e].update.apply(this[e],arguments),e++},baron:function(e){return e.root=[],e.scroller=this.params.scroller,p.call(this,this,function(t){e.root.push(t.root)}),e.direction="v"==this.params.direction?"h":"v",e._chain=!0,h(e)}};var f={};f.prototype={constructor:function(e){function t(e,t){return d(e,t)[0]}function i(e){var t=this.barMinSize||20;e>0&&t>e&&(e=t),this.bar&&d(this.bar).css(this.origin.size,parseInt(e,10)+"px")}function r(e){this.bar&&d(this.bar).css(this.origin.pos,+e+"px")}function o(){return f[this.origin.client]-this.barTopLimit-this.bar[this.origin.offset]}function a(e){return e*o.call(this)+this.barTopLimit}function s(e){return(e-this.barTopLimit)/o.call(this)}function l(){return!1}var d,p,h,f,m,E,_,v,g,O,T;return O=g=(new Date).getTime(),d=this.$=e.$,this.event=e.event,this.events={},this.root=e.root,this.scroller=t(e.scroller),this.bar=t(e.bar,this.root),f=this.track=t(e.track,this.root),
!this.track&&this.bar&&(f=this.bar.parentNode),this.clipper=this.scroller.parentNode,this.direction=e.direction,this.origin=u[this.direction],this.barOnCls=e.barOnCls,this.scrollingCls=e.scrollingCls,this.barTopLimit=0,v=1e3*e.pause||0,this.cursor=function(e){return e["client"+this.origin.x]||(((e.originalEvent||e).touches||{})[0]||{})["page"+this.origin.x]},this.pos=function(e){var t="page"+this.origin.x+"Offset",i=this.scroller[t]?t:this.origin.scroll;return e!==n&&(this.scroller[i]=e),this.scroller[i]},this.rpos=function(e){var t,n=this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client];return t=e?this.pos(e*n):this.pos(),t/(n||1)},this.barOn=function(e){this.barOnCls&&(e||this.scroller[this.origin.client]>=this.scroller[this.origin.scrollSize]?d(this.root).removeClass(this.barOnCls):d(this.root).addClass(this.barOnCls))},this._pos0=function(e){h=this.cursor(e)-p},this.drag=function(e){this.scroller[this.origin.scroll]=s.call(this,this.cursor(e)-h)*(this.scroller[this.origin.scrollSize]-this.scroller[this.origin.client])},this.selection=function(e){this.event(document,"selectpos selectstart",l,e?"off":"on")},this.resize=function(){function t(){var t,i;n.barOn(),i=n.scroller[n.origin.crossClient],t=n.scroller[n.origin.crossOffset]-i,e.freeze&&!n.clipper.style[n.origin.crossSize]&&d(n.clipper).css(n.origin.crossSize,n.clipper[n.origin.crossClient]-t+"px"),d(n.scroller).css(n.origin.crossSize,n.clipper[n.origin.crossClient]+t+"px"),Array.prototype.unshift.call(arguments,"resize"),c.apply(n,arguments),O=(new Date).getTime()}var n=this,i=0;(new Date).getTime()-O<v&&(clearTimeout(m),i=v),i?m=setTimeout(t,i):t()},this.updatePositions=function(){var e,t=this;t.bar&&(e=(f[t.origin.client]-t.barTopLimit)*t.scroller[t.origin.client]/t.scroller[t.origin.scrollSize],parseInt(T,10)!=parseInt(e,10)&&(i.call(t,e),T=e),p=a.call(t,t.rpos()),r.call(t,p)),Array.prototype.unshift.call(arguments,"scroll"),c.apply(t,arguments),g=(new Date).getTime()},this.scroll=function(){var e=0,t=this;(new Date).getTime()-g<v&&(clearTimeout(E),e=v),(new Date).getTime()-g<v&&(clearTimeout(E),e=v),e?E=setTimeout(function(){t.updatePositions()},e):t.updatePositions(),t.scrollingCls&&(_||this.$(this.scroller).addClass(this.scrollingCls),clearTimeout(_),_=setTimeout(function(){t.$(t.scroller).removeClass(t.scrollingCls),_=n},300))},this},update:function(e){return c.call(this,"upd",e),this.resize(1),this.updatePositions(),this},dispose:function(t){i(this,this.event,"off"),r(this.root,t.direction,"off"),e(this.scroller).css(this.origin.crossSize,""),this.barOn(!0),c.call(this,"dispose")},on:function(e,t,n){for(var i=e.split(" "),r=0;r<i.length;r++)"init"==i[r]?t.call(this,n):(this.events[i[r]]=this.events[i[r]]||[],this.events[i[r]].push(function(e){t.call(this,e||n)}))}},h.fn.constructor.prototype=h.fn,f.prototype.constructor.prototype=f.prototype,h.noConflict=function(){return t.baron=l,h},h.version="0.7.7",e&&e.fn&&(e.fn.baron=h),t.baron=h,t.module&&module.exports&&(module.exports=h.noConflict())}}(window),function(e,t){var n=function(e){function n(e,n,i){var r=1==i?"pos":"oppos";s<(c.minView||0)&&(n=t),this.$(a[e]).css(this.origin.pos,"").css(this.origin.oppos,"").removeClass(c.outside),n!==t&&(n+="px",this.$(a[e]).css(this.origin[r],n).addClass(c.outside))}function r(e){try{i=document.createEvent("WheelEvent"),i.initWebKitWheelEvent(e.originalEvent.wheelDeltaX,e.originalEvent.wheelDeltaY),p.dispatchEvent(i),e.preventDefault()}catch(e){}}function o(e){var t;for(var n in e)c[n]=e[n];if(a=this.$(c.elements,this.scroller)){s=this.scroller[this.origin.client];for(var i=0;i<a.length;i++)t={},t[this.origin.size]=a[i][this.origin.offset],a[i].parentNode!==this.scroller&&this.$(a[i].parentNode).css(t),t={},t[this.origin.crossSize]=a[i].parentNode[this.origin.crossClient],this.$(a[i]).css(t),s-=a[i][this.origin.offset],u[i]=a[i].parentNode[this.origin.offsetPos],l[i]=l[i-1]||0,d[i]=d[i-1]||Math.min(u[i],0),a[i-1]&&(l[i]+=a[i-1][this.origin.offset],d[i]+=a[i-1][this.origin.offset]),(0!=i||0!=u[i])&&(this.event(a[i],"mousewheel",r,"off"),this.event(a[i],"mousewheel",r));c.limiter&&a[0]&&(this.track&&this.track!=this.scroller?(t={},t[this.origin.pos]=a[0].parentNode[this.origin.offset],this.$(this.track).css(t)):this.barTopLimit=a[0].parentNode[this.origin.offset],this.scroll()),c.limiter===!1&&(this.barTopLimit=0)}var o={element:a,handler:function(){for(var e,t=f(this)[0].parentNode,n=t.offsetTop,i=0;i<a.length;i++)a[i]===this&&(e=i);var r=n-l[e];c.scroll?c.scroll({x1:m.scroller.scrollTop,x2:r}):m.scroller.scrollTop=r},type:"click"};c.clickable&&(this._eventHandlers.push(o),h(o.element,o.type,o.handler,"on"))}var a,s,c={outside:"",inside:"",before:"",after:"",past:"",future:"",radius:0,minView:0},l=[],d=[],u=[],p=this.scroller,h=this.event,f=this.$,m=this;this.on("init",o,e);var E=[],_=[];this.on("init scroll",function(){var e,i,r;if(a){for(var o,p=0;p<a.length;p++)e=0,u[p]-this.pos()<d[p]+c.radius?(e=1,i=l[p]):u[p]-this.pos()>d[p]+s-c.radius?(e=2,i=this.scroller[this.origin.client]-a[p][this.origin.offset]-l[p]-s):(e=3,i=t),r=!1,(u[p]-this.pos()<d[p]||u[p]-this.pos()>d[p]+s)&&(r=!0),(e!=E[p]||r!=_[p])&&(n.call(this,p,i,e),E[p]=e,_[p]=r,o=!0);if(o)for(p=0;p<a.length;p++)1==E[p]&&c.past&&this.$(a[p]).addClass(c.past).removeClass(c.future),2==E[p]&&c.future&&this.$(a[p]).addClass(c.future).removeClass(c.past),3==E[p]?((c.future||c.past)&&this.$(a[p]).removeClass(c.past).removeClass(c.future),c.inside&&this.$(a[p]).addClass(c.inside)):c.inside&&this.$(a[p]).removeClass(c.inside),E[p]!=E[p+1]&&1==E[p]&&c.before?this.$(a[p]).addClass(c.before).removeClass(c.after):E[p]!=E[p-1]&&2==E[p]&&c.after?this.$(a[p]).addClass(c.after).removeClass(c.before):this.$(a[p]).removeClass(c.before).removeClass(c.after),c.grad&&(_[p]?this.$(a[p]).addClass(c.grad):this.$(a[p]).removeClass(c.grad))}}),this.on("resize upd",function(e){o.call(this,e&&e.fix)})};baron.fn.fix=function(e){for(var t=0;this[t];)n.call(this[t],e),t++;return this}}(window),function(e,t){var n=function(e){var t,n,i,r,o,a=this;r=e.screen||.9,e.forward&&(t=this.$(e.forward,this.clipper),o={element:t,handler:function(){var t=a.pos()-e.delta||30;a.pos(t)},type:"click"},this._eventHandlers.push(o),this.event(o.element,o.type,o.handler,"on")),e.backward&&(n=this.$(e.backward,this.clipper),o={element:n,handler:function(){var t=a.pos()+e.delta||30;a.pos(t)},type:"click"},this._eventHandlers.push(o),this.event(o.element,o.type,o.handler,"on")),e.track&&(i=e.track===!0?this.track:this.$(e.track,this.clipper)[0],i&&(o={element:i,handler:function(e){var t=e["offset"+a.origin.x],n=a.bar[a.origin.offsetPos],i=0;n>t?i=-1:t>n+a.bar[a.origin.offset]&&(i=1);var o=a.pos()+i*r*a.scroller[a.origin.client];a.pos(o)},type:"mousedown"},this._eventHandlers.push(o),this.event(o.element,o.type,o.handler,"on")))};baron.fn.controls=function(e){for(var t=0;this[t];)n.call(this[t],e),t++;return this}}(window),function(e,t){var n=function(e){function t(){return _.scroller[_.origin.scroll]+_.scroller[_.origin.offset]}function n(){return _.scroller[_.origin.scrollSize]}function i(){return _.scroller[_.origin.client]}function r(e,t){var n=5e-4*e;return Math.floor(t-n*(e+550))}function o(e){d=e,e?(a(),s=setInterval(a,200)):clearInterval(s)}function a(){var a,s,d={},A=t(),S=n(),L=1==v;if(s=0,v>0&&(s=40),a=r(O,s),A>=S-O&&v>-1?L&&(O+=a):O=0,0>O&&(O=0),d[p]=O+"px",i()<=n()){_.$(u).css(d);for(var N=0;N<m.length;N++)_.$(m[N].self).css(m[N].property,Math.min(O/h*100,100)+"%")}E&&O&&_.$(_.root).addClass(E),0==O&&e.onCollapse&&e.onCollapse(),v=0,c=setTimeout(function(){v=-1},T),f&&O>h&&!l&&(f(),l=!0),0==O?g++:g=0,g>1&&(o(!1),l=!1,E&&_.$(_.root).removeClass(E))}var s,c,l,d,u=this.$(e.block),p=e.size||this.origin.size,h=e.limit||80,f=e.onExpand,m=e.elements||[],E=e.inProgress||"",_=this,v=0,g=0,O=0,T=e.waiting||500;this.on("init",function(){o(!0)}),this.on("dispose",function(){o(!1)}),this.event(this.scroller,"mousewheel DOMMouseScroll",function(e){var i=e.wheelDelta<0||e.originalEvent&&e.originalEvent.wheelDelta<0||e.detail>0;i&&(v=1,clearTimeout(c),!d&&t()>=n()&&o(!0))})};baron.fn.pull=function(e){for(var t=0;this[t];)n.call(this[t],e),t++;return this}}(window),function(e,t){var n=e.MutationObserver||e.WebKitMutationObserver||e.MozMutationObserver||null,i=function(){var e=this;this._observer=new MutationObserver(function(){e.update()}),this.on("init",function(){e._observer.observe(e.root,{childList:!0,subtree:!0,characterData:!0})}),this.on("dispose",function(){e._observer.dissconect(),delete e._observer})};baron.fn.autoUpdate=function(e){if(!n)return this;for(var t=0;this[t];)i.call(this[t],e),t++;return this}}(window)}),define("common/extensions/jquery.disableSelection",["jquery","common/extensions/browserDetect"],function(e,t){"Firefox"===t.browser?(e.fn.disableTextSelect=function(){return this.each(function(){e(this).css("MozUserSelect","none")})},e.fn.enableTextSelect=function(){return this.each(function(){e(this).css("MozUserSelect","")})}):navigator&&navigator.userAgent&&navigator.userAgent.indexOf("WebKit")>-1?(e.fn.disableTextSelect=function(){return this.each(function(){e(this).css("-webkit-user-select","none")})},e.fn.enableTextSelect=function(){return this.each(function(){e(this).css("-webkit-user-select","")})}):"Explorer"===t.browser?(e.fn.disableTextSelect=function(){return this.each(function(){e(this).bind("selectstart.disableTextSelect",function(){return!1})})},e.fn.enableTextSelect=function(){return this.each(function(){e(this).unbind("selectstart.disableTextSelect")})}):(e.fn.disableTextSelect=function(){return this.each(function(){e(this).bind("mousedown.disableTextSelect",function(){return!1})})},e.fn.enableTextSelect=function(){return this.each(function(){e(this).unbind("mousedown.disableTextSelect")})})}),define("common/extensions/jquery.easing",["jquery"],function(e){e.easing.rh_expIn=function(e,t,n,i){return 0==t?n:n+i*Math.pow(2,10*(e-1))},e.easing.rh_expOut=function(e,t,n,i){return 1==e?n+i:n+i*(1-Math.pow(2,-10*e))},e.easing.rh_in=function(e,t,n,i){return n+i*e*e*(3*e-2)},e.easing.rh_out=function(e,t,n,i){return n+i*((e-1)*(e-1)*(3*(e-1)+2)+1)},e.easing.rh_bounce=function(e,t,n,i){var r=1/2.75;return r>e?n+i*(7.5625*e*e):2*r>e?n+i*(7.5625*(e-1.5*r)*(e-1.5*r)+.75):2.5*r>e?n+i*(7.5625*(e-2.25*r)*(e-2.25*r)+.9375):n+i*(7.5625*(e-2.625*r)*(e-2.625*r)+.984375)}}),define("common/extensions/jquery.fix",["jquery"],function(e){function t(e){return"object"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}e.fn.oldIs=e.fn.oldIs||e.fn.is,e.fn.is=function(e){return":visible"==e?"none"!=this.css("display")&&this.oldIs(":visible"):this.oldIs(e)},e.fn.oldFind=e.fn.oldFind||e.fn.find,e.fn.find=function(e){var n=this.oldFind(e),i=n[0];return i&&i[0]&&!t(i)&&(n=i),n},e.fn.oldHeight=e.fn.oldHeight||e.fn.height,e.fn.height=function(){return this[0]===window?window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight:this.oldHeight()},e.acceptData=function(t){if("string"==typeof t.nodeName){var n=e.noData[t.nodeName.toLowerCase()];if(n)return!(n===!0||t.getAttribute("classid")!==n)}return!0}}),define("common/extensions/jquery.getpath",["jquery"],function(e){function t(e){for(var t=[],n=[],i=e,r=Number(new Date);i.length;){var o=i[0];if(void 0!==o.path&&r-o.pathTime<1e3){n.push(o.path);break}var a=o.localName||o.tagName||o.nodeName;if(!a||"#document"==a)break;a=a.toLowerCase();var s=i.parent(),c=s.children(a);c.length>1&&(a+=":eq("+c.index(i)+")"),t.push(i[0]),n.push(a),i=s}var l=t.length,d=n.pop();n.length===t.length&&n.length>0&&(d=d+">"+n.pop());for(var u=l-1;u>=0;u--)t[u].path=d,t[u].pathTime=r,u>0&&(d+=">"+n[u-1]);return d}e.fn.getPath=function(){if(0==this.length)throw"Requires one element.";return t(this)}}),define("common/extensions/jquery.getvisible",["jquery"],function(e){return e.fn.getVisible=function(){if(this.length<=1)return this;var t=function(t){if(!e(t).is(":visible"))return{top:0,left:0,width:0,height:0};var n={left:parseInt(e(t).css("padding-left")),right:parseInt(e(t).css("padding-right")),top:parseInt(e(t).css("padding-top")),bottom:parseInt(e(t).css("padding-bottom"))};for(var i in n)n[i]!=n[i]&&(n[i]=0);var r={left:parseInt(e(t).css("border-left-width")),right:parseInt(e(t).css("border-right-width")),top:parseInt(e(t).css("border-top-width")),bottom:parseInt(e(t).css("border-bottom-width"))};for(i in r)r[i]!=r[i]&&(r[i]=0);var o=e(t).offset();return o.width=e(t).width()+n.left+n.right+r.left+r.right,o.height=e(t).height()+n.top+n.bottom+r.top+r.bottom,o},n=function(e,t){return e.left+e.width>t.left&&t.left+t.width>e.left&&e.top+e.height>t.top&&t.top+t.height>e.top},i={left:e(window).scrollLeft(),top:e(window).scrollTop(),width:e(window).width(),height:e(window).height()},r=null;return e.each(this,function(e,o){return n(i,t(o))?(r=o,!1):void 0}),e(r)},e}),define("common/extensions/jquery.maskedinput",["jquery"],function(e){return function(e){function t(){var e=document.createElement("input"),t="onpaste";return e.setAttribute(t,""),"function"==typeof e[t]?"paste":"input"}var n,i=t()+".mask",r=navigator.userAgent,o=/iphone/i.test(r),a=/android/i.test(r);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({caret:function(e,t){var n;return 0===this.length||this.is(":hidden")?void 0:"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&(n=this.createTextRange(),n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),e=0-n.duplicate().moveStart("character",-1e5),t=e+n.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(t,r){var s,c,l,d,u,p;return!t&&this.length>0?(s=e(this[0]),s.data(e.mask.dataName)()):(r=e.extend({placeholder:e.mask.placeholder,completed:null},r),c=e.mask.definitions,l=[],d=p=t.length,u=null,e.each(t.split(""),function(e,t){"?"==t?(p--,d=e):c[t]?(l.push(new RegExp(c[t])),null===u&&(u=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function s(e){for(;++e<p&&!l[e];);return e}function h(e){for(;--e>=0&&!l[e];);return e}function f(e,t){var n,i;if(!(0>e)){for(n=e,i=s(t);p>n;n++)if(l[n]){if(!(p>i&&l[n].test(A[i])))break;A[n]=A[i],A[i]=r.placeholder,i=s(i)}g(),T.caret(Math.max(u,e))}}function m(e){var t,n,i,o;for(t=e,n=r.placeholder;p>t;t++)if(l[t]){if(i=s(t),o=A[t],A[t]=n,!(p>i&&l[i].test(o)))break;n=o}}function E(e){var t,n,i,r=e.which;8===r||46===r||o&&127===r?(t=T.caret(),n=t.begin,i=t.end,i-n===0&&(n=46!==r?h(n):i=s(n-1),i=46===r?s(i):i),v(n,i),f(n,i-1),e.preventDefault()):27==r&&(T.val(S),T.caret(0,O()),e.preventDefault())}function _(t){var n,i,o,c=t.which,d=T.caret();t.ctrlKey||t.altKey||t.metaKey||32>c||c&&(d.end-d.begin!==0&&(v(d.begin,d.end),f(d.begin,d.end-1)),n=s(d.begin-1),p>n&&(i=String.fromCharCode(c),l[n].test(i)&&(m(n),A[n]=i,g(),o=s(n),a?setTimeout(e.proxy(e.fn.caret,T,o),0):T.caret(o),r.completed&&o>=p&&r.completed.call(T))),t.preventDefault())}function v(e,t){var n;for(n=e;t>n&&p>n;n++)l[n]&&(A[n]=r.placeholder)}function g(){T.val(A.join(""))}function O(e){var t,n,i=T.val(),o=-1;for(t=0,pos=0;p>t;t++)if(l[t]){for(A[t]=r.placeholder;pos++<i.length;)if(n=i.charAt(pos-1),l[t].test(n)){A[t]=n,o=t;break}if(pos>i.length)break}else A[t]===i.charAt(pos)&&t!==d&&(pos++,o=t);return e?g():d>o+1?(T.val(""),v(0,p)):(g(),T.val(T.val().substring(0,o+1))),d?t:u}var T=e(this),A=e.map(t.split(""),function(e,t){return"?"!=e?c[e]?r.placeholder:e:void 0}),S=T.val();T.data(e.mask.dataName,function(){return e.map(A,function(e,t){return l[t]&&e!=r.placeholder?e:null}).join("")}),T.attr("readonly")||T.one("unmask",function(){T.unbind(".mask").removeData(e.mask.dataName)}).bind("focus.mask",function(){T.removeClass("placeholder"),clearTimeout(n);var e;S=T.val(),e=O(),n=setTimeout(function(){g(),e==t.length?T.caret(0,e):T.caret(e)},10)}).bind("blur.mask",function(){O(),T.val()!=S?T.change():T.addClass("placeholder")}).bind("keydown.mask",E).bind("keypress.mask",_).bind(i,function(){setTimeout(function(){var e=O(!0);T.caret(e),r.completed&&e==T.val().length&&r.completed.call(T)},0)}),O()}))}})}(e),e}),define("common/extensions/jquery.minbox",["jquery"],function(e){var t=function(e){var t={"font-family":e.css("font-family"),"font-size":e.css("font-size"),"font-weight":e.css("font-weight"),"line-height":e.css("line-height")};return t},n=function(n,i,r){r=r||4048;var o=0,a=t(n),s=e("<div/>").css(a).html(n.html());s.css("float","left"),s.css("height",i+"px"),s.appendTo("body"),o=s.width(),s.css("height","auto"),s.css("float","none"),s.css("width",r/2);var c=1,l=r,d=l;for(l/=2;Math.abs(d-l)>c;)s.height()<=i?(d=l,l/=2):l=(d+l)/2,s.css("width",l);var u;return u=s.height()>i?d:l,s.remove(),u>1?u:o};e.fn.minBox=function(e){return n(this,e)}}),define("common/extensions/jquery.placeholder",["jquery"],function(e){!function(e,t,n){function i(e){var t={},i=/^jQuery\d+$/;return n.each(e.attributes,function(e,n){n.specified&&!i.test(n.name)&&(t[n.name]=n.value)}),t}function r(e,t){var i=this,r=n(i);if(r.hasClass("placeholder"))if(r.data("placeholder-password")){if(r=r.hide().next().show().attr("id",r.removeAttr("id").data("placeholder-id")),e===!0)return r[0].value=t;r.focus()}else i.value="",r.removeClass("placeholder"),i==a()&&i.select()}function o(){var e,t=this,o=n(t),a=this.id;if(""==t.value){if("password"==t.type){if(!o.data("placeholder-textinput")){try{e=o.clone().attr({type:"text"})}catch(s){e=n("<input>").attr(n.extend(i(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":o,"placeholder-id":a}).bind("focus.placeholder",r),o.data({"placeholder-textinput":e,"placeholder-id":a}).before(e)}o=o.removeAttr("id").hide().prev().attr("id",a).show()}o.addClass("placeholder"),o[0].value=o.attr("placeholder")}else o.removeClass("placeholder")}function a(){try{return t.activeElement}catch(e){}}var s,c,l="placeholder"in t.createElement("input"),d="placeholder"in t.createElement("textarea"),u=n.fn,p=n.valHooks,h=n.propHooks;l&&d?(c=u.placeholder=function(){return this},c.input=c.textarea=!0):(c=u.placeholder=function(){var e=this;return e.filter((l?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":r,"blur.placeholder":o}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},c.input=l,c.textarea=d,s={get:function(e){var t=n(e),i=t.data("placeholder-password");return i?i[0].value:t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,t){var i=n(e),s=i.data("placeholder-password");return s?s[0].value=t:i.data("placeholder-enabled")?(""==t?(e.value=t,e!=a()&&o.call(e)):i.hasClass("placeholder")?r.call(e,!0,t)||(e.value=t):e.value=t,i):e.value=t}},l||(p.input=s,h.value=s),d||(p.textarea=s,h.value=s),n(function(){n(t).delegate("form","submit.placeholder",function(){var e=n(".placeholder",this).each(r);setTimeout(function(){e.each(o)},10)})}),n(e).bind("beforeunload.placeholder",function(){n(".placeholder").each(function(){this.value=""})}))}(window,document,e)}),define("common/extensions/jquery.postMessage",["jquery"],function(e){window.postMessage&&(e.postMessage=function(e,t){e.postMessage(t,"*")},e.receiveMessage=function(e){window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent&&window.attachEvent("onmessage",e)})}),define("common/extensions/jquery.pulse",["jquery"],function(e){e.fn.pulse=function(t){var n=e(this).css("opacity");e(this).animate({opacity:0},{duration:100,queue:!0}).animate({opacity:n},{duration:120,queue:!0}).animate({opacity:0},{duration:150,queue:!0}).animate({opacity:n},{duration:170,queue:!0}).animate({opacity:0},{duration:200,queue:!0}).animate({opacity:n},{duration:300,queue:!0}).animate({opacity:0},{duration:600,queue:!0,complete:function(){e(this).hide().css("opacity",n),t()}})}}),define("common/extensions/jquery.plugins",["jquery","common/extensions/customScrollbar","common/extensions/jquery.disableSelection","common/extensions/jquery.easing","common/extensions/jquery.fix","common/extensions/jquery.getpath","common/extensions/jquery.getvisible","common/extensions/jquery.maskedinput","common/extensions/jquery.minbox","common/extensions/jquery.placeholder","common/extensions/jquery.postMessage","common/extensions/jquery.pulse"],function(e){return e}),define("common/constants/type",{STRING:0,BOOLEAN:1,INTEGER:2,OBJECT:3}),define("common/extensions/base64",[],function(){var e={CA:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",CAS:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",IA:new Array(256),IAS:new Array(256),isUtf8:function(e){for(var t=!1,n=0;n<e.length;n++)if(e.charCodeAt(n)>255){t=!0;break}return t},toByteArray:function(e,t){var n,i,r=[];for(t="undefined"!=typeof t?t:!0,n=0;n<e.length;n++)i=e.charCodeAt(n),127>=i||!t?r.push(i):2047>=i?(r.push(i>>6|192),r.push(63&i|128)):65535>=i?(r.push(i>>12|224),r.push(i>>6&63|128),r.push(63&i|128)):(r.push(i>>18|240),r.push(i>>12&63|128),r.push(i>>6&63|128),r.push(63&i|128));return r},fromByteArray:function(e,t){var n,i="",r=0;for(t="undefined"!=typeof t?t:!0,r=0;r<e.length;r++)n=e[r],127>=n||!t||(192==(224&n)?(n=(31&n)<<6,n+=63&e[++r]):224==(240&n)?(n=(15&n)<<12,n+=(63&e[++r])<<6,n+=63&e[++r]):(n=(7&n)<<18,n+=(63&e[++r])<<12,n+=(63&e[++r])<<6,n+=63&e[++r])),0!==n&&(i+=String.fromCharCode(n));return i},init:function(){var t;for(t=0;256>t;t++)e.IA[t]=-1,e.IAS[t]=-1;for(t=0,iS=e.CA.length;t<iS;t++)e.IA[e.CA.charCodeAt(t)]=t,e.IAS[e.CAS.charCodeAt(t)]=t;e.IA["="]=e.IAS["="]=0},encode:function(t,n){var i,r,o,a,s,c,l,d,u,p;for(i=n?e.CAS:e.CA,o=t.constructor==Array?t:e.toByteArray(t),a=o.length,s=a/3*3,c=(a-1)/3+1<<2,r=new Array(c),l=0,d=0;s>l;)p=(255&o[l++])<<16|(255&o[l++])<<8|255&o[l++],r[d++]=i.charAt(p>>18&63),r[d++]=i.charAt(p>>12&63),r[d++]=i.charAt(p>>6&63),r[d++]=i.charAt(63&p);u=a-s,u>0&&(p=(255&o[s])<<10|(2==u?(255&o[a-1])<<2:0),r[c-4]=i.charAt(p>>12),r[c-3]=i.charAt(p>>6&63),r[c-2]=2==u?i.charAt(63&p):"=",r[c-1]="=");var h=r.join("");return h},decode:function(t,n){var i,r,o,a,s,c,l,d,u,p,h,f,m,E,_,v;for(i=n?e.IAS:e.IA,t.constructor==Array?(o=t,s=!0):(o=e.toByteArray(t),s=!1),a=o.length,c=0,l=a-1;l>c&&i[o[c]]<0;)c++;for(;l>0&&i[o[l]]<0;)l--;for(d="="==o[l]?"="==o[l-1]?2:1:0,u=l-c+1,p=a>76?("\r"==o[76]?u/78:0)<<1:0,h=(6*(u-p)>>3)-d,r=new Array(h),f=0,m=0,eLen=h/3*3;f<eLen;)E=i[o[c++]]<<18|i[o[c++]]<<12|i[o[c++]]<<6|i[o[c++]],r[f++]=E>>16&255,r[f++]=E>>8&255,r[f++]=255&E,p>0&&19==++m&&(c+=2,m=0);if(h>f){for(E=0,_=0;l-d>=c;_++)E|=i[o[c++]]<<18-6*_;for(v=16;h>f;v-=8)r[f++]=E>>v&255}return s?r:e.fromByteArray(r)},_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeOld:function(t,n){var i,r,o,a,s,c,l,d="",u=0;for(t=e._UTF8Encode(t,n);u<t.length;)i=t.charCodeAt(u++),r=t.charCodeAt(u++),o=t.charCodeAt(u++),a=i>>2,s=(3&i)<<4|r>>4,c=(15&r)<<2|o>>6,l=63&o,isNaN(r)?c=l=64:isNaN(o)&&(l=64),d=d+this._keyStr.charAt(a)+this._keyStr.charAt(s)+this._keyStr.charAt(c)+this._keyStr.charAt(l);return d},decodeOld:function(t,n){var i,r,o,a,s,c,l,d="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/=]/g,"");u<t.length;)a=this._keyStr.indexOf(t.charAt(u++)),s=this._keyStr.indexOf(t.charAt(u++)),c=this._keyStr.indexOf(t.charAt(u++)),l=this._keyStr.indexOf(t.charAt(u++)),i=a<<2|s>>4,r=(15&s)<<4|c>>2,o=(3&c)<<6|l,d+=String.fromCharCode(i),64!==c&&(d+=String.fromCharCode(r)),64!==l&&(d+=String.fromCharCode(o));return d=e._UTF8Decode(d,n)},_UTF8Encode:function(e,t){return e=e.replace(/\r\n/g,"\n"),t?encodeURIComponent(e):unescape(encodeURIComponent(e))},_UTF8Decode:function(e,t){return t?decodeURIComponent(e):decodeURIComponent(escape(e))}};return e.init(),e}),define("common/constants/scope",{LOCAL:0,SESSION:1,STORAGE:2}),define("common/application/session",["common/extensions/jquery.plugins","common/application/eventTarget","common/constants/type","common/extensions/debug","common/extensions/base64","common/constants/scope"],function(e,t,n,i,r,o){function a(e){return e===o.STORAGE?localStorage:e===o.LOCAL?f:sessionStorage}function s(e,t,i){var r;switch("undefined"==typeof t&&(t=n.STRING),!e&&i&&(e=m.get(i)),t){case n.BOOLEAN:var o=e.toLowerCase();r="true"===o||"yes"===o||"ok"===o||"1"===o;break;case n.INTEGER:r=+e,!r&&i&&(r=+m.get(i)),r!==r&&(r=0);break;case n.OBJECT:try{if(r=JSON.parse(e),"string"==typeof r)try{r=JSON.parse(r)}catch(a){}}catch(a){r=void 0}break;default:r=e}return r}if(!window.sessionStorage||!window.localStorage)return{};var c=null,l=function(){},d=null,u="",p=!1,h="",f={setItem:function(e,t){f[e+""]=t+""},getItem:function(e){return f[e+""]?f[e+""]:null}},m=e.extend(new Image,{dispatcher:new t("Session"),init:function(e,t){h="rhlp."+e+".",c=t,m.fields=[];for(var r in c)c.hasOwnProperty(r)&&!function(e){var t=function(){var t=m.get(e),n=s(t,c[e].type,c[e].fallback);return c[e].value&&""===t?c[e].value:n},i=function(t){if(t===t&&void 0!==t&&null!==t){var i=c[e].scope,r=c[e].type;r===n.OBJECT&&(t=JSON.stringify(t)),void 0===i&&(i=o.SESSION),m.set(e,t,i)}};!Object.__defineGetter__&&Object.defineProperty?Object.defineProperty(m,e,{get:t,set:i}):m.__defineGetter__&&(m.__defineGetter__(e,t),m.__defineSetter__(e,i)),m.fields.push(e)}(r);var a=function(e){if((!e.storageArea||e.storageArea!==sessionStorage)&&"key"in e&&0===e.key.indexOf(h)){var t=e.key.substr(h.length);m.dispatcher.fire("on"+t.charAt(0).toUpperCase()+t.substr(1)+"Changed",{inCurrentTab:!1})}};window.addEventListener?(window.addEventListener("storage",a,!1),window.addEventListener("onstorage",a,!1)):(window.attachEvent("onstorage",a),document.attachEvent("onstorage",a)),i.sessionLog(["INIT | ",h])},onLoad:function(e){"function"==typeof e&&(l=e),(!d||p)&&l()},get:function(e){if(!c[e])return"";var t=e;e=h+e;var n=a(c[t].scope);return null!==n.getItem(e)?n.getItem(e):""},set:function(e,t,n,r){if(!r&&d&&d.send("updateSession",{name:e,value:t,scope:n}),m.get(e)!==""+t){var o=e;e=h+e;var s=a(n);s.setItem(e,t),m.dispatcher.fire("on"+o.charAt(0).toUpperCase()+o.substr(1)+"Changed",{inCurrentTab:!0}),i.sessionLog("STORAGE | "+e+" = "+t)}},attachTo:function(e,t,i){d=e,u=i,d.addHandler("initSession",function(e){e=JSON.parse(e.value);for(var i in e)e.hasOwnProperty(i)&&(t[i].priority||(t[i].priority="external"),t[i]&&u!==t[i].priority&&(t[i].type===n.OBJECT&&(e[i]=JSON.stringify(e[i])),m.set(i,e[i],t[i].scope,!0)));p=!0,"function"==typeof l&&l()}),d.addHandler("requestSession",function(e){e=JSON.parse(e.value);var t={};for(var n in e)e.hasOwnProperty(n)&&"undefined"!=typeof m[n]&&(t[n]=m[n]);d.send("initSession",{value:JSON.stringify(t)})}),d.addHandler("updateSession",function(e){t[e.name]&&(t[e.name].type===n.OBJECT&&(e.value=JSON.stringify(e.value)),m.set(e.name,e.value,e.scope,!0))})},clear:function(e){for(var t in c)if(c.hasOwnProperty(t)){if(!e&&"vid"===t)continue;m[t]=c[t].value||""}},sendRequest:function(){d.send("requestSession",{value:JSON.stringify(c)})}});return m}),define("common/communication/encoder",["common/extensions/base64"],function(e){return{serialize:function(e){return JSON.stringify(e)},parse:function(e){return JSON.parse(e)},compress:function(t){return e.encodeOld(JSON.stringify(t))},decompress:function(t){return JSON.parse(e.decodeOld(t))}}}),define("config/setup",["common/communication/encoder"],function(e){var t;try{t=e.decompress(location.hash.split("#")[1])}catch(n){t={url:"http://rhlp.net"+location.search}}var i=location.href.indexOf("test.")>-1?"test.":"",r={DEBUG:!1,SHOW_EVENTS:!1,SHOW_SESSION:!1,WEBSOCKET:!1,XMPP_DOMAIN:"xmpp.redhelper.ru",DATA_URL:location.protocol+"//dh7xgsr9ech2h.cloudfront.net",BOSH_SERVICE:location.protocol+"//"+location.host+"/http-bind/",WS_SERVICE:"wss://"+i+"xmpp.redhelper.ru:80/ws-xmpp",NX_URL:~location.href.indexOf(".com/")?location.protocol+"//"+i+"web.redhelper.com/nx/":location.protocol+"//"+i+"web.redhelper.ru/nx/",APP_URL:location.protocol+"//"+location.host+"/",CLIENT_NAME:location.href.split("?")[1].split("c=")[1].split("&")[0].split("#")[0].toLowerCase(),PARENT_URI:t.url,PARENT_URL:t.url.split("//")[0]+"//"+t.url.split("//")[1].split("/")[0],STANDALONE:location.href.indexOf("&standalone")>-1,REQUIRE_OPERATOR:null,CURRENT_URL:"",CURRENT_TITLE:"",QUEUE_DELAY_COUNT:0,COMPANY_ID:t.companyId};r.FILE_UPLOAD=r.APP_URL+"nx/upload",r.FILE_FRAME=r.APP_URL+"chat/upload.html",r.RATE_URL=r.APP_URL+"nx/rate";try{localStorage.getItem("rhlp.debug")&&(r.DEBUG=!0)}catch(n){}return r.getImageUrl=function(e){if(e&&~e.indexOf("://"))return e;var t=["Ava_default.png","Ava_man_1.jpg","Ava_woman_1.jpg","Ava_def_man.png","Ava_man_2.jpg","Ava_woman_2.jpg","Ava_def_woman.png","Ava_man_3.jpg","Ava_woman_3.jpg"];return-1!==t.indexOf(e)?r.APP_URL+"container/images/common/avatar/"+e:r.DATA_URL+"/images/"+e},r.empty=function(e){return void 0===e||""===e||"number"==typeof e&&isNaN(e)||null===e},Number.prototype.toVisitorJid=function(){return this+"@visitor."+r.XMPP_DOMAIN},String.prototype.toVisitorJid=function(){return this+"@visitor."+r.XMPP_DOMAIN},String.prototype.toOperatorJid=function(){return this.split("@")[0]+"@operator."+r.XMPP_DOMAIN},String.prototype.extractNode=function(){var e=this.indexOf("@");return e>-1?this.slice(0,e):this},r}),define("common/constants/chatState",{MINIMIZED:0,INVITATION:1,MAXIMIZED:2,WINDOW:3}),define("common/constants/chatWindowStage",{UNKNOWN:-1,OFFLINE_FORM:0,ONLINE:1,DEPARTMENTS:2}),define("common/communication/messageTarget",["common/extensions/jquery.plugins","common/application/eventTarget","common/communication/encoder","common/extensions/debug"],function(e,t,n,i){function r(){this._dispatcher=new t("MessageTarget"),this._fireCounter=1;var e=[],n=!1;this.queueMessage=function(t,n){e.push({type:t,obj:n})},this.startMessaging=function(){n=!0;for(var t=0,i=e.length;i>t;t++)this.send(e[t].type,e[t].obj)},this.isAllowed=function(){return n},this.allow=function(){n=!0}}return r.prototype={init:function(t,n,r,o){this._targetUri=r,this._targetWindow=t,this._origin=n,o&&this.allow();var a=this;try{e.receiveMessage(function(e){a._handle(e)})}catch(s){i.error(s)}},_handle:function(e){try{if("string"!=typeof e.data||-1===e.data.indexOf("__rh__"))return}catch(t){return void i.log(t)}var r=n.parse(e.data.replace("__rh__",""));if(r._messageType)if(r.isMessageTarget=!0,r._messageId){var o=this;this._dispatcher.fire(r._messageType,{type:r._messageType,obj:r},function(){o.send("msg-handlers-completed-"+r._messageId)})}else this._dispatcher.fire(r._messageType,{type:r._messageType,obj:r})},setOrigin:function(e){this._origin=e},addHandler:function(e,t){this._dispatcher.addEventListener(e,function(e){t(e.obj)})},removeHandler:function(e,t){this._dispatcher.removeEventListener(e,t)},removeHandlers:function(e){this._dispatcher.removeAllEventListeners(e)},send:function(t,i,r){if(!this.isAllowed())return void this.queueMessage(t,i);if("undefined"==typeof i?i={}:"function"==typeof i&&"undefined"==typeof r?(r=i,i={}):"object"!=typeof i&&(i={value:i}),i._messageType=t,"function"==typeof r){i._messageId=this._fireCounter++;var o=this,a=function(){o.removeHandlers("msg-handlers-completed-"+i._messageId),r()};this.addHandler("msg-handlers-completed-"+i._messageId,a)}var s="__rh__"+n.serialize(i);e.postMessage(this._targetWindow,s,this._origin,this._targetUri)}},r}),define("application/parent",["common/communication/messageTarget","config/setup"],function(e,t){var n=new e;return t.STANDALONE||(n.init(parent,t.PARENT_URL,t.PARENT_URI,!0),n.startMessaging()),n}),define("application/session.objects",["application/dispatcher","common/application/session","config/setup","common/constants/scope","common/constants/type","common/constants/chatState","common/constants/chatWindowStage","common/extensions/jquery.plugins","application/parent"],function(e,t,n,i,r,o,a,s,c){var l={activeSalesShown:{type:r.BOOLEAN,value:!1,
scope:i.STORAGE,priority:"internal"},allowed:{type:r.BOOLEAN,scope:i.STORAGE,value:!0},audioEnabled:{value:!0,type:r.BOOLEAN,scope:i.STORAGE,priority:"internal"},badge:{value:"badge1.png",scope:i.LOCAL},badgeColor:{},badgeFontSize:{type:r.INTEGER,value:0},badgePadding:{type:r.INTEGER,value:0},badgePosition:{value:"left",scope:i.LOCAL},badgeText:{},badgeX:{value:"70%"},badgeY:{value:"40%"},byEnter:{value:!1,type:r.BOOLEAN},cachedEvent:{},chatColor:{},chatHeight:{type:r.INTEGER,fallback:"defaultChatHeight"},chatIntensity:{},chatStarted:{value:"",scope:i.STORAGE,priority:"internal"},chatState:{type:r.INTEGER,value:o.MINIMIZED},chatWidth:{type:r.INTEGER,fallback:"defaultChatWidth"},chatWindowStage:{type:r.INTEGER,scope:i.STORAGE,priority:"internal",value:a.UNKNOWN},chatX:{type:r.INTEGER},chatY:{type:r.INTEGER},chosenOperators:{},city:{scope:i.SESSION},city_ru:{scope:i.SESSION},cloneSession:{type:r.BOOLEAN},commandQueue:{scope:i.STORAGE,value:"[]"},companyId:{type:r.INTEGER,value:0},compress:{type:r.BOOLEAN,value:!1},contactsGot:{type:r.BOOLEAN,scope:i.STORAGE},country:{scope:i.SESSION},country_ru:{scope:i.SESSION},currentChatHeight:{type:r.INTEGER},currentChatWidth:{type:r.INTEGER},currentChatX:{type:r.INTEGER},currentChatY:{type:r.INTEGER},currentDepartment:{type:r.INTEGER,value:0,scope:i.STORAGE,priority:"internal"},currentDepartmentName:{scope:i.STORAGE},currentFirstMessage:{},currentHeader:{},currentOfflineHeader:{},currentOfflineText:{},currentOperator:{scope:i.STORAGE,priority:"internal"},currentOperAvatar:{scope:i.SESSION},currentTopText:{},currentTypedText:{},customFields:{scope:i.SESSION},customName:{scope:i.STORAGE},defaultChatHeight:{type:r.INTEGER,value:420},defaultChatWidth:{type:r.INTEGER,value:300},defaultFace:{},defaultHeader:{},defaultText:{},defaultWelcome:{},departments:{type:r.OBJECT,value:[]},departmentsShown:{scope:i.STORAGE,type:r.BOOLEAN},departmentsType:{},disableCobrowse:{type:r.BOOLEAN,value:!1},disableForms:{type:r.BOOLEAN,value:!1},extraAuth:{value:""},firstMessage:{},firstMessageShown:{scope:i.STORAGE,value:!1},free:{value:!1,type:r.BOOLEAN},hideLeaveContacts:{type:r.BOOLEAN,scope:i.STORAGE},hideRedHelper:{value:!1,type:r.BOOLEAN,scope:i.SESSION},holdMessage:{type:r.OBJECT,value:{}},invitation:{type:r.OBJECT,scope:i.STORAGE,value:{}},invitationHistory:{scope:i.STORAGE,value:"[]"},invitationsShown:{value:0,type:r.INTEGER,priority:"internal",scope:i.STORAGE},inviteState:{value:"none",priority:"internal"},ip:{scope:i.STORAGE},isCloneSessionActive:{type:r.BOOLEAN,scope:i.STORAGE},isOnline:{type:r.BOOLEAN},isPartiallyOnline:{type:r.BOOLEAN,value:!1},isSendMouseActive:{type:r.BOOLEAN,value:!1,scope:i.STORAGE},jid:{scope:i.STORAGE},lastActivity:{type:r.INTEGER,scope:i.STORAGE},lastChat:{type:r.INTEGER,value:0,scope:i.STORAGE,priority:"internal"},lastInvitationTime:{scope:i.STORAGE,priority:"interval",type:r.INTEGER},lastMessageFrom:{scope:i.STORAGE},lastMessageTime:{scope:i.STORAGE,priority:"internal"},lastMouseOperator:{scope:i.STORAGE,priority:"internal"},lastOperatorChat:{type:r.INTEGER,scope:i.STORAGE},lastVisit:{value:"1/1/2000",scope:i.STORAGE},lastVisitTime:{type:r.INTEGER,value:0,scope:i.STORAGE},lastXMPPTransfer:{type:r.INTEGER,scope:i.STORAGE},leaveContactsSuggestions:{type:r.OBJECT},locale:{scope:i.STORAGE},messageQueue:{type:r.OBJECT,scope:i.STORAGE,value:[]},mouseOperators:{scope:i.STORAGE,priority:"internal"},offlineEnabled:{type:r.BOOLEAN,value:!0,scope:i.STORAGE},offlineFields:{value:["name","email","message"],type:r.OBJECT},offlineHeader:{},offlineText:{},onlineOperators:{value:[],type:r.OBJECT},openApi:{type:r.BOOLEAN,value:!0},operatorRates:{value:{},type:r.OBJECT,scope:i.STORAGE},operAvatar:{scope:i.STORAGE,fallback:"defaultFace"},operDisplayName:{scope:i.STORAGE},optimizeConnections:{type:Boolean,value:!1,scope:i.STORAGE},preferredOperator:{value:""},preferredOperatorError:{value:""},previousDay:{value:"1/1/2000",scope:i.STORAGE},previousOperator:{},rateEnabled:{type:r.BOOLEAN},realDepartment:{type:r.INTEGER,value:0,scope:i.STORAGE,priority:"internal"},reconnecting:{value:!1,type:r.BOOLEAN},reconnects:{type:r.INTEGER,value:0},referrer:{scope:i.STORAGE,priority:"internal"},referrerStored:{scope:i.STORAGE,priority:"internal",type:r.BOOLEAN,value:!1},region:{scope:i.SESSION},requiredOperator:{value:""},responsible:{type:r.OBJECT,value:[]},rid:{value:0,type:r.INTEGER,priority:"internal",scope:i.STORAGE},sessionViewers:{type:r.OBJECT,value:[]},showHoldMessage:{type:r.BOOLEAN,scope:i.STORAGE,value:!1},showLeaveContacts:{type:r.BOOLEAN,scope:i.STORAGE},sid:{value:"",priority:"internal",scope:i.STORAGE},siteVisitLastTime:{value:0,type:r.INTEGER,priority:"internal",scope:i.STORAGE},skin:{},stringChatState:{scope:i.STORAGE,priority:"internal",value:"browse"},time:{type:r.INTEGER,value:0},trigger:{scope:i.STORAGE,priority:"internal"},userLocale:{value:""},vid:{scope:i.STORAGE,type:r.INTEGER,priority:"internal"},visIdFromNx:{scope:i.STORAGE,type:r.INTEGER},viewedPages:{type:r.INTEGER,value:0,scope:i.STORAGE,noNaN:!0},visits:{type:r.INTEGER,value:0,scope:i.STORAGE},watchingOperators:{scope:i.STORAGE,value:"{}"}},d=n.CLIENT_NAME+(n.COMPANY_ID?"."+n.COMPANY_ID:"");n.STANDALONE?t.init(d,l):(t.attachTo(c,l,"internal"),t.init(d,l),-1!==n.COMPANY_ID&&t.sendRequest());var u=function(e){t.dispatcher.addEventListener("on"+e.charAt(0).toUpperCase()+e.substr(1)+"Changed",function(){s("span.redhlp_"+e).html(t[e])})};for(var p in l)l.hasOwnProperty(p)&&u(p);return t.dispatcher.addEventListener("onVidChanged",function(){s(".redhlp_code").text((t.vid+"").substr((t.vid+"").length-4))}),s(".redhlp_code").text((t.vid+"").substr((t.vid+"").length-4)),t}),define("application/distribution",["application/dispatcher","application/session.objects","common/constants/chatWindowStage"],function(e,t,n){var i={isOperatorOnline:function(e){for(var n=t.onlineOperators,i=0,r=n.length;r>i;i++)if(n[i].name===e)return"offline"!==n[i].status;return!1},isDepartmentOnline:function(e,n){n||(n="");for(var i=t.onlineOperators,r=0,o=i.length;o>r;r++)if("offline"!==i[r].status&&(i[r].onPage||i[r].name===n))for(var a=0,s=i[r].departments.length;s>a;a++)if(i[r].departments[a]===e)return!0;return!1},initializeChatWindowStage:function(){var r=t.currentOperator||"",o=t.currentDepartment;r&&"-"!=r&&i.isOperatorOnline(r)?t.chatWindowStage=n.ONLINE:o&&i.isDepartmentOnline(o,r)?(t.currentOperator&&"-"!=t.currentOperator||(t.currentOperator="",e.fire("refreshOperator")),t.chatWindowStage=n.ONLINE):t.chatWindowStage=t.isOnline?n.ONLINE:n.OFFLINE_FORM}};return i}),define("config/api",["common/communication/encoder","application/dispatcher"],function(e,t){var n={};try{n=e.decompress(location.hash.split("#")[1]).settings}catch(i){}var r,o,a=[],s=!1;n.waitForTemplate=function(e){return s?void e():void("function"==typeof e&&a.push(e))},t.addEventListener("templateProcessed",function(){for(r=0,o=a.length;o>r;r++)a[r]()});var c=function(){s=!0};return t.addEventListener("templateReceived",c),n}),define("locales",{enabled:["az","bg","cs","de","dk","ee","en","es","fa","fi","hu","it","kk","lt","lv","md","pl","ru","sk","uk","zh"],locales:{az:{CHAT_LABEL:"Mtni buraya daxil edin...",YOU_LABEL:"Siz",EMAIL_INCORRECT:"Siz mvcud olmayan e-mail daxil etmisiniz",FAILED_TO_SEND:"Mtni gndrmk mmkn olmad",INCORRECT_EMAIL:"Email adresi dzgn deyil",NOT_ALL_FIELDS:"Siz btn xanalar doldurmamsnz",MAIL_SUCCESS:"Mesajnz uurla gndrildi",MAIL_SENT:"Mesajnz gndrildi",SEND_BUTTON:"Gndr",THROBBER:"Gndrilir...",MESSAGE_LABEL:"Mesajnz:",EMAIL_LABEL:"Sizin e-mail:",NAME_LABEL:"Adnz:",OFFLINE_HEADER:"Offline laq formas",OFFLINE_TEXT:"Hal hazrda btn operatorlar xtd deyillr. Ltfn siz z mesajnz formadan istifad edrk gndrin. Yaxn zamanda sizinl laq saxlanlacaqdr.",PAGE_TITLE:"Online Mslhti",URL_NEW_TAB:"ayr bir shifd",TITLE_NEW_TAB:"ayr bir shifd",WEBSITE:"http://redhelper.ru",TYPING_LABEL:"cavab yazr",PROMPT_LABEL:"Operator siz digr shify kemyi tklif edir. Kek?",PROMPT_BUTTON_YES:"Bli",PROMPT_BUTTON_NO:"Xeyir",NOTIFICATION_HEADER:"Operatorun mesaji",OPERATOR_REDIRECT:"Operator at digr operatora ynlndirir",OPERATOR_REDIRECT_OK:"Siz xidmt edn operator",OPERATOR_CONNECTING:"Siz operator balanr, ltfn gzlyin",NO_PREFERRED_OPERATOR:"Hal hazrdak operator yerind deyil, siz digr operatora balandnz",TOO_LONG:"Mtnd icaz veriln maksimal simvol say hddin atb",PHONE_LABEL:"Sizin telefon:",PHONE_MESSAGE:"Telefon",INCORRECT_PHONE:"Telefon format dzgn deyil",ALL_OFFLINE:"Btn operatorlar xtd deyillr",LEAVE_MESSAGE:"Mktub yaz",DEFAULT_FIRST_MESSAGE:"Salam, Siz nec kmk ed bilrm?",COPYRIGHT:"online mslhti",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Fayl gndrmk n buraya dartb atn",FILE_SENT_OPERATOR:"Siz gndriln fayl:",FILE_SENT_VISITOR:"Siz fayl gndrdiniz:",FILE_UPLOAD:"<span>Fayl Ykl</span> (v ya fayl at qutusuna atn)",UPLOAD_LEGEND:"Fayl mbadilsi",UPLOAD_ERROR:"Fayl yklm xtas - fayln hcmi bykdr",UPLOAD_ERROR_TYPE:"Fayl yklm xtas - b nv fayllar dstklnmir",UPLOAD_ERROR_UNKNOWN:"Bilinmyn yklm xtas. Ltfn bir daha yoxlaynz",BACK_TO_CONVERSATION:"Yazmaya qaytmaq",BACK_TO_OFFLINE:"Ofline formaya qaytmaq",CHOOSE_DEPARTMENT:"Mracit etmk istdiyiniz blmni seiniz:",DEPARTMENTS_BUTTON:"Blmni seiniz",CHOOSE_DEPARTMENT_TITLE:"Blmni semk",CHAT_SEND_TITLE:"Mesaj gndr",FILE_SEND_TITLE:"Fayl gndr",RATE_TITLE:"Operatoru qiymtlndir",HOLD_MESSAGE:"Ltfn gzlyin, operator siz tezlikl cavab yazacaq",LEAVE_CONTACTS:"Operator cavab vermir. Ltfn z laq vasitlrinizi biz gndrin. Sizinl tezlikl laq saxlanlacaq.",PHONE:"Telefon",EMAIL:"e-mail",NAME:"Ad",CONTACTS_SUCCESS:"Tkr edirik. Bizim nmaynd sizinl laq saxlayacaq.",INCORRECT_CONTACTS:"Mlumatlarn dzgnlyn yoxlayn",OPERATOR:"Operator"},bg:{CHAT_LABEL:"   ",YOU_LABEL:"",EMAIL_INCORRECT:"   ",FAILED_TO_SEND:"   ",INCORRECT_EMAIL:"   ",NOT_ALL_FIELDS:"    ",MAIL_SUCCESS:"   ",MAIL_SENT:" ",SEND_BUTTON:"",THROBBER:" ...",MESSAGE_LABEL:":",EMAIL_LABEL:" :",NAME_LABEL:" :",OFFLINE_HEADER:"   ",OFFLINE_TEXT:"     . ,         ",PAGE_TITLE:" ",URL_NEW_TAB:"in a separate tab",TITLE_NEW_TAB:"in a separate tab",WEBSITE:"http://redhelper.com",TYPING_LABEL:" is typing",PROMPT_LABEL:"Operator wants to redirect you to another page. Allow?",PROMPT_BUTTON_YES:"Yes",PROMPT_BUTTON_NO:"No",NOTIFICATION_HEADER:"Message from operator",OPERATOR_REDIRECT:"Operator wants to switch you",OPERATOR_REDIRECT_OK:"You are now chatting with",OPERATOR_CONNECTING:"Operator is connecting, please wait",NO_PREFERRED_OPERATOR:"Current operator is unavailable, connected to another",TOO_LONG:"Maximum message length exceed",PHONE_LABEL:"Your phone:",PHONE_MESSAGE:"Phone",INCORRECT_PHONE:"The phone is incorrect",ALL_OFFLINE:"Operators offline",LEAVE_MESSAGE:"Leave message",DEFAULT_FIRST_MESSAGE:"Hello! How can I help you?",COPYRIGHT:"powered by",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Drop file here",FILE_SENT_OPERATOR:"Sent file to you:",FILE_SENT_VISITOR:"You sent file:",FILE_UPLOAD:"<span>Upload a file</span> (or drag it into chat)",UPLOAD_LEGEND:"Uploading file",UPLOAD_ERROR:"Upload error - file too large",UPLOAD_ERROR_TYPE:"Upload error - file type not supported",UPLOAD_ERROR_UNKNOWN:"Unknown upload error. Try again",BACK_TO_CONVERSATION:"Back to conversation",BACK_TO_OFFLINE:"Back to offline form",CHOOSE_DEPARTMENT:"Please choose department:",DEPARTMENTS_BUTTON:"Choose department",CHOOSE_DEPARTMENT_TITLE:"Choose department",CHAT_SEND_TITLE:"Send message",FILE_SEND_TITLE:"Send file",RATE_TITLE:"Rate operator",HOLD_MESSAGE:"Please wait, operator will answer you as soon as possible",LEAVE_CONTACTS:"Operator is not responding, please leave your contacts",PHONE:"Phone",EMAIL:"e-mail",NAME:"Name",CONTACTS_SUCCESS:"Thank you, our manager will contact you soon",INCORRECT_CONTACTS:"Please check highlighted fields",OPERATOR:""},cs:{CHAT_LABEL:"Napsat zprvu...",YOU_LABEL:"Vy",EMAIL_INCORRECT:"Tento e-mail neexistuje",FAILED_TO_SEND:"Nepodailo se poslat zprvu",INCORRECT_EMAIL:"Neplatn formt emailov adresy",NOT_ALL_FIELDS:"Prosme vyplte vechny daje",MAIL_SUCCESS:"Zprva je odeslna",MAIL_SENT:"Zprva je odeslna",SEND_BUTTON:"Poslat",THROBBER:"Odesln..",MESSAGE_LABEL:"Zprva:",EMAIL_LABEL:"Vae e-mailov adresa:",NAME_LABEL:"Jmno:",OFFLINE_HEADER:"Zptn zprva",OFFLINE_TEXT:"Vichni nai opertoi jsou nyn offline. Polete nm prosm Vae daje a nai opertoi Vs v co nejbli dob budou kontaktovat.",PAGE_TITLE:"Konzultace online",URL_NEW_TAB:"otevt v novm okn",TITLE_NEW_TAB:"otevt v nov kart",WEBSITE:"http://redhelper.ru",TYPING_LABEL:" odpovd",PROMPT_LABEL:"Opertor nabz otevt dal strnku. Otevt?",PROMPT_BUTTON_YES:"Ano",PROMPT_BUTTON_NO:"Ne",NOTIFICATION_HEADER:"Zprva od opertora",OPERATOR_REDIRECT:"Opertor pedv hovor dalmu opertorovi",OPERATOR_REDIRECT_OK:"Pidv se opertor",OPERATOR_CONNECTING:"Pokejte, prosm, opertor se pidv",NO_PREFERRED_OPERATOR:"Tento opertor je nyn offline, budte pepojeni k dalmu opertorovi",TOO_LONG:"Pekroen limit znak",PHONE_LABEL:"Va telefon:",PHONE_MESSAGE:"Telefon",INCORRECT_PHONE:"Neplatn formt sla",ALL_OFFLINE:"Vichni opertoi jsou nyn offline",LEAVE_MESSAGE:"Poslat zprvu",DEFAULT_FIRST_MESSAGE:"Dobr den, mohu Vm nejak pomoci?",COPYRIGHT:"Konzultace online od",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Pro odesln pethnte prosm soubor sem",FILE_SENT_OPERATOR:"Opertor odeslal Vm soubor:",FILE_SENT_VISITOR:"Odeslali jste soubor:",FILE_UPLOAD:"<span>Nahrt soubor</span> (nebo pethnte soubor do okna chatu)",UPLOAD_LEGEND:"Nahrvvn souboru",UPLOAD_ERROR:"Chyba nahrvn. Soubor je pli velk",UPLOAD_ERROR_TYPE:"Chyba nahrvn. Neplatn formt.",UPLOAD_ERROR_UNKNOWN:"Neznm chyba. Prosm zkuste znovu",BACK_TO_CONVERSATION:"Vrtit se k hovoru",BACK_TO_OFFLINE:"Vrtit se k offline formuli",CHOOSE_DEPARTMENT:"Vyberte si prosm oddlen, na kter se chcete obrtit:",DEPARTMENTS_BUTTON:"Vybrat si oddlen",CHOOSE_DEPARTMENT_TITLE:"Vybrat si oddlen",CHAT_SEND_TITLE:"Poslat zprvu",FILE_SEND_TITLE:"Odeslat soubor",RATE_TITLE:"Ohodnotit opertora",HOLD_MESSAGE:"Pokejte prosm, opertor za okamik Vm odpov",LEAVE_CONTACTS:"Opertor neodpovd, prosm nechte kontakt na Vs a nai opertoi Vs v co nejbli dob budou kontaktovat.",PHONE:"Telefon",EMAIL:"e-mail",NAME:"Jmno",CONTACTS_SUCCESS:"Dkujeme, nai opertoi Vs v co nejbli dob budou kontaktovat.",INCORRECT_CONTACTS:"Prosm zkontrolujte Vae daje",OPERATOR:"Operator"},de:{CHAT_LABEL:"Geben Sie hier Ihre Nachricht ein",YOU_LABEL:"Sie",EMAIL_INCORRECT:"Die  E-Mail-Adresse, die Sie eingegeben haben, ist ungltig",FAILED_TO_SEND:"Ihre Nachricht wurde nicht gesendet",INCORRECT_EMAIL:"Ihr email ist nicht korrekt",NOT_ALL_FIELDS:"Fllen Sie, bitte, alle Felder aus",MAIL_SUCCESS:"Ihre Nachricht wurde erfolgreich gesendet",MAIL_SENT:"Die Nachricht wurde gesendet",SEND_BUTTON:"Senden",THROBBER:"Bitte warten...",MESSAGE_LABEL:"Ihre Nachricht",EMAIL_LABEL:"Ihr E-mail",NAME_LABEL:"Ihr Name",OFFLINE_HEADER:"Feedbackformular",OFFLINE_TEXT:"Wir sind momentan nicht erreichbar. Geben Sie hier Ihre Nachricht ein und wir beantworten sie per E-Mail.",PAGE_TITLE:"Onlineberater",URL_NEW_TAB:"In einem separaten Tabulator",TITLE_NEW_TAB:"In einem separaten Tabulator",WEBSITE:"http://redhelper.com",TYPING_LABEL:"schreibt",PROMPT_LABEL:"Berater mchte Sie auf eine  andere  Seite  weiterleiten, erlauben Sie?",PROMPT_BUTTON_YES:"Ja",PROMPT_BUTTON_NO:"Nein",NOTIFICATION_HEADER:"Nachricht von dem Berater",OPERATOR_REDIRECT:"Berater mchte Sie an einen anderen Berater weiterleiten",OPERATOR_REDIRECT_OK:"Sie stehen mit dem Berater in Verbindung",OPERATOR_CONNECTING:"Wir leiten Sie  an einen Berater weiter. Warten Sie bitte",NO_PREFERRED_OPERATOR:"Ihr Berater ist nicht erreichbar, wir leiten Sie weiter, warten Sie bitte",TOO_LONG:"Maximale Lnge der Nachricht ist berschritten",PHONE_LABEL:"Ihr Telefon",PHONE_MESSAGE:"Telefon",INCORRECT_PHONE:"Die Telefonnummer ist nicht korrekt",ALL_OFFLINE:"Alle Berater sind momentan nicht erreichbar",LEAVE_MESSAGE:"Hier eine Nachricht eingeben",DEFAULT_FIRST_MESSAGE:"Guten Tag! Kann ich Ihnen helfen?",COPYRIGHT:"Berater von",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Um eine Datei zu senden, ziehen Sie sie hierher",FILE_SENT_OPERATOR:"Datei wurde an Sie gesendet:",FILE_SENT_VISITOR:"Sie haben eine Datei gesendet:",FILE_UPLOAD:"<span>Datei hochladen</span> (oder ziehen Sie sie ins Dialogfenster)",UPLOAD_LEGEND:"Hochladen der Datei",UPLOAD_ERROR:"Fehler beim Hochladen. Datei ist zu gro",UPLOAD_ERROR_TYPE:"Fehler beim Hochladen. Dateityp wird nicht untersttzt",UPLOAD_ERROR_UNKNOWN:"Ein unbekannter Fehler beim Hochladen der Daten. Bitte probieren Sie noch einmal",BACK_TO_CONVERSATION:"Zurck zum Dialog",BACK_TO_OFFLINE:"Zurck zum Feedbackformular",CHOOSE_DEPARTMENT:"Whlen Sie eine Abteilung, woran Sie sich wenden mchten:",DEPARTMENTS_BUTTON:"Whlen Sie eine Abteilung",HOLD_MESSAGE:"Bitte warten Sie, ein Betreiber werden Sie bald beantworten",LEAVE_CONTACTS:"Bediener nicht beantworten, lassen Sie Ihre Kontaktdaten und wir werden Sie umgehend kontaktieren.",PHONE:"Telefon",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",EMAIL:"e-mail",NAME:"Name",CONTACTS_SUCCESS:"Vielen Dank, unsere Mitarbeiter werden Sie umgehend kontaktieren.",INCORRECT_CONTACTS:"Bitte berprfen Sie Ihre Eingabe",OPERATOR:"Bediener"},dk:{CHAT_LABEL:"Skriv venligst din meddelelse her",YOU_LABEL:"Dig",EMAIL_INCORRECT:"Fejl i den indtastede e-mail adresse",FAILED_TO_SEND:"Meddelelsen blev ikke sendt",INCORRECT_EMAIL:"The email is incorrect",NOT_ALL_FIELDS:"Udfyld venligst alle felter",MAIL_SUCCESS:"Din meddelelse er blevet sendt",MAIL_SENT:"Din meddelelse er blevet sendt",SEND_BUTTON:"Send",THROBBER:"Vent venligst",MESSAGE_LABEL:"Meddelelse",EMAIL_LABEL:"Din e-mail",NAME_LABEL:"Dit navn",OFFLINE_HEADER:"Feedback form",OFFLINE_TEXT:"Vi er desv?rre ikke online i ojeblikket. Efterlad en besked og vi svarer tilbage pa e-mail",PAGE_TITLE:"Live Chat",URL_NEW_TAB:"in a separate tab",TITLE_NEW_TAB:"in a separate tab",WEBSITE:"http://redhelper.com",TYPING_LABEL:" skriver",PROMPT_LABEL:"'Du bliver nu stillet videre til en ny side. Tillad'",PROMPT_BUTTON_YES:"Ja",PROMPT_BUTTON_NO:"Nej",NOTIFICATION_HEADER:"Besked fra operator",OPERATOR_REDIRECT:"Operator wants to switch you",OPERATOR_REDIRECT_OK:"Du chatter nu med",OPERATOR_CONNECTING:"Operator logger pa, vent venligst",NO_PREFERRED_OPERATOR:"Denne operator er desv?rre optaget. Stiller om til anden",TOO_LONG:"Maxl?ngde pa beskeden er overskredet",LEAVE_MESSAGE:"Efterlade en besked",DROP_HERE:"Trk og slip filer her",FILE_UPLOAD:"Hent filen (eller trkke en fil til chat)",UPLOAD_LEGEND:"Hent fil",UPLOAD_ERROR:"Upload fejl - filen for stor",UPLOAD_ERROR_TYPE:"Upload fejl - filtype understttes ikke",UPLOAD_ERROR_UNKNOWN:"Ukendt upload fejl",BACK_TO_CONVERSATION:"Tilbage til samtale",BACK_TO_OFFLINE:"Back to offline formular",CHOOSE_DEPARTMENT:"Vlg den sektion, hvor du nsker at anvende",DEPARTMENTS_BUTTON:"Vlg afdeling",CHOOSE_DEPARTMENT_TITLE:"Vlg afdeling",CHAT_SEND_TITLE:"Send besked",FILE_SEND_TITLE:"Send fil",RATE_TITLE:"Rate operatr",HOLD_MESSAGE:"Vent venligst, en operatr vil svare dig hurtigt",LEAVE_CONTACTS:"operatr ikke svarer, forlade din kontakt, og vi vil kontakte dig snarest.",PHONE:"Telephone",PHONE_LABEL:"Telephone",PHONE_MESSAGE:"Telephone",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",EMAIL:"e-mail",NAME:"Navn",CONTACTS_SUCCESS:"Tak, vores personale vil kontakte dig snarest.",INCORRECT_CONTACTS:"Kontroller din indtastning",OPERATOR:"Operatr"},ee:{CHAT_LABEL:"Sisestage oma snum siia",YOU_LABEL:"Teie",EMAIL_INCORRECT:"Sisestatud e-postiaadress pole ige",FAILED_TO_SEND:"Snumi saatmine ebannestus",INCORRECT_EMAIL:"Sisestatud mailiaadress pole korrektne",NOT_ALL_FIELDS:"Osad vljad on titmata",MAIL_SUCCESS:"Teie snum saadeti ra",MAIL_SENT:"Snum on saadetud",SEND_BUTTON:"Saada",THROBBER:"Palun oodake...",MESSAGE_LABEL:"Snum",EMAIL_LABEL:"Teie e-postiaadress",NAME_LABEL:"Teie nimi",OFFLINE_HEADER:"Tagasiside vorm",OFFLINE_TEXT:"Me oleme hetkel offlainis. Palun jtke meile snum ja me vastame teile e-kirjaga.",PAGE_TITLE:"Vestlus",URL_NEW_TAB:"teisel vahelehel",TITLE_NEW_TAB:" teisel vahelehel",WEBSITE:"http://redhelper.com",TYPING_LABEL:" kirjutab",PROMPT_LABEL:"Operaator suunab teid teisele lehele. Kas lubate?",PROMPT_BUTTON_YES:"Jah",PROMPT_BUTTON_NO:"Ei",NOTIFICATION_HEADER:"Snum operaatorilt",OPERATOR_REDIRECT:"Operaator tahab teid mber suunata",OPERATOR_REDIRECT_OK:"Te vestlete praegu",OPERATOR_CONNECTING:"Operaator vtab hendust, palun oodake",NO_PREFERRED_OPERATOR:"Praegune operaator pole kttesaadav, valige mni teine",TOO_LONG:"Snumi maksimumpikkus on letatud",PHONE_LABEL:"Teie telefoninumber",PHONE_MESSAGE:"Telefoninumber",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"Teie telefoninumber pole ige",ALL_OFFLINE:"Operaatorid on offlainis",LEAVE_MESSAGE:"Jtke snum",DEFAULT_FIRST_MESSAGE:"Tere! Kuidas ma saan teid aidata?",COPYRIGHT:"powered by",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Lohistage fail siia",FILE_SENT_OPERATOR:"Teile saadetud fail:",FILE_SENT_VISITOR:"Teie saadetud fail:",FILE_UPLOAD:"Laadi fail les (vi lohista see vestlusaknasse)",UPLOAD_LEGEND:"Faili leslaadimine",UPLOAD_ERROR:" leslaadimisviga  fail on liiga suur",UPLOAD_ERROR_TYPE:"leslaadimisviga  failitp pole toetatud",UPLOAD_ERROR_UNKNOWN:"Tundmatu leslaadimise viga. Proovi uuesti",BACK_TO_CONVERSATION:"Tagasi vestlus",BACK_TO_OFFLINE:"Tagasi offline vorm",CHOOSE_DEPARTMENT:"Valige lik, milles soovite taotleda",DEPARTMENTS_BUTTON:"Vali osakond",CHOOSE_DEPARTMENT_TITLE:"Vali osakond",CHAT_SEND_TITLE:"Saada snum",FILE_SEND_TITLE:"Saada fail",RATE_TITLE:"Hinda kitaja",HOLD_MESSAGE:"Palun oota, operaator vastab sulle varsti",LEAVE_CONTACTS:"operaator ei vasta, jtke oma kontaktandmed ning me vtame teiega peagi hendust.",PHONE:"Telefon",EMAIL:"e-mail",NAME:"Nimi",CONTACTS_SUCCESS:"Tnan teid, meie ttajad vtame teiega peagi hendust.",INCORRECT_CONTACTS:"Palun kontrollige oma panuse",OPERATOR:"Operaator"},en:{CHAT_LABEL:"Type your message here",YOU_LABEL:"You",EMAIL_INCORRECT:"The email you specified is incorrect",FAILED_TO_SEND:"Failed to send message",INCORRECT_EMAIL:"The email is incorrect",NOT_ALL_FIELDS:"Not all fields filled",MAIL_SUCCESS:"Your message has been sent successfully",MAIL_SENT:"The message has been sent",SEND_BUTTON:"Send",THROBBER:"Wait please...",MESSAGE_LABEL:"Message",EMAIL_LABEL:"E-mail",NAME_LABEL:"Your name",OFFLINE_HEADER:"Feedback form",OFFLINE_TEXT:"We are offline at the moment. Please leave a message and we will answer it by email.",PAGE_TITLE:"Live Chat",URL_NEW_TAB:"in a separate tab",TITLE_NEW_TAB:"in a separate tab",WEBSITE:"http://redhelper.com",TYPING_LABEL:" is typing",PROMPT_LABEL:"'Operator wants to redirect you to another page. Allow?'",PROMPT_BUTTON_YES:"Yes",PROMPT_BUTTON_NO:"No",NOTIFICATION_HEADER:"Message from operator",OPERATOR_REDIRECT:"Operator wants to switch you",OPERATOR_REDIRECT_OK:"You are now chatting with ",OPERATOR_CONNECTING:"Operator is connecting, please wait",NO_PREFERRED_OPERATOR:"Current operator is unavailable, connected to another",TOO_LONG:"Maximum message length exceed",PHONE_LABEL:"Phone",PHONE_MESSAGE:"Phone",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"The phone is incorrect",ALL_OFFLINE:"Operators offline",LEAVE_MESSAGE:"Leave message",DEFAULT_FIRST_MESSAGE:"Hello! How can I help you?",COPYRIGHT:"powered by",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Drop file here",FILE_SENT_OPERATOR:"Sent file to you:",FILE_SENT_VISITOR:"You sent file:",FILE_SENT_DOWNLOAD:"Download the file",MOVE_TO_DEPARTMENTS:"Choose another department",FILE_UPLOAD:"<span>Upload a file</span> (or drag it into chat)",UPLOAD_LEGEND:"Uploading file",UPLOAD_ERROR:"Upload error - file too large",UPLOAD_ERROR_TYPE:"Upload error - file type not supported",UPLOAD_ERROR_UNKNOWN:"Unknown upload error. Try again",BACK_TO_CONVERSATION:"Back to conversation",BACK_TO_OFFLINE:"Back to offline form",CHOOSE_DEPARTMENT:"Please choose department:",DEPARTMENTS_BUTTON:"Choose department",CHOOSE_DEPARTMENT_TITLE:"Choose department",CHAT_SEND_TITLE:"Send message",FILE_SEND_TITLE:"Send file",RATE_TITLE:"Rate operator",HOLD_MESSAGE:"Please wait, operator will answer you as soon as possible",LEAVE_CONTACTS:"Operator is not responding, please leave your contacts",PHONE:"Phone",EMAIL:"e-mail",NAME:"Name",CONTACTS_SUCCESS:"Thank you, our manager will contact you soon",INCORRECT_CONTACTS:"Please check highlighted fields",OPERATOR:"Operator",PAGE:"Page",TIMEONSITE:"Time on site",BROWSER:"Browser",REFERRER:"Referrer",LOCATION:"Location",NOTDEFINED:"not defined",NOREFERRER:"direct"},es:{CHAT_LABEL:"Escriba un mensaje...",YOU_LABEL:"Usted",EMAIL_INCORRECT:"El correo electrnico especificada no es correcto",FAILED_TO_SEND:"No se pudo enviar mensaje",INCORRECT_EMAIL:"El correo electrnico no es correcto",NOT_ALL_FIELDS:"Hay campos sin rellenar",MAIL_SUCCESS:"Tu mensaje ha sido enviado",MAIL_SENT:"El mensaje ha sido enviado",SEND_BUTTON:"Enviar",THROBBER:"Envo...",MESSAGE_LABEL:"Mensaje",EMAIL_LABEL:"Email",NAME_LABEL:"Nombre",OFFLINE_HEADER:"Formulario de contacto",OFFLINE_TEXT:"Todos nuestros operadores estn actualmente desconectados. Dejar un mensaje y te responderemos en breve.",PAGE_TITLE:"Chat en vivo",URL_NEW_TAB:"en una pestaa independiente",TITLE_NEW_TAB:"en una pestaa independiente",WEBSITE:"http://redhelper.com",TYPING_LABEL:" responde",PROMPT_LABEL:"El operador ofrece ir a otra pgina. Acceder",PROMPT_BUTTON_YES:"Si",PROMPT_BUTTON_NO:"No",NOTIFICATION_HEADER:"Mensaje del operador",OPERATOR_REDIRECT:"El operador enva el chat a otro operador",OPERATOR_REDIRECT_OK:"Esta conectando el operador",OPERATOR_CONNECTING:"Esta conectando el operador, espera",NO_PREFERRED_OPERATOR:"El actual operador no est, usted se conecta a otro operador",TOO_LONG:"Supera longitud mxima del mensaje",PHONE_LABEL:"Vuestro telfono",PHONE_MESSAGE:"Telfono",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"Formato de nmero no vlido",ALL_OFFLINE:"Todos los operadores fuera de lnea",LEAVE_MESSAGE:"Publicar un comentario",DEFAULT_FIRST_MESSAGE:"Hola Puedo ayudar?",COPYRIGHT:"consultor online de",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Para enviar un archivo, arrastre el fichero aqu",FILE_SENT_OPERATOR:"Te envi un archivo:",FILE_SENT_VISITOR:"Usted enva un archivo:",FILE_UPLOAD:"<span>Subir archivo</span> (o arrastrar un archivo en el chat)",UPLOAD_LEGEND:"Subida de archivo",UPLOAD_ERROR:"Error al cargar el archivo - es demasiado grande",UPLOAD_ERROR_TYPE:"Error al cargar el archivo - tipo de archivo no se admite",BACK_TO_CONVERSATION:"Respaldar a la conversacin",BACK_TO_OFFLINE:"Realice una copia de forma offline",CHOOSE_DEPARTMENT:"Seleccione la seccin en la que desea aplicar",DEPARTMENTS_BUTTON:"Elija departamento",CHOOSE_DEPARTMENT_TITLE:"Escoja departamento",CHAT_SEND_TITLE:"Enviar mensaje",FILE_SEND_TITLE:"Enviar archivo",RATE_TITLE:"Evaluar el operador",HOLD_MESSAGE:"Por favor espere, un operador le contestar en breve",LEAVE_CONTACTS:"operador no responde, deja tu contacto y nos pondremos en contacto con usted en breve.",PHONE:"Telfono",EMAIL:"e-mail",NAME:"Nombre",CONTACTS_SUCCESS:"Gracias a usted, nuestro personal se comunicar con usted en breve.",INCORRECT_CONTACTS:"Por favor, compruebe su entrada",OPERATOR:"Operador"},fa:{CHAT_LABEL:"    ",YOU_LABEL:" ",EMAIL_INCORRECT:"       ",FAILED_TO_SEND:"   ",INCORRECT_EMAIL:"  ",NOT_ALL_FIELDS:"     ",MAIL_SUCCESS:"     ",MAIL_SENT:"  ",SEND_BUTTON:"",THROBBER:"   ...",MESSAGE_LABEL:":",EMAIL_LABEL:" :",NAME_LABEL:" ",OFFLINE_HEADER:" ",OFFLINE_TEXT:"     .              ",PAGE_TITLE:" ",URL_NEW_TAB:"   ",TITLE_NEW_TAB:"    ",WEBSITE:"http://redhelper.com",TYPING_LABEL:"  ",PROMPT_LABEL:"'          '",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"",NOTIFICATION_HEADER:"   ",OPERATOR_REDIRECT:"       ",OPERATOR_REDIRECT_OK:"    ",OPERATOR_CONNECTING:"       ",NO_PREFERRED_OPERATOR:"         ",TOO_LONG:"         ",PHONE_LABEL:"  :",PHONE_MESSAGE:"",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"    ",ALL_OFFLINE:"  ",LEAVE_MESSAGE:" ",DEFAULT_FIRST_MESSAGE:"       ",COPYRIGHT:"  ",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"   ",FILE_SENT_OPERATOR:"    :",FILE_SENT_VISITOR:"    :",FILE_UPLOAD:"<span>   </span> (     )",UPLOAD_LEGEND:" ",UPLOAD_ERROR:" -    ",UPLOAD_ERROR_TYPE:" -     ",UPLOAD_ERROR_UNKNOWN:"  .   ",BACK_TO_CONVERSATION:"  ",BACK_TO_OFFLINE:"   ",CHOOSE_DEPARTMENT:"    ",DEPARTMENTS_BUTTON:" ",CHOOSE_DEPARTMENT_TITLE:" ",CHAT_SEND_TITLE:" ",FILE_SEND_TITLE:" ",RATE_TITLE:" ",RTL:"RTL",OPERATOR:""},fi:{CHAT_LABEL:"Kirjoita viesti...",YOU_LABEL:"Te",EMAIL_INCORRECT:"Annoit olematon e-mail",FAILED_TO_SEND:"Viestin l?hetys ep?onnistui",INCORRECT_EMAIL:"S?hk?postiosoitteen muoto ei kelpaa",NOT_ALL_FIELDS:"Ette t?ytt?nyt kaikki kent?t",MAIL_SUCCESS:"Tejd?n viestinne l?hetetty",MAIL_SENT:"Viesti on l?hetetty",SEND_BUTTON:"L?hett?",THROBBER:"L?hett?...",MESSAGE_LABEL:"Viesti",EMAIL_LABEL:"Teid?n e-mail",NAME_LABEL:"Teid?n nimi",OFFLINE_HEADER:"Palautelomake",OFFLINE_TEXT:"Kaikki operaattorit ovat t?ll? hetkell? kirjautunut. J?t? viesti ja me vastaamme sinulle.",PAGE_TITLE:"Tukineuvoja online tilassa",URL_NEW_TAB:"erillisess? v?lilehdess?",TITLE_NEW_TAB:"erillisess? v?lilehdess?",WEBSITE:"http://redhelper.com",TYPING_LABEL:" vastauksia",PROMPT_LABEL:"Operaattori tarjoaa menn? toiselle sivulle. Menn??",PROMPT_BUTTON_YES:"Kyll?",PROMPT_BUTTON_NO:"Ei",
NOTIFICATION_HEADER:"operaattorin viesti",OPERATOR_REDIRECT:"Operaattori l?hett?? chat toiselle operaattorille",OPERATOR_REDIRECT_OK:"operaattori yhdistyy",OPERATOR_CONNECTING:"operaattori yhdistyy, odotaa",NO_PREFERRED_OPERATOR:"Nykyinen operaattori ei ole paikallaan, olet yhteydess? toisen operaattorin",TOO_LONG:"Ylitt?nyt enimm?ispituus viestien l?hett?miseen",PHONE_LABEL:"Teid?n puhelin numero",PHONE_MESSAGE:"puhelin numero",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"puhelin muoto ei kelpaa",ALL_OFFLINE:"Kaikki operaattorit Ofline",LEAVE_MESSAGE:"J?tt? viestin",DEFAULT_FIRST_MESSAGE:"Hei, voinko auttaa jotenkin?",COPYRIGHT:"Online Konsultti",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Jos haluat l?hett?? tiedoston, ved? t?h?n",FILE_SENT_OPERATOR:"l?hettin teille tiedoston:",FILE_SENT_VISITOR:"Te l?hettit tiedoston:",FILE_UPLOAD:"<span>Ladatta tiedosaton</span> (tai vet?m?ll? tiedosto chat)",UPLOAD_LEGEND:"ladata tiedosto",UPLOAD_ERROR:"Virhe tiedoston ladattaessa - liian suuri",UPLOAD_ERROR_TYPE:"Virhe tiedoston ladattaessa - tiedostotyyppi? ei tukea",BACK_TO_CONVERSATION:"Takaisin keskusteluun",BACK_TO_OFFLINE:"Takaisin offline muodossa",CHOOSE_DEPARTMENT:"Valitse osio, jonka haluat hakea",DEPARTMENTS_BUTTON:"Valitse osasto",CHOOSE_DEPARTMENT_TITLE:"Valitse osasto",CHAT_SEND_TITLE:"L?het? viesti",FILE_SEND_TITLE:"L?het? tiedosto",RATE_TITLE:"??nest? toimija",HOLD_MESSAGE:"Odota, operaattori vastaa sinulle pian",LEAVE_CONTACTS:"operaattori ei vastaa, j?t? yhteystietosi ja otamme sinuun yhteytt? pian.",PHONE:"Puhelin",EMAIL:"e-mail",NAME:"Nimi",CONTACTS_SUCCESS:"Kiitos, henkil?kunta ottaa sinuun pian yhteytt?.",INCORRECT_CONTACTS:"Tarkista input",OPERATOR:"Operaattori"},hu:{CHAT_LABEL:"Ide rja az zenett",YOU_LABEL:"n",EMAIL_INCORRECT:"Helytelen e-mail cmet adott meg",FAILED_TO_SEND:"Nem sikerlt elldeni az zenetet",INCORRECT_EMAIL:"Az e-mail cm helytelen",NOT_ALL_FIELDS:"Nincs kitltve minden mez",MAIL_SUCCESS:"Az zenett sikeresen elkldtk",MAIL_SENT:"Az zenet elkldsre kerlt",SEND_BUTTON:"Klds",THROBBER:"Krjk, vrjon...",MESSAGE_LABEL:"zenet",EMAIL_LABEL:"Az n e-mail cme",NAME_LABEL:"Az n neve",OFFLINE_HEADER:"Visszajelz",OFFLINE_TEXT:"Jelenleg offline vagyunk. Krjk, hagyjon egy zenetet, s e-mailben vlaszolunk r.",PAGE_TITLE:"l csevegs",URL_NEW_TAB:"j lapon",TITLE_NEW_TAB:"j lapon",WEBSITE:"http://redhelper.com",TYPING_LABEL:" gpel",PROMPT_LABEL:"'Munkatrsunk t szeretn nt irnytani egy msik weblapra. Megengedi?'",PROMPT_BUTTON_YES:"Igen",PROMPT_BUTTON_NO:"Nem",NOTIFICATION_HEADER:"zenet az gyflszolglattl ",OPERATOR_REDIRECT:"Msik munkatrshoz szeretnnk irnytani",OPERATOR_REDIRECT_OK:"Jelenleg a kvetkez munkatrsunkkal beszlget: ",OPERATOR_CONNECTING:"A munkatrsunk kapcsoldik, trelmt krjk",NO_PREFERRED_OPERATOR:"Munkatrsunk nem elrhet, msik munkatrsunkhoz irnytottuk",TOO_LONG:"Az zenet tl hossz",PHONE_LABEL:"az n telefonszma",PHONE_MESSAGE:"Telefonszm",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"A telefonszm helytelen",ALL_OFFLINE:"Munkatrsaink nincsenek bejelentkezve",LEAVE_MESSAGE:"Hagyjon zenetet",DEFAULT_FIRST_MESSAGE:"dvzlm! Miben segthetek?",COPYRIGHT:"fejlesztette:",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Ide hzza be a fjlt",FILE_SENT_OPERATOR:"Az nnek kldtt fjl:",FILE_SENT_VISITOR:"Az n fjlja:",FILE_UPLOAD:"<span>Fjl feltltse</span> (vagy hzza be a csevegablakba)",UPLOAD_LEGEND:"Fjl feltltse",UPLOAD_ERROR:"Feltltsi hiba - a fjl tl nagy",UPLOAD_ERROR_TYPE:"Feltltsi hiba - a fjltpus nem tmogatott",UPLOAD_ERROR_UNKNOWN:"Ismeretlen feltltsi hiba. Prblja meg jra.",BACK_TO_CONVERSATION:"Vissza a csevegshez",BACK_TO_OFFLINE:"Vissza az offline rlaphoz",CHOOSE_DEPARTMENT:"Krjk, vlasszon rszleget:",DEPARTMENTS_BUTTON:"Rszleg kivlasztsa",CHOOSE_DEPARTMENT_TITLE:"Rszleg kivlasztsa",CHAT_SEND_TITLE:"zenet kldse",FILE_SEND_TITLE:"Fjl kldse",RATE_TITLE:"Munkatrsunk rtkelse",HOLD_MESSAGE:"Please wait, operator will answer you as soon as possible",LEAVE_CONTACTS:"Operator is not responding, please leave your contacts",PHONE:"Telefonszm",EMAIL:"e-mail",NAME:"Name",CONTACTS_SUCCESS:"Thank you, our manager will contact you soon",INCORRECT_CONTACTS:"Please check highlighted fields",OPERATOR:"Opertor"},it:{CHAT_LABEL:"Scrivere messaggio",YOU_LABEL:"Lei",EMAIL_INCORRECT:"Ha inserito una e-mail inesistente",FAILED_TO_SEND:"Il messaggio non e' statto inviato",INCORRECT_EMAIL:"E-mail address e' sbagliato",NOT_ALL_FIELDS:"Non ha compilato tutti i campi",MAIL_SUCCESS:"Il suo messaggio e' stato inviato",MAIL_SENT:"Il messaggio e' stato inviato",SEND_BUTTON:"Inviare",THROBBER:"Invio",MESSAGE_LABEL:"Messaggio",EMAIL_LABEL:"E-mail",NAME_LABEL:"Nome",OFFLINE_HEADER:"Modulo di contatto",OFFLINE_TEXT:"Tutti i nostri assistenti sono offline. Lasci un messaggio e le risponderemo al piu' presto",PAGE_TITLE:"Consulente online",URL_NEW_TAB:"In una nuova finestra",TITLE_NEW_TAB:"In una nuova finestra",WEBSITE:"http://redhelper.com",TYPING_LABEL:" risponde",PROMPT_LABEL:"L'assistente chiede di aprire una nuova finestra",PROMPT_BUTTON_YES:"Si",PROMPT_BUTTON_NO:"No",NOTIFICATION_HEADER:"Messaggio da parte dell'assistente",OPERATOR_REDIRECT:"L'assistente la sta passando ad un altro assistente",OPERATOR_REDIRECT_OK:"L'assistente si e' collegato con lei:",OPERATOR_CONNECTING:"Aspettare che l'assistente si sta collegando con lei",NO_PREFERRED_OPERATOR:"Questo assistente e' assente, lei e' stato collegato ad un altro assistente",TOO_LONG:"Ha superato il numero di caratteri per questo messaggio",PHONE_LABEL:"Numero di telefono",PHONE_MESSAGE:"Numero di telefono",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"Il numero di telefono e' sbagliato",ALL_OFFLINE:"Tutti gli assistenti sono offline",LEAVE_MESSAGE:"Lasciare un messaggio",DEFAULT_FIRST_MESSAGE:"Salve, come posso aitarla?",COPYRIGHT:"Assistente online di",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Per inviare ul file trascinarlo qui",FILE_SENT_OPERATOR:"Il file e' stato inviato:",FILE_SENT_VISITOR:"Il suo file e' stato inviato:",FILE_UPLOAD:"<span>scaricare un file</span> (trascinare il file in chat)",UPLOAD_LEGEND:"Il file si sta scaricando",UPLOAD_ERROR:"Errore durante lo scaricamento  supera il volume consentito",UPLOAD_ERROR_TYPE:"Errore durante lo scaricamento  il tipo di file non e' supportato",UPLOAD_ERROR_UNKNOWN:"Errore sconosciuto. Riprovare di nuovo",BACK_TO_CONVERSATION:"Tornare alla conversazione",BACK_TO_OFFLINE:"Titornare al modulo di contatto",CHOOSE_DEPARTMENT:"Selezionare la sezione a cui vuole rivorgersi:",DEPARTMENTS_BUTTON:"Selezionare la sezione",CHOOSE_DEPARTMENT_TITLE:"Selezionare la sezione",CHAT_SEND_TITLE:"Inviare il messaggio",FILE_SEND_TITLE:"Inviare il file",RATE_TITLE:"Dare un voto all'assistente",HOLD_MESSAGE:"Aspettare per favore, l'assistente le rispondera' al piu' presto",LEAVE_CONTACTS:"L'assistente non risponde, lasciare il suo contatto e verra' ricontattato al piu' presto",PHONE:"Numero di telefono",EMAIL:"E-mail",NAME:"Nome",CONTACTS_SUCCESS:"Grazie, il nosto assistente la contattera' al piu' presto",INCORRECT_CONTACTS:"Controllare per favore se i dati sono corretti",OPERATOR:"L'assistente"},kk:{CHAT_LABEL:" ...",YOU_LABEL:"",EMAIL_INCORRECT:"  e-mail  ",FAILED_TO_SEND:" ",INCORRECT_EMAIL:"E-mail    ",NOT_ALL_FIELDS:"   ",MAIL_SUCCESS:"  ",MAIL_SENT:" ",SEND_BUTTON:"",THROBBER:"",MESSAGE_LABEL:"",EMAIL_LABEL:" e-mail",NAME_LABEL:" ",OFFLINE_HEADER:"",OFFLINE_TEXT:"    ,   ,     ",PAGE_TITLE:" ",URL_NEW_TAB:" ",TITLE_NEW_TAB:" ",WEBSITE:"http://redhelper.ru",TYPING_LABEL:" ",PROMPT_LABEL:"     .  ",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"",NOTIFICATION_HEADER:" ",OPERATOR_REDIRECT:"    ",OPERATOR_REDIRECT_OK:"  ",OPERATOR_CONNECTING:"  ,  ",NO_PREFERRED_OPERATOR:"   ,    ",TOO_LONG:"    ",PHONE_LABEL:" ",PHONE_MESSAGE:"",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"   ",ALL_OFFLINE:"   ",LEAVE_MESSAGE:" ",DEFAULT_FIRST_MESSAGE:",     ",COPYRIGHT:" ",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"      ",FILE_SENT_OPERATOR:"  ",FILE_SENT_VISITOR:"  ",FILE_UPLOAD:"<span>   </span>  (   )",UPLOAD_LEGEND:" ",UPLOAD_ERROR:"   -  ",UPLOAD_ERROR_TYPE:"   -    ",UPLOAD_ERROR_UNKNOWN:" ,    ",BACK_TO_CONVERSATION:" ",BACK_TO_OFFLINE:"  ",CHOOSE_DEPARTMENT:"   ",DEPARTMENTS_BUTTON:" ",CHOOSE_DEPARTMENT_TITLE:" ",CHAT_SEND_TITLE:" ",FILE_SEND_TITLE:" ",RATE_TITLE:" ",HOLD_MESSAGE:", ,      ",LEAVE_CONTACTS:"  ,          ",PHONE:"",EMAIL:" (e-mail)",NAME:"",CONTACTS_SUCCESS:",      ",INCORRECT_CONTACTS:",    ",OPERATOR:""},lt:{CHAT_LABEL:"Palikite savo inut ia",YOU_LABEL:"Js",EMAIL_INCORRECT:"Js nurodt neteising el.pat",FAILED_TO_SEND:"Nepavyko isisti inuts",INCORRECT_EMAIL:"Neteisingas el.patas",NOT_ALL_FIELDS:"Upildyti ne visi laukeliai",MAIL_SUCCESS:"Js inut buvo skmingai isista",MAIL_SENT:"inut isista",SEND_BUTTON:"Sisti",THROBBER:"Praome palaukti...",MESSAGE_LABEL:"inut",EMAIL_LABEL:"Js el.patas",NAME_LABEL:"Js vardas",OFFLINE_HEADER:"Atsiliepimo forma",OFFLINE_TEXT:"iuo metu mes neprisijung. Praome palikti inut ir mes atsakysime jums el.laiku.",PAGE_TITLE:"Live Chat",URL_NEW_TAB:"atskiroje kortelje",TITLE_NEW_TAB:"atskiroje kortelje",WEBSITE:"http://redhelper.com",TYPING_LABEL:" rao",PROMPT_LABEL:"'Operatorius nori nukreipti jus  kit puslap. Leisti?'",PROMPT_BUTTON_YES:"Taip",PROMPT_BUTTON_NO:"Ne",NOTIFICATION_HEADER:"inut i operatoriaus",OPERATOR_REDIRECT:"Operatorius nori jus perjungti",OPERATOR_REDIRECT_OK:"Js dabar bendraujate su ",OPERATOR_CONNECTING:"Operatorius prisijungia, praome palaukti",NO_PREFERRED_OPERATOR:"Dabartinis operatorius nepasiekiamas, sujungiama su kitu",TOO_LONG:"Virijote maksimal inuts ilg",PHONE_LABEL:"Js telefonas",PHONE_MESSAGE:"Telefonas",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"Neteisingas telefono numeris",ALL_OFFLINE:"Operatoriai neprisijung",LEAVE_MESSAGE:"Palikite inut",DEFAULT_FIRST_MESSAGE:"Sveiki! Kuo galiu padti?",COPYRIGHT:"sukurta",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"meskite fail ia",FILE_SENT_OPERATOR:"Jums nusistas failas:",FILE_SENT_VISITOR:"Js nusiuntte fail:",FILE_UPLOAD:"<span>kelti fail</span> (ar nutempkite j  pokalb)",UPLOAD_LEGEND:"Keliamas failas",UPLOAD_ERROR:"Nepavyko kelti - failas per didelis",UPLOAD_ERROR_TYPE:"Nepavyko kelti - nepalaikomas failo tipas",UPLOAD_ERROR_UNKNOWN:"Neinoma klimo klaida. Pabandykite dar kart",BACK_TO_CONVERSATION:"Grti  pokalb",BACK_TO_OFFLINE:"Grti  offline form",CHOOSE_DEPARTMENT:"Praome pasirinkti skyri:",DEPARTMENTS_BUTTON:"Pasirinkti skyri",CHOOSE_DEPARTMENT_TITLE:"Pasirinkite skyri",CHAT_SEND_TITLE:"Sisti inut",FILE_SEND_TITLE:"Sisti fail",RATE_TITLE:"vertinti operatori",OPERATOR:"Operatorius"},md:{CHAT_LABEL:"Introducei mesajul...",YOU_LABEL:"Dvs",EMAIL_INCORRECT:"Ai introdus un email inexistent",FAILED_TO_SEND:"Expedierea mesajului a euat",INCORRECT_EMAIL:"Format incorect al mesajului",NOT_ALL_FIELDS:"V rog s completai toate cmpurile",MAIL_SUCCESS:"Mesajul Dvs a fost expediat cu succes",MAIL_SENT:"Mesajul a fost expediat",SEND_BUTTON:"Expediaz",THROBBER:"Expediere n progres...",MESSAGE_LABEL:"Mesaj",EMAIL_LABEL:"Email",NAME_LABEL:"Numele",OFFLINE_HEADER:"Formular de contact",OFFLINE_TEXT:"Toi operatorii sunt ofline. Lsai un mesaj i noi vom rspunde la el n scurt timp.",PAGE_TITLE:"Consultant Online",URL_NEW_TAB:"n fereastra de alturi",TITLE_NEW_TAB:"n fereastra de alturi",WEBSITE:"http://redhelper.com",TYPING_LABEL:" rspunde",PROMPT_LABEL:"Operatorul v propune s trecei pe alt pagin. Facei trecerea?",PROMPT_BUTTON_YES:"Da",PROMPT_BUTTON_NO:"Nu",NOTIFICATION_HEADER:"Mesaj de la Operator",OPERATOR_REDIRECT:"Operatorul transmite discuia altui Operator",OPERATOR_REDIRECT_OK:"Vi s-a alturat operatorul",OPERATOR_CONNECTING:"Se conecteaz un operator, ateptai",NO_PREFERRED_OPERATOR:"Operatorul precedent nu este pe loc, suntei conectat la alt operator",TOO_LONG:"Ai depit limita maxim a mesajului",PHONE_LABEL:"Telefon",PHONE_MESSAGE:"Telefon",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"Format incorect al numrului de telefon",ALL_OFFLINE:"Toi operatorii sunt ofline",LEAVE_MESSAGE:"Lsai un mesaj",DEFAULT_FIRST_MESSAGE:"Bun ziua, cu ce v pot ajuta?",COPYRIGHT:"consultant online de la",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Pentru expediere, tragei fiierul aici",FILE_SENT_OPERATOR:"V-am expediat fiierul:",FILE_SENT_VISITOR:"Dvs ne-ai expediat fiierul:",FILE_UPLOAD:"<span>ncarc un fiier</span> (sau tragei-l deasupra chatului)",UPLOAD_LEGEND:"ncrcare fiier",UPLOAD_ERROR:"Eroare la ncrcarea fiierului - are dimensiunea prea mare",UPLOAD_ERROR_TYPE:"Eroare la ncrcarea fiierului - format nepermis",UPLOAD_ERROR_UNKNOWN:"Eroare necunoscut la ncrcare. ncercai din nou",BACK_TO_CONVERSATION:"Revenire la dialog",BACK_TO_OFFLINE:"Revenire la formularul ofline",CHOOSE_DEPARTMENT:"Alegei departamentul la care dorii s v adresai:",DEPARTMENTS_BUTTON:"Alegei departamentul",CHOOSE_DEPARTMENT_TITLE:"Alegei departamentul",CHAT_SEND_TITLE:"Expediere mesaj",FILE_SEND_TITLE:"Expediere fiier",RATE_TITLE:"Estimeaz Operatorul",HOLD_MESSAGE:"Ateptai v rog, un Operator o s v rspund n scurt timp",LEAVE_CONTACTS:"Operatorul nu rspunde, lsai datele Dvs de contact i n scurt timp noi vom lua legtura cu Dvs",PHONE:"Telefon ",EMAIL:"e-mail ",NAME:"Nume ",CONTACTS_SUCCESS:"Mulumesc, unul din colegii notri v va contacta n timpul apropiat",INCORRECT_CONTACTS:"V rugm, verificai corectitudinea datelor introduse",OPERATOR:"Operatorul"},lv:{CHAT_LABEL:"Ievadiet savu ziu eit",EMAIL_INCORRECT:"Nedergs e-pasts",EMAIL_LABEL:"Jsu e-pasts",FAILED_TO_SEND:"Kda stot ziojumus",INCORRECT_EMAIL:"Nederga e-pasta adrese",MAIL_SENT:"Offline-Ziojums ir nostts",MAIL_SUCCESS:"Offline-Zia tika nostta veiksmgi",MESSAGE_LABEL:"Ievadiet savu Offline-ziu eit",NAME_LABEL:"Jsu vrds",NO_PREFERRED_OPERATOR:"Pareizjais operators nav uz vietas, Jums ir saistts ar citu operatoru",NOT_ALL_FIELDS:"Jums vajag aizpildt visus laukus",NOTIFICATION_HEADER:"Ziojums no operatora",OFFLINE_HEADER:"Atsauksmes forma",OFFLINE_TEXT:"Visi msu operatori ir atvienojuies. Atstt ziu un ms atbildsim uz to tuvkaj laik.",OPERATOR_CONNECTING:"Savieno js ar operatoru, uzgaidiet",OPERATOR_REDIRECT:"Operators sta trzanu citam operatoram",OPERATOR_REDIRECT_OK:"Ir savienots ar jums",PAGE_TITLE:"Online konsultants",PROMPT_BUTTON_NO:"N",PROMPT_BUTTON_YES:"J",PROMPT_LABEL:"Operators piedv prcelties uz citu lapu. Iet?",SEND_BUTTON:"Nostt",THROBBER:"Stana...",TITLE_NEW_TAB:"Atsevi ciln",TOO_LONG:"Prsniegta maksimla garuma nostanai",TYPING_LABEL:"atbild",URL_NEW_TAB:"atsevi ciln",YOU_LABEL:"Js",YES_LABEL:"J",NO_LABEL:" N",MINIMIZE_CHAT:"noslpt atu",MAXIMIZE_CHAT:"atvrt atsevi ciln",NEW_MESSAGE:"Jauns ziojums no operatora",BADGE_LABEL:"Uzdot jautjumu",SOUND_ONOFF:"Ieslgt / izslgt skau",HIGHLIGHT_LABEL:"Pievrstet uzmanbu",HIGHLIGHT_LINK:"Priet",HINT_CLOSE:"Spiediet, lai aizvrt",DEFAULT_LABEL:"Uzdot jautjumu",LEAVE_MESSAGE:"Atstt ziu",DROP_HERE:"Velciet un nometiet failus eit",FILE_UPLOAD:"<a>Augupldt failu</a> (vai velciet failu uz trzanas)",UPLOAD_LEGEND:"Augupldt failu",UPLOAD_ERROR:"Pievienot kda - fails ir prk liels",UPLOAD_ERROR_TYPE:"Pievienot kda - faila tips nav atbalstts",UPLOAD_ERROR_UNKNOWN:"Nezinma augupieldes kda",BACK_TO_CONVERSATION:"Atpaka uz sarunu",BACK_TO_OFFLINE:"Atpaka uz bezsaistes formu",CHOOSE_DEPARTMENT:"Izvlieties sadau, kur vlaties pieteikties",DEPARTMENTS_BUTTON:"Izvlieties nodaa",CHOOSE_DEPARTMENT_TITLE:"Izvlies nodaa",CHAT_SEND_TITLE:"Nostt ziu",FILE_SEND_TITLE:"Nostt failu",RATE_TITLE:"Lmenis operators",HOLD_MESSAGE:"Ldzu uzgaidiet, operators jums atbilds drz",LEAVE_CONTACTS:"Operators nesniedz atbildi, atstjiet savu kontaktinformciju, un ms ar Jums sazinsimies tuvkaj laik.",PHONE:"Telephone",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",EMAIL:"e-mail",NAME:"Vrds",CONTACTS_SUCCESS:"Paldies, msu darbinieki sazinsies ar Jums tuvkaj laik.",INCORRECT_CONTACTS:"Ldzu, prbaudiet jsu ieguldjumu",WEBSITE:"http://redhelper.com",OPERATOR:"Operators"},pl:{CHAT_LABEL:"Napisz tutaj swoje pytanie",YOU_LABEL:"Ty",EMAIL_INCORRECT:"Wprowadzony e-mail adres jest nieprawidowy",FAILED_TO_SEND:"Nieudane wysanie wiadomoci",INCORRECT_EMAIL:"Adres e-mail jest niewaciwy",NOT_ALL_FIELDS:"Prosz wpisa wszystkie dane",MAIL_SUCCESS:"Odsyanie wiadomoci byo udane",MAIL_SENT:"Wiadomo bya odesana",SEND_BUTTON:"Wysa",THROBBER:"Prosz czeka...",MESSAGE_LABEL:"Wiadomo",EMAIL_LABEL:"Twj e-mail",NAME_LABEL:"Twoje imi",OFFLINE_HEADER:"Pozostaw wiadomo",OFFLINE_TEXT:"Jest po godzinach pracy. Prosz pozostaw wiadomo, odpowiemy przez e-mail.",PAGE_TITLE:"ywa konwersacja",URL_NEW_TAB:"W innej zakadce",TITLE_NEW_TAB:"W innej zakadce",WEBSITE:"http://redhelper.com",TYPING_LABEL:"Wpisuj",PROMPT_LABEL:"Operator chc przekierowa na inn stron internetow. Pozwoli?",PROMPT_BUTTON_YES:"Tak",PROMPT_BUTTON_NO:"Nie",NOTIFICATION_HEADER:"Wiadomo od operatora",OPERATOR_REDIRECT:"Operator chce ci przekierowa",OPERATOR_REDIRECT_OK:"Rozmawiasz z",OPERATOR_CONNECTING:"Operator si czy, prosz czeka",NO_PREFERRED_OPERATOR:"W tej chwili nie jest dostpny niniejszy operator. Poczymy ci z innym",TOO_LONG:"Dugo wiadomoci bya przekroczona",PHONE_LABEL:"Twj telefon",PHONE_MESSAGE:"Telefon",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"Numer telefonu jest niewaciwy",ALL_OFFLINE:"Operatorzy nie s obecni",LEAVE_MESSAGE:"Zostaw wiadomo",DEFAULT_FIRST_MESSAGE:"Witaj! Jak mog pomc?",COPYRIGHT:"Obsugiwane przez",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Tu przesu plik",FILE_SENT_OPERATOR:"Plik by wysany do ciebie:",FILE_SENT_VISITOR:"Wysae plik:",FILE_UPLOAD:"<span>Wylij plik</span> (lub przesu do tego okna)",UPLOAD_LEGEND:"Wysyanie pliku",UPLOAD_ERROR:"Nastpi bd w trakcie wysyania - plik jest zbyt duy",UPLOAD_ERROR_TYPE:"Nastpi bd w trakcie wysyania - ten format pliku nie jest obsugiwany",UPLOAD_ERROR_UNKNOWN:"Nastpi nieznany bd w trakcie wysyania. Sprbuj ponownie",BACK_TO_CONVERSATION:"Z powrotem do konwersacji",BACK_TO_OFFLINE:"Z powrotem do formularza offline",CHOOSE_DEPARTMENT:"Prosz wybierz dzia:",DEPARTMENTS_BUTTON:"Prosz wybierz dzia",CHOOSE_DEPARTMENT_TITLE:"Wybierz dzia",CHAT_SEND_TITLE:"Wylij wiadomo",FILE_SEND_TITLE:"Wylij plik",RATE_TITLE:"Prosz oceni operatora",HOLD_MESSAGE:"Please wait, operator will answer you as soon as possible",LEAVE_CONTACTS:"Operator is not responding, please leave your contacts",PHONE:"telefon",EMAIL:"e-mail",NAME:"imi",CONTACTS_SUCCESS:"Thank you, our manager will contact you soon",INCORRECT_CONTACTS:"Please check highlighted fields",OPERATOR:"Operator"},ru:{CHAT_LABEL:" ...",YOU_LABEL:"",EMAIL_INCORRECT:"   e-mail",FAILED_TO_SEND:"   ",INCORRECT_EMAIL:"  email ",NOT_ALL_FIELDS:"    ",MAIL_SUCCESS:"  ",MAIL_SENT:"  ",SEND_BUTTON:"",THROBBER:"...",MESSAGE_LABEL:"",EMAIL_LABEL:"E-mail",NAME_LABEL:" ",OFFLINE_HEADER:"  ",OFFLINE_TEXT:"    .          .",PAGE_TITLE:" ",URL_NEW_TAB:"  ",TITLE_NEW_TAB:"  ",WEBSITE:"http://redhelper.ru",TYPING_LABEL:" ",PROMPT_LABEL:"      . ?",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"",NOTIFICATION_HEADER:"  ",OPERATOR_REDIRECT:"    ",OPERATOR_REDIRECT_OK:"   ",OPERATOR_CONNECTING:"   , ",NO_PREFERRED_OPERATOR:"    ,     ",TOO_LONG:"     ",PHONE_LABEL:"",PHONE_MESSAGE:"",OFFLINE_BODY_HEADER1:"Email ",OFFLINE_BODY_HEADER2:"       .",OFFLINE_FROM_VISITOR:"  ",OFFLINE_VISITOR_NAME:" ",INCORRECT_PHONE:"  ",ALL_OFFLINE:"  ",LEAVE_MESSAGE:" ",DEFAULT_FIRST_MESSAGE:",     - ?",COPYRIGHT:" ",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"    ",FILE_SENT_OPERATOR:"  :",FILE_SENT_VISITOR:"  :",FILE_SENT_DOWNLOAD:" ",MOVE_TO_DEPARTMENTS:"  ",FILE_UPLOAD:"<span> </span> (    )",UPLOAD_LEGEND:" ",UPLOAD_ERROR:"    -   ",UPLOAD_ERROR_TYPE:"    -     ",UPLOAD_ERROR_UNKNOWN:" .   ",BACK_TO_CONVERSATION:"  ",BACK_TO_OFFLINE:"  -",CHOOSE_DEPARTMENT:" ,    :",DEPARTMENTS_BUTTON:" ",CHOOSE_DEPARTMENT_TITLE:" ",CHAT_SEND_TITLE:" ",FILE_SEND_TITLE:" ",RATE_TITLE:" ",HOLD_MESSAGE:", ,    ",LEAVE_CONTACTS:"  ,           .",PHONE:"",EMAIL:"e-mail",NAME:"",CONTACTS_SUCCESS:",        .",INCORRECT_CONTACTS:",    ",OPERATOR:"",PAGE:"",TIMEONSITE:"  ",BROWSER:"",REFERRER:"",LOCATION:"",NOTDEFINED:"  ",NOREFERRER:" "},sk:{CHAT_LABEL:"Sem napte svoju otzku...",YOU_LABEL:"Vy",EMAIL_INCORRECT:"E-mail adresa, ktor ste uviedli je nesprvna",FAILED_TO_SEND:"Nepodarilo sa odosla sprvu",INCORRECT_EMAIL:"E-mail adresa je nesprvna",NOT_ALL_FIELDS:"Nevyplnili ste vetky polia",MAIL_SUCCESS:"Vaa sprva bola poslan spene",MAIL_SENT:"Vaa sprva bola poslan",SEND_BUTTON:"Posla",THROBBER:"Pokajte prosm...",MESSAGE_LABEL:"Sprva",EMAIL_LABEL:"V e-mail",NAME_LABEL:"Vae meno",OFFLINE_HEADER:"Zanechajte nm sprvu",OFFLINE_TEXT:"Zachytili ste ns mimo pracovnej doby. Prosm zanechajte nm odkaz a my vm odpovieme cez e-mail.",PAGE_TITLE:"iv konverzcia",URL_NEW_TAB:"v inej zloke",TITLE_NEW_TAB:"v inej zloke",WEBSITE:"http://redhelper.com",TYPING_LABEL:" pe",PROMPT_LABEL:"Opertor Vs chce presmerova na in web strnku. Povoli?",PROMPT_BUTTON_YES:"no",PROMPT_BUTTON_NO:"Nie",NOTIFICATION_HEADER:"Odkaz od opertora",OPERATOR_REDIRECT:"Opertor Vs chce presmerova",OPERATOR_REDIRECT_OK:"Rozprvate sa s",OPERATOR_CONNECTING:"Opertor sa pripja, pokajte prosm",NO_PREFERRED_OPERATOR:"Sasn opertor nie je v dispozcii. Budete prepojen na inho",TOO_LONG:"Bola prekroen maximlna dka sprvy",PHONE_LABEL:"V telefn",PHONE_MESSAGE:"Telefn",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",INCORRECT_PHONE:"Telefnne slo je nesprvne",ALL_OFFLINE:"Opertori nie s prtomn",LEAVE_MESSAGE:"Zanechajte odkaz",DEFAULT_FIRST_MESSAGE:"Vitajte! Ako Vm meme pomc?",COPYRIGHT:"poskytovate",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"Polote sem sbor",FILE_SENT_OPERATOR:"Sbor poslan Vm:",FILE_SENT_VISITOR:"Poslali ste sbor:",FILE_UPLOAD:"<span>Polite sbor</span> (alebo ho polote na toto okno)",UPLOAD_LEGEND:"Posielanie sboru",UPLOAD_ERROR:"Chyba pri odosielan - sbor je prli vek",UPLOAD_ERROR_TYPE:"Chyba pri odosielan - tento typ sboru nie je podporovan",UPLOAD_ERROR_UNKNOWN:"Nastala neznma chyba pri odosielan. Skste to znova.",BACK_TO_CONVERSATION:"Nasp ku konverzcii",BACK_TO_OFFLINE:"Naspa na offline formulr",CHOOSE_DEPARTMENT:"Prosm vyberte si oddelenie:",DEPARTMENTS_BUTTON:"Vyberte si oddelenie",CHOOSE_DEPARTMENT_TITLE:"Vyberte si oddelenie",CHAT_SEND_TITLE:"Polite sprvu",FILE_SEND_TITLE:"Polite sbor",RATE_TITLE:"Ohodnote opertora",OPERATOR:"Opertor"},uk:{CHAT_LABEL:" ",YOU_LABEL:"",EMAIL_INCORRECT:"  email",FAILED_TO_SEND:"  -",INCORRECT_EMAIL:"  email",NOT_ALL_FIELDS:"    ",MAIL_SUCCESS:"-  ",MAIL_SENT:"- ",SEND_BUTTON:"",THROBBER:"...",MESSAGE_LABEL:"",EMAIL_LABEL:" email",NAME_LABEL:" '",OFFLINE_HEADER:"  '",OFFLINE_TEXT:"    .         .",PAGE_TITLE:" ",URL_NEW_TAB:"  ",TITLE_NEW_TAB:"  ",TYPING_LABEL:" ",PROMPT_LABEL:"      . ?",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"i",NOTIFICATION_HEADER:"  ",OPERATOR_REDIRECT:"    ",OPERATOR_REDIRECT_OK:"   ",OPERATOR_CONNECTING:"   , ",NO_PREFERRED_OPERATOR:"    ,     ",TOO_LONG:"     ",PHONE_MESSAGE:"",OFFLINE_BODY_HEADER1:"Visitor's email",OFFLINE_BODY_HEADER2:"Your response to this message will be sent to the user.",OFFLINE_FROM_VISITOR:"Message from visitor",OFFLINE_VISITOR_NAME:"Visitor name",PHONE_LABEL:" ",INCORRECT_PHONE:" ",ALL_OFFLINE:"  ",LEAVE_MESSAGE:" ",DEFAULT_FIRST_MESSAGE:",      ?",DROP_HERE:"  ",FILE_UPLOAD:"<span> </span> (    )",UPLOAD_LEGEND:" ",UPLOAD_ERROR:"   -   ",UPLOAD_ERROR_TYPE:"   -    ",UPLOAD_ERROR_UNKNOWN:"  ",BACK_TO_CONVERSATION:"  ",BACK_TO_OFFLINE:"  -",CHOOSE_DEPARTMENT:" ,    ",DEPARTMENTS_BUTTON:" ",CHOOSE_DEPARTMENT_TITLE:" ",CHAT_SEND_TITLE:" ",FILE_SEND_TITLE:" ",RATE_TITLE:" ",HOLD_MESSAGE:",  ,    ",LEAVE_CONTACTS:"  ,      '    .",PHONE:"",EMAIL:"e-mail",NAME:"'",CONTACTS_SUCCESS:",   '    .",INCORRECT_CONTACTS:" ,    ",WEBSITE:"http://redhelper.ru",OPERATOR:""},zh:{CHAT_LABEL:"",YOU_LABEL:"",EMAIL_INCORRECT:"",FAILED_TO_SEND:"",INCORRECT_EMAIL:"",NOT_ALL_FIELDS:"",MAIL_SUCCESS:"",MAIL_SENT:"",SEND_BUTTON:"",THROBBER:"...",MESSAGE_LABEL:":",EMAIL_LABEL:"e-mail:",NAME_LABEL:":",OFFLINE_HEADER:"",OFFLINE_TEXT:" ,",PAGE_TITLE:"",URL_NEW_TAB:"",TITLE_NEW_TAB:"",WEBSITE:"http://redhelper.com",TYPING_LABEL:" ",PROMPT_LABEL:"',?'",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"",NOTIFICATION_HEADER:"",OPERATOR_REDIRECT:"",OPERATOR_REDIRECT_OK:"",OPERATOR_CONNECTING:", ",NO_PREFERRED_OPERATOR:", ",TOO_LONG:"",PHONE_LABEL:":",PHONE_MESSAGE:"",INCORRECT_PHONE:"",ALL_OFFLINE:"",LEAVE_MESSAGE:"",DEFAULT_FIRST_MESSAGE:"",COPYRIGHT:"",COPYRIGHT_NAME:"<span></span>",DROP_HERE:"",FILE_SENT_OPERATOR:":",FILE_SENT_VISITOR:":",FILE_UPLOAD:"<span></span> ()",UPLOAD_LEGEND:"",UPLOAD_ERROR:" - ",UPLOAD_ERROR_TYPE:"- ",UPLOAD_ERROR_UNKNOWN:". ",BACK_TO_CONVERSATION:"",BACK_TO_OFFLINE:"",CHOOSE_DEPARTMENT:":",DEPARTMENTS_BUTTON:"",CHOOSE_DEPARTMENT_TITLE:"",CHAT_SEND_TITLE:"",FILE_SEND_TITLE:"",RATE_TITLE:"",HOLD_MESSAGE:"",LEAVE_CONTACTS:"",PHONE:"",EMAIL:"e-mail",NAME:"",CONTACTS_SUCCESS:"",INCORRECT_CONTACTS:"",OPERATOR:""}}}),define("config/lang",["application/session.objects","config/api","locales","common/extensions/jquery.plugins"],function(e,t,n,i){var r={CHAT_LABEL:"",YOU_LABEL:"",EMAIL_INCORRECT:"",FAILED_TO_SEND:"",INCORRECT_EMAIL:"",NOT_ALL_FIELDS:"",MAIL_SUCCESS:"",MAIL_SENT:"",SEND_BUTTON:"",THROBBER:"",MESSAGE_LABEL:"",EMAIL_LABEL:"",NAME_LABEL:"",OFFLINE_HEADER:"",OFFLINE_TEXT:"",PAGE_TITLE:"",
URL_NEW_TAB:"",TITLE_NEW_TAB:"",WEBSITE:"",TYPING_LABEL:"",PROMPT_LABEL:"",PROMPT_BUTTON_YES:"",PROMPT_BUTTON_NO:"",NOTIFICATION_HEADER:"",OPERATOR_REDIRECT:"",OPERATOR_REDIRECT_OK:"",OPERATOR_CONNECTING:"",NO_PREFERRED_OPERATOR:"",TOO_LONG:"",PHONE_MESSAGE:"",PHONE_LABEL:"",INCORRECT_PHONE:"",ALL_OFFLINE:"",LEAVE_MESSAGE:"",DEFAULT_FIRST_MESSAGE:"",COPYRIGHT_NAME:"<span>Red</span>Helper",DROP_HERE:"",FILE_SENT_OPERATOR:"",FILE_SENT_VISITOR:"",FILE_UPLOAD:"",UPLOAD_ERROR:"",UPLOAD_ERROR_TYPE:"",UPLOAD_ERROR_UNKNOWN:"",UPLOAD_LEGEND:"",BACK_TO_CONVERSATION:"",BACK_TO_OFFLINE:"",CHOOSE_DEPARTMENT:"",DEPARTMENTS_BUTTON:"",CHAT_SEND_TITLE:"",FILE_SEND_TITLE:"",RATE_TITLE:"",HOLD_MESSAGE:"",LEAVE_CONTACTS:"",PHONE:"",NAME:"",EMAIL:"",CONTACTS_SUCCESS:"",INCORRECT_CONTACTS:"",RTL:"",PAGE:"",TIMEONSITE:"",BROWSER:"",REFERRER:"",LOCATION:"",NOTDEFINED:"",NOREFERRER:""};return r.setFields=function(e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);for(t in r)r.hasOwnProperty(t)&&""===r[t]&&(r[t]=n.locales.en[t])},r.initLanguage=function(){var o,a=n.enabled,s=function(){return e.userLocale?e.userLocale:e&&e.locale&&a.indexOf(e.locale)>-1?e.locale:"ru"}();if(r.setFields(n.locales[s]),r.RTL&&i("body").addClass("rtl"),!e.free&&t&&t.Lang)for(o in r)r.hasOwnProperty(o)&&t.Lang.hasOwnProperty(o)&&(r[o]=t.Lang[o]);document.title=r.PAGE_TITLE},r.initLanguage(),r}),define("common/constants/sender",{VISITOR:0,OPERATOR:1}),define("common/application/time",[],function(){var e=null,t=null,n={now:function(){return e=new Date,n},parse:function(i){return e=new Date(Date.parse(i)),t?(e.setHours(e.getHours()+t[0]),e.setMinutes(e.getMinutes()+t[1]),e.setSeconds(e.getSeconds()+t[2]),n):this},setTimeDifference:function(e){var i=e.split(" ")[1].split(":");i[0]=+i[0];var r=new Date,o=[r.getHours(),r.getMinutes(),r.getSeconds()];return t=i.map(function(e,t){return o[t]-e}),n},getTimeDifference:function(){return t},toString:function(){if(!e)return"";var t=[e.getHours(),e.getMinutes(),e.getSeconds()];return t.forEach(function(e,n){10>e&&(t[n]="0"+e)}),t.join(":")},getTime:function(){return e.getTime()}};return window.rhlpTime=n,n}),define("view/template",["application/session.objects","common/extensions/jquery.plugins","config/setup"],function(e,t,n){return{processTemplate:function(i,r){i=t(i).clone(),i.removeAttr("id"),i=t("<div></div>").append(i).html();var o,a=/%(\w+)%/g;for(o=a.exec(i);o;o=a.exec(i)){r&&r.hasOwnProperty(o[1])&&(i=i.replace(new RegExp("%"+o[1]+"%","g"),r[o[1]]));try{e&&Object.prototype.hasOwnProperty.call(e,o[1])&&(i="operAvatar"===o[1]?i.replace(new RegExp("%"+o[1]+"%","g"),n.getImageUrl(e[o[1]])):i.replace(new RegExp("%"+o[1]+"%","g"),e[o[1]]))}catch(s){}}var c=/#(\w+)#/g;for(o=c.exec(i);o;o=c.exec(i))e&&Object.prototype.hasOwnProperty.call(e,o[1])&&(i=i.replace(new RegExp("#"+o[1]+"#","g"),'<span class="redhlp_'+o[1]+'">'+e[o[1]]+"</span>"));return i}}});var Base64=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t={encode:function(t){var n,i,r,o,a,s,c,l="",d=0;do n=t.charCodeAt(d++),i=t.charCodeAt(d++),r=t.charCodeAt(d++),o=n>>2,a=(3&n)<<4|i>>4,s=(15&i)<<2|r>>6,c=63&r,isNaN(i)?s=c=64:isNaN(r)&&(c=64),l=l+e.charAt(o)+e.charAt(a)+e.charAt(s)+e.charAt(c);while(d<t.length);return l},decode:function(t){var n,i,r,o,a,s,c,l="",d=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do o=e.indexOf(t.charAt(d++)),a=e.indexOf(t.charAt(d++)),s=e.indexOf(t.charAt(d++)),c=e.indexOf(t.charAt(d++)),n=o<<2|a>>4,i=(15&a)<<4|s>>2,r=(3&s)<<6|c,l+=String.fromCharCode(n),64!=s&&(l+=String.fromCharCode(i)),64!=c&&(l+=String.fromCharCode(r));while(d<t.length);return l}};return t}(),MD5=function(){var e=function(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n},t=function(e,t){return e<<t|e>>>32-t},n=function(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},i=function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t},r=function(e){for(var t="0123456789abcdef",n="",i=0;i<4*e.length;i++)n+=t.charAt(e[i>>2]>>i%4*8+4&15)+t.charAt(e[i>>2]>>i%4*8&15);return n},o=function(n,i,r,o,a,s){return e(t(e(e(i,n),e(o,s)),a),r)},a=function(e,t,n,i,r,a,s){return o(t&n|~t&i,e,t,r,a,s)},s=function(e,t,n,i,r,a,s){return o(t&i|n&~i,e,t,r,a,s)},c=function(e,t,n,i,r,a,s){return o(t^n^i,e,t,r,a,s)},l=function(e,t,n,i,r,a,s){return o(n^(t|~i),e,t,r,a,s)},d=function(t,n){t[n>>5]|=128<<n%32,t[(n+64>>>9<<4)+14]=n;for(var i,r,o,d,u=1732584193,p=-271733879,h=-1732584194,f=271733878,m=0;m<t.length;m+=16)i=u,r=p,o=h,d=f,u=a(u,p,h,f,t[m+0],7,-680876936),f=a(f,u,p,h,t[m+1],12,-389564586),h=a(h,f,u,p,t[m+2],17,606105819),p=a(p,h,f,u,t[m+3],22,-1044525330),u=a(u,p,h,f,t[m+4],7,-176418897),f=a(f,u,p,h,t[m+5],12,1200080426),h=a(h,f,u,p,t[m+6],17,-1473231341),p=a(p,h,f,u,t[m+7],22,-45705983),u=a(u,p,h,f,t[m+8],7,1770035416),f=a(f,u,p,h,t[m+9],12,-1958414417),h=a(h,f,u,p,t[m+10],17,-42063),p=a(p,h,f,u,t[m+11],22,-1990404162),u=a(u,p,h,f,t[m+12],7,1804603682),f=a(f,u,p,h,t[m+13],12,-40341101),h=a(h,f,u,p,t[m+14],17,-1502002290),p=a(p,h,f,u,t[m+15],22,1236535329),u=s(u,p,h,f,t[m+1],5,-165796510),f=s(f,u,p,h,t[m+6],9,-1069501632),h=s(h,f,u,p,t[m+11],14,643717713),p=s(p,h,f,u,t[m+0],20,-373897302),u=s(u,p,h,f,t[m+5],5,-701558691),f=s(f,u,p,h,t[m+10],9,38016083),h=s(h,f,u,p,t[m+15],14,-660478335),p=s(p,h,f,u,t[m+4],20,-405537848),u=s(u,p,h,f,t[m+9],5,568446438),f=s(f,u,p,h,t[m+14],9,-1019803690),h=s(h,f,u,p,t[m+3],14,-187363961),p=s(p,h,f,u,t[m+8],20,1163531501),u=s(u,p,h,f,t[m+13],5,-1444681467),f=s(f,u,p,h,t[m+2],9,-51403784),h=s(h,f,u,p,t[m+7],14,1735328473),p=s(p,h,f,u,t[m+12],20,-1926607734),u=c(u,p,h,f,t[m+5],4,-378558),f=c(f,u,p,h,t[m+8],11,-2022574463),h=c(h,f,u,p,t[m+11],16,1839030562),p=c(p,h,f,u,t[m+14],23,-35309556),u=c(u,p,h,f,t[m+1],4,-1530992060),f=c(f,u,p,h,t[m+4],11,1272893353),h=c(h,f,u,p,t[m+7],16,-155497632),p=c(p,h,f,u,t[m+10],23,-1094730640),u=c(u,p,h,f,t[m+13],4,681279174),f=c(f,u,p,h,t[m+0],11,-358537222),h=c(h,f,u,p,t[m+3],16,-722521979),p=c(p,h,f,u,t[m+6],23,76029189),u=c(u,p,h,f,t[m+9],4,-640364487),f=c(f,u,p,h,t[m+12],11,-421815835),h=c(h,f,u,p,t[m+15],16,530742520),p=c(p,h,f,u,t[m+2],23,-995338651),u=l(u,p,h,f,t[m+0],6,-198630844),f=l(f,u,p,h,t[m+7],10,1126891415),h=l(h,f,u,p,t[m+14],15,-1416354905),p=l(p,h,f,u,t[m+5],21,-57434055),u=l(u,p,h,f,t[m+12],6,1700485571),f=l(f,u,p,h,t[m+3],10,-1894986606),h=l(h,f,u,p,t[m+10],15,-1051523),p=l(p,h,f,u,t[m+1],21,-2054922799),u=l(u,p,h,f,t[m+8],6,1873313359),f=l(f,u,p,h,t[m+15],10,-30611744),h=l(h,f,u,p,t[m+6],15,-1560198380),p=l(p,h,f,u,t[m+13],21,1309151649),u=l(u,p,h,f,t[m+4],6,-145523070),f=l(f,u,p,h,t[m+11],10,-1120210379),h=l(h,f,u,p,t[m+2],15,718787259),p=l(p,h,f,u,t[m+9],21,-343485551),u=e(u,i),p=e(p,r),h=e(h,o),f=e(f,d);return[u,p,h,f]},u={hexdigest:function(e){return r(d(n(e),8*e.length))},hash:function(e){return i(d(n(e),8*e.length))}};return u}();Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice,i=Array.prototype.concat,r=n.call(arguments,1);return function(){return t.apply(e?e:this,i.call(r,n.call(arguments,0)))}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1}),function(e){function t(e,t){return new o.Builder(e,t)}function n(e){return new o.Builder("message",e)}function i(e){return new o.Builder("iq",e)}function r(e){return new o.Builder("presence",e)}var o;o={VERSION:"",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(e){for(var t=0;t<o.XHTML.tags.length;t++)if(e==o.XHTML.tags[t])return!0;return!1},validAttribute:function(e,t){if("undefined"!=typeof o.XHTML.attributes[e]&&o.XHTML.attributes[e].length>0)for(var n=0;n<o.XHTML.attributes[e].length;n++)if(t==o.XHTML.attributes[e][n])return!0;return!1},validCSS:function(e){for(var t=0;t<o.XHTML.css.length;t++)if(e==o.XHTML.css[t])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(e,t){o.NS[e]=t},forEachChild:function(e,t,n){var i,r;for(i=0;i<e.childNodes.length;i++)r=e.childNodes[i],r.nodeType!=o.ElementType.NORMAL||t&&!this.isTagEqual(r,t)||n(r)},isTagEqual:function(e,t){return e.tagName.toLowerCase()==t.toLowerCase()},_xmlGenerator:null,_makeGenerator:function(){var e;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(e=this._getIEXmlDom(),e.appendChild(e.createElement("strophe"))):e=document.implementation.createDocument("jabber:client","strophe",null),e},xmlGenerator:function(){return o._xmlGenerator||(o._xmlGenerator=o._makeGenerator()),o._xmlGenerator},_getIEXmlDom:function(){for(var e=null,t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],n=0;n<t.length&&null===e;n++)try{e=new ActiveXObject(t[n])}catch(i){e=null}return e},xmlElement:function(e){if(!e)return null;var t,n,i,r=o.xmlGenerator().createElement(e);for(t=1;t<arguments.length;t++)if(arguments[t])if("string"==typeof arguments[t]||"number"==typeof arguments[t])r.appendChild(o.xmlTextNode(arguments[t]));else if("object"==typeof arguments[t]&&"function"==typeof arguments[t].sort)for(n=0;n<arguments[t].length;n++)"object"==typeof arguments[t][n]&&"function"==typeof arguments[t][n].sort&&r.setAttribute(arguments[t][n][0],arguments[t][n][1]);else if("object"==typeof arguments[t])for(i in arguments[t])arguments[t].hasOwnProperty(i)&&r.setAttribute(i,arguments[t][i]);return r},xmlescape:function(e){return e=e.replace(/\&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/'/g,"&apos;"),e=e.replace(/"/g,"&quot;")},xmlTextNode:function(e){return o.xmlGenerator().createTextNode(e)},xmlHtmlNode:function(e){var t;if(window.DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t},getText:function(e){if(!e)return null;var t="";0===e.childNodes.length&&e.nodeType==o.ElementType.TEXT&&(t+=e.nodeValue);for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType==o.ElementType.TEXT&&(t+=e.childNodes[n].nodeValue);return o.xmlescape(t)},copyElement:function(e){var t,n;if(e.nodeType==o.ElementType.NORMAL){for(n=o.xmlElement(e.tagName),t=0;t<e.attributes.length;t++)n.setAttribute(e.attributes[t].nodeName.toLowerCase(),e.attributes[t].value);for(t=0;t<e.childNodes.length;t++)n.appendChild(o.copyElement(e.childNodes[t]))}else e.nodeType==o.ElementType.TEXT&&(n=o.xmlGenerator().createTextNode(e.nodeValue));return n},createHtml:function(e){var t,n,i,r,a,s,c,l,d,u,p;if(e.nodeType==o.ElementType.NORMAL)if(r=e.nodeName.toLowerCase(),o.XHTML.validTag(r))try{for(n=o.xmlElement(r),t=0;t<o.XHTML.attributes[r].length;t++)if(a=o.XHTML.attributes[r][t],s=e.getAttribute(a),"undefined"!=typeof s&&null!==s&&""!==s&&s!==!1&&0!==s)if("style"==a&&"object"==typeof s&&"undefined"!=typeof s.cssText&&(s=s.cssText),"style"==a){for(c=[],l=s.split(";"),i=0;i<l.length;i++)d=l[i].split(":"),u=d[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase(),o.XHTML.validCSS(u)&&(p=d[1].replace(/^\s*/,"").replace(/\s*$/,""),c.push(u+": "+p));c.length>0&&(s=c.join("; "),n.setAttribute(a,s))}else n.setAttribute(a,s);for(t=0;t<e.childNodes.length;t++)n.appendChild(o.createHtml(e.childNodes[t]))}catch(h){n=o.xmlTextNode("")}else for(n=o.xmlGenerator().createDocumentFragment(),t=0;t<e.childNodes.length;t++)n.appendChild(o.createHtml(e.childNodes[t]));else if(e.nodeType==o.ElementType.FRAGMENT)for(n=o.xmlGenerator().createDocumentFragment(),t=0;t<e.childNodes.length;t++)n.appendChild(o.createHtml(e.childNodes[t]));else e.nodeType==o.ElementType.TEXT&&(n=o.xmlTextNode(e.nodeValue));return n},escapeNode:function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(e){return e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(e){return e.indexOf("@")<0?null:e.split("@")[0]},getDomainFromJid:function(e){var t=o.getBareJidFromJid(e);if(t.indexOf("@")<0)return t;var n=t.split("@");return n.splice(0,1),n.join("@")},getResourceFromJid:function(e){var t=e.split("/");return t.length<2?null:(t.splice(0,1),t.join("/"))},getBareJidFromJid:function(e){return e?e.split("/")[0]:null},log:function(e,t){},debug:function(e){this.log(this.LogLevel.DEBUG,e)},info:function(e){this.log(this.LogLevel.INFO,e)},warn:function(e){this.log(this.LogLevel.WARN,e)},error:function(e){this.log(this.LogLevel.ERROR,e)},fatal:function(e){this.log(this.LogLevel.FATAL,e)},serialize:function(e){var t;if(!e)return null;"function"==typeof e.tree&&(e=e.tree());var n,i,r=e.nodeName;for(e.getAttribute("_realname")&&(r=e.getAttribute("_realname")),t="<"+r,n=0;n<e.attributes.length;n++)"_realname"!=e.attributes[n].nodeName&&(t+=" "+e.attributes[n].nodeName.toLowerCase()+"='"+e.attributes[n].value.replace(/&/g,"&amp;").replace(/\'/g,"&apos;").replace(/>/g,"&gt;").replace(/</g,"&lt;")+"'");if(e.childNodes.length>0){for(t+=">",n=0;n<e.childNodes.length;n++)switch(i=e.childNodes[n],i.nodeType){case o.ElementType.NORMAL:t+=o.serialize(i);break;case o.ElementType.TEXT:t+=o.xmlescape(i.nodeValue);break;case o.ElementType.CDATA:t+="<![CDATA["+i.nodeValue+"]]>"}t+="</"+r+">"}else t+="/>";return t},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(e,t){o._connectionPlugins[e]=t}},o.Builder=function(e,t){("presence"==e||"message"==e||"iq"==e)&&(t&&!t.xmlns?t.xmlns=o.NS.CLIENT:t||(t={xmlns:o.NS.CLIENT})),this.nodeTree=o.xmlElement(e,t),this.node=this.nodeTree},o.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return o.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},attrs:function(e){for(var t in e)e.hasOwnProperty(t)&&this.node.setAttribute(t,e[t]);return this},c:function(e,t,n){var i=o.xmlElement(e,t,n);return this.node.appendChild(i),n||(this.node=i),this},cnode:function(e){var t,n=o.xmlGenerator();try{t=void 0!==n.importNode}catch(i){t=!1}var r=t?n.importNode(e,!0):o.copyElement(e);return this.node.appendChild(r),this.node=r,this},t:function(e){var t=o.xmlTextNode(e);return this.node.appendChild(t),this},h:function(e){var t=document.createElement("body");t.innerHTML=e;for(var n=o.createHtml(t);n.childNodes.length>0;)this.node.appendChild(n.childNodes[0]);return this}},o.Handler=function(e,t,n,i,r,a,s){this.handler=e,this.ns=t,this.name=n,this.type=i,this.id=r,this.options=s||{matchBare:!1},this.options.matchBare||(this.options.matchBare=!1),this.options.matchBare?this.from=a?o.getBareJidFromJid(a):null:this.from=a,this.user=!0},o.Handler.prototype={isMatch:function(e){var t,n=null;if(n=this.options.matchBare?o.getBareJidFromJid(e.getAttribute("from")):e.getAttribute("from"),t=!1,this.ns){var i=this;o.forEachChild(e,null,function(e){e.getAttribute("xmlns")==i.ns&&(t=!0)}),t=t||e.getAttribute("xmlns")==this.ns}else t=!0;return!(!t||this.name&&!o.isTagEqual(e,this.name)||this.type&&e.getAttribute("type")!=this.type||this.id&&e.getAttribute("id")!=this.id||this.from&&n!=this.from)},run:function(e){var t=null;try{t=this.handler(e)}catch(n){throw n.sourceURL?o.fatal("error: "+this.handler+" "+n.sourceURL+":"+n.line+" - "+n.name+": "+n.message):n.fileName?("undefined"!=typeof console,o.fatal("error: "+this.handler+" "+n.fileName+":"+n.lineNumber+" - "+n.name+": "+n.message)):o.fatal("error: "+n.message+"\n"+n.stack),n}return t},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},o.TimedHandler=function(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0},o.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},o.Connection=function(e,t){this.service=e,this.options=t||{};var n=this.options.protocol||"";0===e.indexOf("ws:")||0===e.indexOf("wss:")||0===n.indexOf("ws")?this._proto=new o.Websocket(this):this._proto=new o.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this._idleTimeout=null,this._disconnectTimeout=null,this.do_authentication=!0,this.authenticated=!1,this.disconnecting=!1,this.connected=!1,this.errors=0,this.paused=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(this._onIdle.bind(this),100);for(var i in o._connectionPlugins)if(o._connectionPlugins.hasOwnProperty(i)){var r=o._connectionPlugins[i],a=function(){};a.prototype=r,this[i]=new a,this[i].init(this)}},o.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this.authenticated=!1,this.disconnecting=!1,this.connected=!1,this.errors=0,this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(e){return"string"==typeof e||"number"==typeof e?++this._uniqueId+":"+e:++this._uniqueId+""},connect:function(e,t,n,i,r,a){this.jid=e,this.authzid=o.getBareJidFromJid(this.jid),this.authcid=o.getNodeFromJid(this.jid),this.pass=t,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.errors=0,this.domain=o.getDomainFromJid(this.jid),this._changeConnectStatus(o.Status.CONNECTING,null),this._proto._connect(i,r,a)},attach:function(e,t,n,i,r,o,a){this._proto._attach(e,t,n,i,r,o,a)},xmlInput:function(e){},xmlOutput:function(e){},rawInput:function(e){},rawOutput:function(e){},send:function(e){if(null!==e){if("function"==typeof e.sort)for(var t=0;t<e.length;t++)this._queueData(e[t]);else"function"==typeof e.tree?this._queueData(e.tree()):this._queueData(e);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendIQ:function(e,t,n,i){var r=null,o=this;"function"==typeof e.tree&&(e=e.tree());var a=e.getAttribute("id");a||(a=this.getUniqueId("sendIQ"),e.setAttribute("id",a));var s=this.addHandler(function(e){r&&o.deleteTimedHandler(r);var i=e.getAttribute("type");if("result"==i)t&&t(e);else{if("error"!=i)throw{name:"StropheError",message:"Got bad IQ type of "+i};n&&n(e)}},null,"iq",null,a);return i&&(r=this.addTimedHandler(i,function(){return o.deleteHandler(s),n&&n(null),!1})),this.send(e),a},_queueData:function(e){if(null===e||!e.tagName||!e.childNodes)throw{name:"StropheError",message:"Cannot queue non-DOMElement."};this._data.push(e)},_sendRestart:function(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(this._onIdle.bind(this),100)},addTimedHandler:function(e,t){var n=new o.TimedHandler(e,t);return this.addTimeds.push(n),n},deleteTimedHandler:function(e){this.removeTimeds.push(e)},addHandler:function(e,t,n,i,r,a,s){var c=new o.Handler(e,t,n,i,r,a,s);return this.addHandlers.push(c),c},deleteHandler:function(e){this.removeHandlers.push(e)},disconnect:function(e){if(this._changeConnectStatus(o.Status.DISCONNECTING,e),o.info("Disconnect was called because: "+e),this.connected){var t=!1;this.disconnecting=!0,this.authenticated&&(t=r({xmlns:o.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(t)}},_changeConnectStatus:function(e,t){for(var n in o._connectionPlugins)if(o._connectionPlugins.hasOwnProperty(n)){var i=this[n];if(i.statusChanged)try{i.statusChanged(e,t)}catch(r){o.error(""+n+" plugin caused an exception changing status: "+r)}}if(this.connect_callback)try{this.connect_callback(e,t)}catch(a){o.error("User connection callback caused an exception: "+a)}},_doDisconnect:function(){null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),o.info("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(o.Status.DISCONNECTED,null),this.connected=!1},_dataRecv:function(e,t){o.info("_dataRecv called");var n=this._proto._reqToData(e);if(null!==n){this.xmlInput!==o.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==o.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(o.serialize(n)));for(var i,r;this.removeHandlers.length>0;)r=this.removeHandlers.pop(),i=this.handlers.indexOf(r),i>=0&&this.handlers.splice(i,1);for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())return void this._doDisconnect();var a,s,c=n.getAttribute("type");if(null!==c&&"terminate"==c){if(this.disconnecting)return;return a=n.getAttribute("condition"),s=n.getElementsByTagName("conflict"),null!==a?("remote-stream-error"==a&&s.length>0&&(a="conflict"),this._changeConnectStatus(o.Status.CONNFAIL,a)):this._changeConnectStatus(o.Status.CONNFAIL,"unknown"),void this.disconnect("unknown stream-error")}var l=this;o.forEachChild(n,null,function(e){var t,n;for(n=l.handlers,l.handlers=[],t=0;t<n.length;t++){var i=n[t];try{!i.isMatch(e)||!l.authenticated&&i.user?l.handlers.push(i):i.run(e)&&l.handlers.push(i)}catch(r){o.warn("Removing Strophe handlers due to uncaught exception: "+r.message)}}})}},mechanisms:{},_connect_cb:function(e,t,n){o.info("_connect_cb was called"),this.connected=!0;var i=this._proto._reqToData(e);if(i){this.xmlInput!==o.Connection.prototype.xmlInput&&(i.nodeName===this._proto.strip&&i.childNodes.length?this.xmlInput(i.childNodes[0]):this.xmlInput(i)),this.rawInput!==o.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(o.serialize(i)));var r=this._proto._connect_cb(i);if(r!==o.Status.CONNFAIL){this._authentication.sasl_scram_sha1=!1,this._authentication.sasl_plain=!1,this._authentication.sasl_digest_md5=!1,this._authentication.sasl_anonymous=!1,this._authentication.legacy_auth=!1;var a=i.getElementsByTagName("stream:features").length>0;a||(a=i.getElementsByTagName("features").length>0);var s,c,l=i.getElementsByTagName("mechanism"),d=[],u=!1;if(!a)return void this._proto._no_auth_received(t);if(l.length>0)for(s=0;s<l.length;s++)c=o.getText(l[s]),this.mechanisms[c]&&d.push(this.mechanisms[c]);return this._authentication.legacy_auth=i.getElementsByTagName("auth").length>0,(u=this._authentication.legacy_auth||d.length>0)?void(this.do_authentication!==!1&&this.authenticate(d)):void this._proto._no_auth_received(t)}}},authenticate:function(e){var n;for(n=0;n<e.length-1;++n){for(var r=n,a=n+1;a<e.length;++a)e[a].prototype.priority>e[r].prototype.priority&&(r=a);if(r!=n){var s=e[n];e[n]=e[r],e[r]=s}}var c=!1;for(n=0;n<e.length;++n)if(e[n].test(this)){this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=new e[n],this._sasl_mechanism.onStart(this);var l=t("auth",{xmlns:o.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var d=this._sasl_mechanism.onChallenge(this,null);l.t(Base64.encode(d))}this.send(l.tree()),c=!0;break}c||(null===o.getNodeFromJid(this.jid)?(this._changeConnectStatus(o.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect("x-strophe-bad-non-anon-jid")):(this._changeConnectStatus(o.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),this.send(i({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:o.NS.AUTH}).c("username",{}).t(o.getNodeFromJid(this.jid)).tree())))},_sasl_challenge_cb:function(e){var n=Base64.decode(o.getText(e)),i=this._sasl_mechanism.onChallenge(this,n),r=t("response",{xmlns:o.NS.SASL});return""!==i&&r.t(Base64.encode(i)),this.send(r.tree()),!0},_auth1_cb:function(e){var t=i({type:"set",id:"_auth_2"}).c("query",{xmlns:o.NS.AUTH}).c("username",{}).t(o.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return o.getResourceFromJid(this.jid)||(this.jid=o.getBareJidFromJid(this.jid)+"/strophe"),t.up().c("resource",{}).t(o.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(t.tree()),!1},_sasl_success_cb:function(e){if(this._sasl_data["server-signature"]){var t,n=Base64.decode(o.getText(e)),i=/([a-z]+)=([^,]+)(,|$)/,r=n.match(i);if("v"==r[1]&&(t=r[2]),t!=this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}return o.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._addSysHandler(this._sasl_auth1_cb.bind(this),null,"stream:features",null,null),this._sendRestart(),!1},_sasl_auth1_cb:function(e){this.features=e;var t,n;for(t=0;t<e.childNodes.length;t++)n=e.childNodes[t],"bind"==n.nodeName&&(this.do_bind=!0),"session"==n.nodeName&&(this.do_session=!0);if(!this.do_bind)return this._changeConnectStatus(o.Status.AUTHFAIL,null),!1;this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");var r=o.getResourceFromJid(this.jid);return r?this.send(i({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:o.NS.BIND}).c("resource",{}).t(r).tree()):this.send(i({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:o.NS.BIND}).tree()),!1},_sasl_bind_cb:function(e){if("error"==e.getAttribute("type")){o.info("SASL binding failed.");var t,n=e.getElementsByTagName("conflict");return n.length>0&&(t="conflict"),this._changeConnectStatus(o.Status.AUTHFAIL,t),!1}var r,a=e.getElementsByTagName("bind");return a.length>0?(r=a[0].getElementsByTagName("jid"),void(r.length>0&&(this.jid=o.getText(r[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(i({type:"set",id:"_session_auth_2"}).c("session",{xmlns:o.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(o.Status.CONNECTED,null))))):(o.info("SASL binding failed."),this._changeConnectStatus(o.Status.AUTHFAIL,null),!1)},_sasl_session_cb:function(e){if("result"==e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(o.Status.CONNECTED,null);else if("error"==e.getAttribute("type"))return o.info("Session creation failed."),this._changeConnectStatus(o.Status.AUTHFAIL,null),!1;return!1},_sasl_failure_cb:function(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(o.Status.AUTHFAIL,null),!1},_auth2_cb:function(e){return"result"==e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(o.Status.CONNECTED,null)):"error"==e.getAttribute("type")&&(this._changeConnectStatus(o.Status.AUTHFAIL,null),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(e,t){var n=new o.TimedHandler(e,t);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(e,t,n,i,r){var a=new o.Handler(e,t,n,i,r);return a.user=!1,this.addHandlers.push(a),a},_onDisconnectTimeout:function(){return o.info("_onDisconnectTimeout was called"),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(var e,t,n,i;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;)t=this.removeTimeds.pop(),e=this.timedHandlers.indexOf(t),e>=0&&this.timedHandlers.splice(e,1);var r=(new Date).getTime();for(i=[],e=0;e<this.timedHandlers.length;e++)t=this.timedHandlers[e],(this.authenticated||!t.user)&&(n=t.lastCalled+t.period,0>=n-r?t.run()&&i.push(t):i.push(t));this.timedHandlers=i,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(this._onIdle.bind(this),100))}},e&&e(o,t,n,i,r),o.SASLMechanism=function(e,t,n){this.name=e,this.isClientFirst=t,this.priority=n},o.SASLMechanism.prototype={test:function(e){return!0},onStart:function(e){this._connection=e},onChallenge:function(e,t){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},o.SASLAnonymous=function(){},o.SASLAnonymous.prototype=new o.SASLMechanism("ANONYMOUS",!1,10),o.SASLAnonymous.test=function(e){return null===e.authcid},o.Connection.prototype.mechanisms[o.SASLAnonymous.prototype.name]=o.SASLAnonymous,o.SASLPlain=function(){},o.SASLPlain.prototype=new o.SASLMechanism("PLAIN",!0,20),o.SASLPlain.test=function(e){return null!==e.authcid},o.SASLPlain.prototype.onChallenge=function(e){var t=e.authzid;return t+="\x00",t+=e.authcid,t+="\x00",t+=e.pass},o.Connection.prototype.mechanisms[o.SASLPlain.prototype.name]=o.SASLPlain,o.SASLSHA1=function(){},o.SASLSHA1.prototype=new o.SASLMechanism("SCRAM-SHA-1",!0,40),o.SASLSHA1.test=function(e){return null!==e.authcid},o.SASLSHA1.prototype.onChallenge=function(e,t,n){var i=n||MD5.hexdigest(1234567890*Math.random()),r="n="+e.authcid;return r+=",r=",r+=i,e._sasl_data.cnonce=i,e._sasl_data["client-first-message-bare"]=r,r="n,,"+r,this.onChallenge=function(e,t){for(var n,i,r,o,a,s,c,l,d,u,p,h="c=biws,",f=e._sasl_data["client-first-message-bare"]+","+t+",",m=e._sasl_data.cnonce,E=/([a-z]+)=([^,]+)(,|$)/;t.match(E);){
var _=t.match(E);switch(t=t.replace(_[0],""),_[1]){case"r":n=_[2];break;case"s":i=_[2];break;case"i":r=_[2]}}if(n.substr(0,m.length)!==m)return e._sasl_data={},e._sasl_failure_cb();for(h+="r="+n,f+=h,i=Base64.decode(i),i+="\x00\x00\x00",o=s=core_hmac_sha1(e.pass,i),c=1;r>c;c++){for(a=core_hmac_sha1(e.pass,binb2str(s)),l=0;5>l;l++)o[l]^=a[l];s=a}for(o=binb2str(o),d=core_hmac_sha1(o,"Client Key"),u=str_hmac_sha1(o,"Server Key"),p=core_hmac_sha1(str_sha1(binb2str(d)),f),e._sasl_data["server-signature"]=b64_hmac_sha1(u,f),l=0;5>l;l++)d[l]^=p[l];return h+=",p="+Base64.encode(binb2str(d))}.bind(this),r},o.Connection.prototype.mechanisms[o.SASLSHA1.prototype.name]=o.SASLSHA1,o.SASLMD5=function(){},o.SASLMD5.prototype=new o.SASLMechanism("DIGEST-MD5",!1,30),o.SASLMD5.test=function(e){return null!==e.authcid},o.SASLMD5.prototype._quote=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},o.SASLMD5.prototype.onChallenge=function(e,t,n){for(var i,r=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,o=n||MD5.hexdigest(""+1234567890*Math.random()),a="",s=null,c="",l="";t.match(r);)switch(i=t.match(r),t=t.replace(i[0],""),i[2]=i[2].replace(/^"(.+)"$/,"$1"),i[1]){case"realm":a=i[2];break;case"nonce":c=i[2];break;case"qop":l=i[2];break;case"host":s=i[2]}var d=e.servtype+"/"+e.domain;null!==s&&(d=d+"/"+s);var u=MD5.hash(e.authcid+":"+a+":"+this._connection.pass)+":"+c+":"+o,p="AUTHENTICATE:"+d,h="";return h+="charset=utf-8,",h+="username="+this._quote(e.authcid)+",",h+="realm="+this._quote(a)+",",h+="nonce="+this._quote(c)+",",h+="nc=00000001,",h+="cnonce="+this._quote(o)+",",h+="digest-uri="+this._quote(d)+",",h+="response="+MD5.hexdigest(MD5.hexdigest(u)+":"+c+":00000001:"+o+":auth:"+MD5.hexdigest(p))+",",h+="qop=auth",this.onChallenge=function(){return""}.bind(this),h},o.Connection.prototype.mechanisms[o.SASLMD5.prototype.name]=o.SASLMD5}(function(){window.Strophe=arguments[0],window.$build=arguments[1],window.$msg=arguments[2],window.$iq=arguments[3],window.$pres=arguments[4]}),Strophe.Request=function(e,t,n,i){this.id=++Strophe._requestId,this.xmlData=e,this.data=Strophe.serialize(e),this.origFunc=t,this.func=t,this.rid=n,this.date=NaN,this.sends=i||0,this.abort=!1,this.dead=null,this.age=function(){if(!this.date)return 0;var e=new Date;return(e-this.date)/1e3},this.timeDead=function(){if(!this.dead)return 0;var e=new Date;return(e-this.dead)/1e3},this.xhr=this._newXHR()},Strophe.Request.prototype={getResponse:function(){var e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if(e=this.xhr.responseXML.documentElement,"parsererror"==e.tagName)throw Strophe.error("invalid response received"),Strophe.error("responseText: "+this.xhr.responseText),Strophe.error("responseXML: "+Strophe.serialize(this.xhr.responseXML)),"parsererror"}else this.xhr.responseText&&(Strophe.error("invalid response received"),Strophe.error("responseText: "+this.xhr.responseText),Strophe.error("responseXML: "+Strophe.serialize(this.xhr.responseXML)));return e},_newXHR:function(){var e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml")):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}},Strophe.Bosh=function(e){this._conn=e,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this._requests=[]},Strophe.Bosh.prototype={strip:null,_buildBody:function(){var e=$build("body",{rid:this.rid++,xmlns:Strophe.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),e},_reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null},_connect:function(e,t,n){this.wait=e||this.wait,this.hold=t||this.hold;var i=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":Strophe.NS.BOSH});n&&i.attrs({route:n});var r=this._conn._connect_cb;this._requests.push(new Strophe.Request(i.tree(),this._onRequestStateChange.bind(this,r.bind(this._conn)),i.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(e,t,n,i,r,o,a){this._conn.jid=e,this.sid=t,this.rid=n,this._conn.connect_callback=i,this._conn.domain=Strophe.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=r||this.wait,this.hold=o||this.hold,this.window=a||this.window,this._conn._changeConnectStatus(Strophe.Status.ATTACHED,null)},_connect_cb:function(e){var t,n,i=e.getAttribute("type");if(null!==i&&"terminate"==i)return Strophe.error("BOSH-Connection failed: "+t),t=e.getAttribute("condition"),n=e.getElementsByTagName("conflict"),null!==t?("remote-stream-error"==t&&n.length>0&&(t="conflict"),this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,t)):this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(),Strophe.Status.CONNFAIL;this.sid||(this.sid=e.getAttribute("sid"));var r=e.getAttribute("requests");r&&(this.window=parseInt(r,10));var o=e.getAttribute("hold");o&&(this.hold=parseInt(o,10));var a=e.getAttribute("wait");a&&(this.wait=parseInt(a,10))},_disconnect:function(e){this._sendTerminate(e)},_doDisconnect:function(){this.sid=null,this.rid=Math.floor(4294967295*Math.random())},_emptyQueue:function(){return 0===this._requests.length},_hitError:function(e){this.errors++,Strophe.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._onDisconnectTimeout()},_no_auth_received:function(e){e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);var t=this._buildBody();this._requests.push(new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,e.bind(this._conn)),t.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){for(var e;this._requests.length>0;)e=this._requests.pop(),e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}},_onIdle:function(){var e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(Strophe.info("no requests during idle cycle, sending blank request"),e.push(null)),this._requests.length<2&&e.length>0&&!this._conn.paused){for(var t=this._buildBody(),n=e.length,i=0;i<e.length;i++)if(null!==e[i])if("restart"===e[i])t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":Strophe.NS.BOSH});else if(t.cnode(e[i]).up(),+e[i].getAttribute("size")>2e4){n=i+1;break}this._conn._data.splice(0,n),t.tree().setAttribute("process-delay",10),this._requests.push(new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"))),this._processRequest(this._requests.length-1)}if(this._requests.length>0){var r=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),r>Math.floor(Strophe.TIMEOUT*this.wait)&&(Strophe.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(Strophe.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}},_onRequestStateChange:function(e,t){if(Strophe.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState),t.abort)return void(t.abort=!1);var n;if(4==t.xhr.readyState){n=0;try{n=t.xhr.status}catch(i){}if("undefined"==typeof n&&(n=0),this.disconnecting&&n>=400)return void this._hitError(n);var r=this._requests[0]==t,o=this._requests[1]==t;(n>0&&500>n||t.sends>5)&&(this._removeRequest(t),Strophe.debug("request id "+t.id+" should now be removed")),200==n?((o||r&&this._requests.length>0&&this._requests[0].age()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),Strophe.debug("request id "+t.id+"."+t.sends+" got 200"),e(t),this.errors=0):(Strophe.error("request id "+t.id+"."+t.sends+" error "+n+" happened"),(0===n||n>=400&&600>n||n>=12e3)&&(this._hitError(n),n>=400&&500>n&&(this._conn._changeConnectStatus(Strophe.Status.DISCONNECTING,null),this._conn._doDisconnect()))),n>0&&500>n||t.sends>5||this._throttledRequestHandler()}},_processRequest:function(e){var t=this,n=this._requests[e],i=-1;try{4==n.xhr.readyState&&(i=n.xhr.status)}catch(r){Strophe.error("caught an error in _requests["+e+"], reqStatus: "+i)}if("undefined"==typeof i&&(i=-1),n.sends>this.maxRetries)return void this._onDisconnectTimeout();var o=n.age(),a=!isNaN(o)&&o>Math.floor(Strophe.TIMEOUT*this.wait),s=null!==n.dead&&n.timeDead()>Math.floor(Strophe.SECONDARY_TIMEOUT*this.wait),c=4==n.xhr.readyState&&(1>i||i>=500);if((a||s||c)&&(s&&Strophe.error("Request "+this._requests[e].id+" timed out (secondary), restarting"),n.abort=!0,n.xhr.abort(),n.xhr.onreadystatechange=function(){},this._requests[e]=new Strophe.Request(n.xmlData,n.origFunc,n.rid,n.sends),n=this._requests[e]),0===n.xhr.readyState){Strophe.debug("request id "+n.id+"."+n.sends+" posting");try{n.xhr.open("POST",this._conn.service,!this._conn.options.sync)}catch(l){return Strophe.error("XHR open failed."),this._conn.connected||this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}var d=function(){if(n.date=new Date,t._conn.options.customHeaders){var e=t._conn.options.customHeaders;for(var i in e)e.hasOwnProperty(i)&&n.xhr.setRequestHeader(i,e[i])}n.xhr.send(n.data)};if(n.sends>1){var u=1e3*Math.min(Math.floor(Strophe.TIMEOUT*this.wait),Math.pow(n.sends,3));setTimeout(d,u)}else d();n.sends++,this._conn.xmlOutput!==Strophe.Connection.prototype.xmlOutput&&(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length?this._conn.xmlOutput(n.xmlData.childNodes[0]):this._conn.xmlOutput(n.xmlData)),this._conn.rawOutput!==Strophe.Connection.prototype.rawOutput&&this._conn.rawOutput(n.data)}else Strophe.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+n.xhr.readyState)},_removeRequest:function(e){Strophe.debug("removing request");var t;for(t=this._requests.length-1;t>=0;t--)e==this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(e){var t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)},_reqToData:function(e){try{return e.getResponse()}catch(t){if("parsererror"!=t)throw t;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){Strophe.info("_sendTerminate was called");var t=this._buildBody().attrs({type:"terminate"});e&&t.cnode(e.tree());var n=new Strophe.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(this._conn._onIdle.bind(this._conn),100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?Strophe.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):Strophe.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}},Strophe.Websocket=function(e){this._conn=e,this.strip="stream:stream";var t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){var n="";n+="ws"===e.options.protocol&&"https:"!==window.location.protocol?"ws":"wss",n+="://"+window.location.host,n+=0!==t.indexOf("/")?window.location.pathname+t:t,e.service=n}},Strophe.Websocket.prototype={_buildStream:function(){return $build("stream:stream",{to:this._conn.domain,xmlns:Strophe.NS.CLIENT,"xmlns:stream":Strophe.NS.STREAM,version:"1.0"})},_check_streamerror:function(e,t){var n=e.getElementsByTagName("stream:error");if(0===n.length)return!1;for(var i=n[0],r="",o="",a="urn:ietf:params:xml:ns:xmpp-streams",s=0;s<i.childNodes.length;s++){var c=i.childNodes[s];if(c.getAttribute("xmlns")!==a)break;"text"===c.nodeName?o=c.textContent:r=c.nodeName}var l="WebSocket stream error: ";return l+=r?r:"unknown",o&&(l+=" - "+r),Strophe.error(l),this._conn._changeConnectStatus(t,r),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=this._onOpen.bind(this),this.socket.onerror=this._onError.bind(this),this.socket.onclose=this._onClose.bind(this),this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(e){var t=this._check_streamerror(e,Strophe.Status.CONNFAIL);return t?Strophe.Status.CONNFAIL:void 0},_handleStreamStart:function(e){var t=!1,n=e.getAttribute("xmlns");"string"!=typeof n?t="Missing xmlns in stream:stream":n!==Strophe.NS.CLIENT&&(t="Wrong xmlns in stream:stream: "+n);var i=e.namespaceURI;"string"!=typeof i?t="Missing xmlns:stream in stream:stream":i!==Strophe.NS.STREAM&&(t="Wrong xmlns:stream in stream:stream: "+i);var r=e.getAttribute("version");return"string"!=typeof r?t="Missing version in stream:stream":"1.0"!==r&&(t="Wrong version in stream:stream: "+r),t?(this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,t),this._conn._doDisconnect(),!1):!0},_connect_cb_wrapper:function(e){if(0===e.data.indexOf("<stream:stream ")||0===e.data.indexOf("<?xml")){var t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;t=e.data.replace(/<stream:stream (.*[^\/])>/,"<stream:stream $1/>");var n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(e.data),this._handleStreamStart(n)&&(this._connect_cb(n),this.streamStart=e.data.replace(/^<stream:(.*)\/>$/,"<stream:$1>"))}else{if("</stream:stream>"===e.data)return this._conn.rawInput(e.data),this._conn.xmlInput(document.createElement("stream:stream")),this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"Received closing stream"),void this._conn._doDisconnect();var i=this._streamWrap(e.data),r=(new DOMParser).parseFromString(i,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this),this._conn._connect_cb(r,null,e.data)}},_disconnect:function(e){if(this.socket.readyState!==WebSocket.CLOSED){e&&this._conn.send(e);var t="</stream:stream>";this._conn.xmlOutput(document.createElement("stream:stream")),this._conn.rawOutput(t);try{this.socket.send(t)}catch(n){Strophe.info("Couldn't send closing stream tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){Strophe.info("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(e){return this.streamStart+e+"</stream:stream>"},_closeSocket:function(){if(this.socket)try{this.socket.close()}catch(e){}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(){this._conn.connected&&!this._conn.disconnecting?(Strophe.error("Websocket closed unexcectedly"),this._conn._doDisconnect()):Strophe.info("Websocket closed")},_no_auth_received:function(e){Strophe.error("Server did not send any auth methods"),this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"Server did not send any auth methods"),e&&(e=e.bind(this._conn))(),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_onError:function(e){Strophe.error("Websocket error "+e),this._conn._changeConnectStatus(Strophe.Status.CONNFAIL,"The WebSocket connection could not be established was disconnected."),this._disconnect()},_onIdle:function(){var e=this._conn._data;if(e.length>0&&!this._conn.paused){for(var t=0;t<e.length;t++)if(null!==e[t]){var n,i;"restart"===e[t]?(n=this._buildStream(),i=this._removeClosingTag(n),n=n.tree()):(n=e[t],i=Strophe.serialize(n)),this._conn.xmlOutput(n),this._conn.rawOutput(i),this.socket.send(i)}this._conn._data=[]}},_onMessage:function(e){var t,n;if("</stream:stream>"===e.data){var i="</stream:stream>";return this._conn.rawInput(i),this._conn.xmlInput(document.createElement("stream:stream")),void(this._conn.disconnecting||this._conn._doDisconnect())}if(0===e.data.search("<stream:stream ")){if(n=e.data.replace(/<stream:stream (.*[^\/])>/,"<stream:stream $1/>"),t=(new DOMParser).parseFromString(n,"text/xml").documentElement,!this._handleStreamStart(t))return}else n=this._streamWrap(e.data),t=(new DOMParser).parseFromString(n,"text/xml").documentElement;return this._check_streamerror(t,Strophe.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstChild.nodeName&&"unavailable"===t.firstChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(Strophe.serialize(t))):void this._conn._dataRecv(t,e.data)},_onOpen:function(){Strophe.info("Websocket open");var e=this._buildStream();this._conn.xmlOutput(e.tree());var t=this._removeClosingTag(e);this._conn.rawOutput(t),this.socket.send(t)},_removeClosingTag:function(e){var t=Strophe.serialize(e);return t=t.replace(/<(stream:stream .*[^\/])\/>$/,"<$1>")},_reqToData:function(e){return e},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}},define("common/extensions/strophe.base",function(){}),define("common/extensions/strophe",["common/extensions/strophe.base"],function(){Strophe.xmlTextNode=function(e){return Strophe.xmlGenerator().createTextNode(e)},Strophe.getText=function(e){if(!e)return null;var t="";0===e.childNodes.length&&e.nodeType==Strophe.ElementType.TEXT&&(t+=e.nodeValue);for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType==Strophe.ElementType.TEXT&&(t+=e.childNodes[n].nodeValue);return t},Strophe.addConnectionPlugin("receipts",{_conn:null,_msgQueue:{},_retries:{},_resendCount:0,_resendTime:9e3,_callbacks:[],init:function(e){this._conn=e,Strophe.addNamespace("RECEIPTS","urn:xmpp:receipts")},statusChanged:function(e){if(e===Strophe.Status.CONNECTED||e===Strophe.Status.ATTACHED){this._conn.addHandler(this._onRequestReceived.bind(this),Strophe.NS.RECEIPTS,"message");var t=this;setTimeout(function(){t.resendQueue()},5e3)}},_onRequestReceived:function(e){return this._processReceipt(e),!0},sendMessage:function(e,t){t=t||this._conn.getUniqueId(),e.tree().setAttribute("id",t);var n=Strophe.xmlElement("request",{xmlns:Strophe.NS.RECEIPTS});return e.tree().appendChild(n),this._msgQueue[t]=e,this._retries[t]=0,this._conn.send(e.tree()),this.resendMessage(t),t},messageStatus:function(e){this._callbacks.push(e)},_setMessageStatus:function(e,t){},resendMessage:function(e){var t=this;setTimeout(function(){if(t._msgQueue[e]){if(t._setMessageStatus(e,"resending"),!t._conn.connected)return void t.resendMessage(e);if(t._retries[e]++,t._retries[e]>t._resendCount)return t._setMessageStatus(e,"failed"),delete t._msgQueue[e],void delete t._retries[e];t._msgQueue[e].tree().setAttribute("from",t._conn.jid),t._conn.send(t._msgQueue[e].tree()),t.resendMessage(e)}},this._resendTime)},addReceiptHandler:function(e,t,n,i){var r=this,o=function(t){return r._processReceipt(t),e(t)};this._conn.addHandler(o,Strophe.NS.RECEIPTS,"message",t,null,n,i)},_processReceipt:function(e){var t=e.getAttribute("id"),n=e.getAttribute("from"),i=e.getAttribute("type"),r=e.getElementsByTagName("request"),o=e.getElementsByTagName("received");if("error"!=i){if(r.length>0){var a=e.getAttribute("jid"),s=$msg({to:n,from:this._conn.jid,id:this._conn.getUniqueId(),jid:a}),c=Strophe.xmlElement("received",{xmlns:Strophe.NS.RECEIPTS,id:t});s.tree().appendChild(c),this._conn.send(s)}if(o.length>0){var l=o[0].getAttribute("id");l&&(delete this._msgQueue[l],delete this._retries[l],this._setMessageStatus(l,"done"))}}},resendQueue:function(){if(!this._conn.connected){var e=this;return void setTimeout(function(){e.resendQueue()},5e3)}for(var t in this._msgQueue)this._msgQueue.hasOwnProperty(t)&&(this._retries[t]++,this._retries[t]<=this._resendCount&&this._conn.send(this._msgQueue[t].tree()))},getUnreceivedMsgs:function(){var e=[];for(var t in this._msgQueue)this._msgQueue.hasOwnProperty(t)&&e.push(this._msgQueue[t]);return e},clearMessages:function(){this._msgQueue={}}})}),define("xmpp/connection",["application/dispatcher","common/extensions/debug","config/setup","application/session.objects","common/extensions/strophe","common/extensions/browserDetect"],function(e,t,n,i,r,o){var a={disconnecting:!1,_errorHandlers:[],_reconId:null,_connection:null,_messageHandler:null,_reconnecting:!1,_attached:!1,_isConnecting:!1,_isConnected:!1,_reconnectTimeout:4e3,_defaultReconnectTimeout:4e3,_maxTimeout:3e4,_timeoutStep:1500,_connectionIndex:0,setMessageHandler:function(e){this._messageHandler=e},init:function(r){var o=localStorage.rhlpws;"undefined"==typeof o&&(o=n.WEBSOCKET);var s=o?n.WS_SERVICE:n.BOSH_SERVICE;this._connection=new Strophe.Connection(s),this._connection.rawInput=function(e){t.log("RECV: "+e);try{i.jid=a._connection.jid,i.rid=a._connection._proto.rid,i.sid=a._connection._proto.sid,i.lastXMPPTransfer=(new Date).getTime()}catch(n){t.error(n)}},this._connection.rawOutput=function(e){t.log("SEND: "+e);try{i.jid=a._connection.jid,i.rid=a._connection._proto.rid,i.sid=a._connection._proto.sid,i.lastXMPPTransfer=(new Date).getTime()}catch(n){t.error(n)}},this._connection.addHandler(a._messageHandler,null,"message",null,null,null),this._connection._hitError=function(e){var t;a._connection.errors++,a._connection.errors>4&&a._connection._onDisconnectTimeout();for(t in a._errorHandlers)a._errorHandlers.hasOwnProperty(t)&&"function"==typeof a._errorHandlers[t]&&a._errorHandlers[t](e,a._connection.errors)},this._connection.connect(n.XMPP_DOMAIN,"",a.onStatusChanged,50,3),e.fire("Connection.initialized")},addErrorHandler:function(e){"function"==typeof e&&this._errorHandlers.push(e)},removeErrorHandlers:function(){this._errorHandlers=[]},checkPresence:function(){var e=$iq({type:"get"}).c("query",{xmlns:"consultant:presence",from:n.XMPP_DOMAIN,to:n.CLIENT_NAME.toOperatorJid()});this._connection.sendIQ(e.tree(),this.onPresence,a.reconnect,7e3)},disconnect:function(){a.disconnecting=!0,this._connection.disconnect()},pause:function(){a.paused=!0,this._connection.pause()},resume:function(){a.paused=!1,this._connection.resume()},reconnect:function(){a.disconnecting=!1,i.reconnecting=!0,this._connection.disconnect()},onStatusChanged:function(t,r){if(this._isConnecting=t==Strophe.Status.CONNECTING||t==Strophe.Status.AUTHENTICATING,t===Strophe.Status.CONNECTED||t===Strophe.Status.ATTACHED){a._isConnected=!0,e.fire("connected");var o=++a._connectionIndex;setTimeout(function(){o==a._connectionIndex&&e.fire("connection.canStormPackets",{canStormPackets:!0})},3e3+3e3*Math.random()),i.reconnecting&&(e.fire("refreshHistory"),i.reconnecting=!1),t===Strophe.Status.ATTACHED&&(e.fire("attached"),a._attached=!0),a._reconnectTimeout=a._defaultReconnectTimeout}else(t===Strophe.Status.DISCONNECTING||t===Strophe.Status.ERROR||t===Strophe.Status.CONNFAIL||t===Strophe.Status.AUTHFAIL)&&(a._connectionIndex++,e.fire("connection.canStormPackets",{canStormPackets:!1}),a._isAuthenticated=!1,a._isConnected=!1,a.disconnecting||(null===a._reconId&&(a._reconId=setTimeout(function(){a._connection.reset(),i.reconnecting=!0,a._connection.connect(n.XMPP_DOMAIN,"",a.onStatusChanged,50),a._connection.addHandler(a._messageHandler,null,"message",null,null,null),a._reconId=null},a._reconnectTimeout)),a._reconnectTimeout+=Math.random()*a._timeoutStep+a._timeoutStep,a._reconnectTimeout>a._maxTimeout&&(a._reconnectTimeout=a._maxTimeout)));return!0},onPresence:function(t){e.fire("connected")},isAuthenticated:function(){return this._isAuthenticated},isConnected:function(){return!!a._isConnected},isConnecting:function(){return!!a._isConnecting}};return a}),define("view/chat",["common/extensions/jquery.plugins","application/dispatcher","common/constants/sender","application/session.objects","config/lang","common/constants/chatState","application/parent","common/application/time","view/template","common/extensions/browserDetect","xmpp/connection"],function(e,t,n,i,r,o,a,s,c,l,d){e.valHooks.textarea={get:function(e){return e.value.replace(/\r?\n/g,"\r\n")}};var u=!1,p=null,h={_displayElem:null,_lastMessageFrom:null,_typingTimer:0,_isTyping:!1,_baron:null,_messages:[],_highlightLinks:function(e){return e.replace(/(((http|https|ftp)[:][\/][\/])?([\w\d_\-\.--]*@)?(([\w\d_\---]+)\.)+(\w{2,4}|)([\/]\S*)*)(\s|$)/gm,function(e,t,n,i,r,o,a,s,c,l){return'<a target="_blank" href="'+(t.indexOf("@")>-1?"mailto:":t.indexOf("://")>-1?"":"http://")+t+'">'+t+"</a>"+l})},_escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\n/g,"<br>")},_decorateFile:function(e){var t=e.text.split("/"),i=t[t.length-1],o=i.split("."),a=o[o.length-1].toLowerCase(),s="unknown";return" png jpg jpeg bmp ico psd ".indexOf(" "+a+" ")>-1&&(s="image"),"pdf"===a&&(s="pdf"),("doc"===a||"docx"===a||"odt"===a)&&(s="word"),"txt"===a&&(s="txt"),r["FILE_SENT_"+(e.sender===n.OPERATOR?"OPERATOR":"VISITOR")]+'<div class="file"><a target="_blank" title="'+r.FILE_SENT_DOWNLOAD+'" href="'+e.text+'"><span class="icon '+s+'"></span>'+decodeURIComponent(i)+'</a><div style="clear: both"></div>'},_decorate:function(t,i,r,o,a){var s=void 0!==r;void 0===i&&(i=!1);var l,d=t.text,u={},p=!1;for(l in t)t.hasOwnProperty(l)&&(u[l]=t[l]);var h=new Date(t.unixTime);u.date=h.getDate()>9?h.getDate():"0"+h.getDate(),u.date+="."+(h.getMonth()>8?h.getMonth()+1:"0"+(h.getMonth()+1)),u.date+="."+h.getFullYear(),u.time=u.time.substring(0,5),~d.indexOf("//data.redhelper.ru/messagefiles")||~d.indexOf("//media.redhelper.ru")?(p=!0,d=this._decorateFile(t)):i||(d=o?t.text:this._highlightLinks(this._escapeHtml(t.text))),u.text=d;var f=t.sender===n.OPERATOR?"fromOperator":"fromVisitor",m=c.processTemplate("#"+f,u),E=c.processTemplate("#"+f+"Header",u),_=e(m);i&&_.addClass("invitationMessage"),(this._lastMessageFrom!==t.displayName||i)&&_.prepend(E),_.attr("id",t.guid);var v=e("<div></div>").append(_);t.className&&v.addClass(t.className),p&&v.children().addClass("fileWrapper");var g=v.html();return s&&(this._lastMessageFrom!==t.displayName?e(".msgBlock").length?e(".msgBlock:last",r).after('<div class="msgBlock '+f+'">'+g+"</div>"):e("#invitation",r).after('<div class="msgBlock '+f+'">'+g+"</div>"):e(".msgBlock:last",r).append(g)),i||(this._lastMessageFrom=t.displayName),g},_decorateRedirectPrompt:function(t,n){var i,r=t.text,o={};for(i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);var a=new Date(t.unixTime);o.date=a.getDate()>9?a.getDate():"0"+a.getDate(),o.date+="."+(a.getMonth()>8?a.getMonth()+1:"0"+(a.getMonth()+1)),o.date+="."+a.getFullYear(),o.promptTime=o.time.substring(0,5),o.text=r;var s=c.processTemplate("#promptContainer",o),l=e(s),d=e("<div></div>").append(l),u=d.html();return e(".msgBlock").length?e(".msgBlock:last",n).after('<div class="msgBlock">'+u+"</div>"):e(n).append('<div class="msgBlock">'+u+"</div>"),u},setOutput:function(n){"string"==typeof n?this._displayElem=e(n):this._displayElem=n,this._displayElem.on("click",".promptButton",function(){return e(this).hasClass("yes")?(t.fire("redirectOK",{link:e(this).data("link")}),!1):(e(this).parents(".msg").fadeOut("slow",function(){e(this).siblings().length||(h._lastMessageFrom=r.YOU_LABEL,e(this).parents(".msgBlock").remove()),t.fire("redirectCancel")}),!0)}),p&&(h.showLabel(p.text,p.loading),p=null),this._displayElem.append("<div id='stickyMessage' style='display: none'><a id='stickyMessageClose'></a><div id='stickyMessageBody'></div></div>"),this._displayElem.find("#stickyMessageClose").click(function(){t.fire("hideMessage")})},appendMessage:function(e){this._displayElem.find("#stickyMessageBody").html(e),this._displayElem.find("#stickyMessage").show(),this.scrollBottom()},hideMessage:function(){this._displayElem.find("#stickyMessageBody").html(""),this._displayElem.find("#stickyMessage").hide(),this.scrollBottom()},append:function(t){if(!t.hide&&0!==t.text.indexOf(":g")&&0!==t.text.indexOf(":")){for(var i=this._messages.length-1;i>0&&this._messages[i].id&&this._messages[i].id>t.id;)i-=1;t.pushAfter=i>0?this._messages[i].id:0,t.pushAfter&&t.pushAfter===t.id&&this._messages[i].text===t.text||(this._messages.push(t),this._messages.sort(function(e,t){return e.id&&t.id?e.id-t.id:-1*(e.time<t.time)+(e.time>t.time)}),this._displayElem&&(t.sender===n.VISITOR&&(t.displayName=r.YOU_LABEL),t.time||(t.time=s.now().toString()),this._decorate(t,!1,this._displayElem),"Android"===l.OS&&navigator.userAgent.indexOf("Android 2")>-1&&this._displayElem.css("height",e("body").height()/parseFloat(e("body").css("fontSize"))-16+"em"),this.scrollBottom()))}},showTyping:function(){if(this._displayElem&&!this._isTyping){this._isTyping=!0,e("#typingLabel .text").html(i.operDisplayName+r.TYPING_LABEL+"..."),e("#typingLabel").show();var t=3,n=e("#typingLabel .text",this._displayElem);this._typingTimer=setInterval(function(){t>2?(n.html(i.operDisplayName+r.TYPING_LABEL),t=0):(n.html(n.html()+"."),t+=1)},800),this.scrollBottom()}},showLabel:function(t,n){return this._displayElem?(n?e("#chatLabel").addClass("loading"):e("#chatLabel").removeClass("loading"),e("#chatLabel").find(".text").html(t),e("#operatorName").html(i.operDisplayName),e("#chatLabel").show(),void this.scrollBottom()):void(p={text:t,loading:n})},hideLabel:function(){return this._displayElem?(e("#chatLabel").removeClass("loading"),e("#chatLabel").hide(),void this.scrollBottom()):void(p=null)},hideTyping:function(){this._displayElem&&this._isTyping&&(e("#typingLabel").hide(),clearInterval(this._typingTimer),this._isTyping=!1)},showFirstMessage:function(t){return!this._displayElem||u?void(t.sender===n.OPERATOR&&e(".msg.invitationMessage .sender").text(t.displayName)):(t.sender===n.VISITOR&&(t.displayName=r.YOU_LABEL),t.time=s.now().toString(),t.unixTime=(new Date).getTime(),this._displayElem.prepend(this._decorate(t,!0)),u=!0,void this.scrollBottom())},scrollBottom:function(){this._displayElem.trigger("sizeChange");var t=this._displayElem[0];t.scrollTop=t.scrollHeight,e(".time").disableTextSelect()},clear:function(){this._displayElem.html(""),this._lastMessageFrom=null},showRedirectPrompt:function(e){if(this._displayElem){e.indexOf("://")<0&&(e="http://"+e);var t='<div class="promptButtonWrapper"><a class="promptButton yes" data-link="'+e+'">'+r.PROMPT_BUTTON_YES+'</a><a class="promptButton no">'+r.PROMPT_BUTTON_NO+'</a><div style="clear: both"></div></div>',c={displayName:i.operDisplayName,sender:n.OPERATOR,time:s.now().toString(),unixTime:(new Date).getTime(),text:'<div id="promptWrapper"><div class="promptLabel">'+r.PROMPT_LABEL+"</div>"+t+"</div>"};this._displayElem.find("#promptWrapper").parents(".msgBlock").remove(),this._decorateRedirectPrompt(c,this._displayElem),this.scrollBottom(),this.hideTyping(),i.chatState===o.MINIMIZED&&a.send("openChat")}},replaceMessage:function(t){e("#"+t.guid+" .textWrapper .text").html(this._highlightLinks(t.text)),this.hideTyping()}};return t.addEventListener("showLabel",function(e){h.showLabel(e.text,e.loading)}),t.addEventListener("hideLabel",function(e){h.hideLabel()}),t.addEventListener("replaceMessage",function(e){h.replaceMessage(e)}),a.addHandler("resizeFont",function(n){e("body").css("font-size",n.size),t.addEventListener("changeDepartment",function(){e("body").css("font-size",n.size)})}),a.addHandler("chatOpened",function(){t.fire("chatOpened")}),navigator.userAgent.indexOf("Android 2")>-1&&a.addHandler("chatOpened",function(){setTimeout(function(){h._displayElem.css("height",e("body").height()/parseFloat(e("body").css("fontSize"))-16+"em")},500)}),t.addEventListener("appendProgressBar",function(e){h._displayElem.append(e.element),h.scrollBottom()}),t.addEventListener("renderChat",function(){h._displayElem.trigger("sizeChange"),h.scrollBottom()}),t.addEventListener("appendMessage",function(e){h.appendMessage(e.html)}),t.addEventListener("hideMessage",function(){h.hideMessage()}),t.addEventListener("Connection.initialized",function(){d._connection.receipts.messageStatus(function(t,n){
var i=e("#"+t+" .delivery");i.removeClass("resending"),i.addClass(n)})}),h}),define("view/minbox",["application/dispatcher","common/extensions/jquery.plugins","application/session.objects","common/extensions/browserDetect"],function(e,t,n,i){if(!i.isMobile){var r=5.2,o=6.25,a=function(){return function(){try{if(n.offlineFields&&0===n.offlineFields.length)return;var i=t("#offline .topPanel"),a=t("#feedbackForm"),s=t("#offline").css("display");"none"===s&&t("#offline").show(),i.css("width","218px"),i.css("height","auto");var c=Math.max(0,Math.min(i.height()/parseInt(i.css("font-size"),10)-r,6));if(c!==c)return;"none"===s&&t("#offline").hide(),i.css("height",r+c+"em"),a.css("top",o+c+"em"),i.css("width",""),e.fire("sendResize",{height:380+c*parseInt(i.css("font-size"),10)})}catch(l){}}}();n.dispatcher.addEventListener("onOfflineTextChanged",function(){a()}),e.addEventListener("refreshOfflineForm",a)}}),define("view/operatorRates",["config/setup","common/extensions/jquery.plugins","application/session.objects","application/dispatcher"],function(e,t,n,i){var r=function(r,o){t.ajax({url:e.RATE_URL,method:"GET",data:{operator:r,rate:o,vid:n.vid},success:function(e){if("Ok"===e){var t=n.operatorRates;t[r]=o,n.operatorRates=t,i.fire("operatorRated",{name:r,value:o})}},error:function(){i.fire("operatorRateError")}})};return{init:function(){i.addEventListener("rateOperator",function(e){r(n.currentOperator,e.value)}),i.addEventListener("operatorRated",function(e){void 0!==n.operatorRates[n.currentOperator]&&(t("#like, #dislike").removeClass("active"),t(n.operatorRates[n.currentOperator]?"#like":"#dislike").addClass("active"))}),i.addEventListener("operator",function(e){t("#like, #dislike").removeClass("active"),void 0!==n.operatorRates[n.currentOperator]&&t(n.operatorRates[n.currentOperator]?"#like":"#dislike").addClass("active")}),t("#like").click(function(){i.fire("rateOperator",{value:1})}),t("#dislike").click(function(){i.fire("rateOperator",{value:0})})}}}),define("view/progressBar",["common/extensions/jquery.plugins","application/dispatcher"],function(e,t){var n=function(){this._element=e("<div class='progressBarWrapper'><span class='legend'></span><div class='progressBar'><div class='progress'></div></div></div>")};return n.prototype.setLegend=function(e){this._element.find(".legend").html(e)},n.prototype.append=function(){t.fire("appendProgressBar",{element:this._element})},n.prototype.remove=function(){this._element.detach()},n.prototype.fadeOut=function(e){var t=this;this._element.fadeOut(600,function(){t._element.detach(),e()})},n.prototype.setProgress=function(e){this._part=Math.min(e,1),100*e>=99?(this._element.find(".progress").css("width","auto"),this._element.find(".percentage").html("100%")):(this._element.find(".progress").css("width",100*e+"%"),this._element.find(".percentage").html(Math.round(100*e)+"%"))},n.prototype.expWait=function(){var e=this;void 0===e._part&&(e._part=0);var t=Math.max(e._part,.9);this._waitId=setInterval(function(){e.setProgress(e._part+.05*(t-e._part))},100)},n.prototype.endWait=function(e){try{clearInterval(this._waitId)}catch(t){}var n=this._part,i=this;this._waitId=setInterval(function(){i.setProgress(i._part+.1*(1-n)),i._part>=1&&(clearInterval(i._waitId),i.fadeOut(e))},100)},n}),define("view/sendFile",["application/dispatcher","jquery","config/setup","application/parent","config/lang","common/constants/sender","common/communication/messageTarget","view/progressBar","common/extensions/browserDetect","application/session.objects"],function(e,t,n,i,r,o,a,s,c,l){function d(e){if(e.dataTransfer.types)for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"===e.dataTransfer.types[t])return!0;return!1}if(!l.free){var u=!1,p=!1;if(window.FileReader&&"Opera"!==c.browser){i.addHandler("fileDragged",function(){u=!0,FileReader&&t("body").addClass("fileDragged")}),i.addHandler("endDrag",function(){u=!1,u||p||setTimeout(function(){u||p||t("body").removeClass("fileDragged")},30)});var h=function(){var i=null;l.free||t(document).on({dragover:function(e){FileReader&&d(e.originalEvent)&&(e.preventDefault(),clearInterval(i),i=setInterval(function(){p=!1,u||t("body").removeClass("fileDragged"),clearInterval(i)},400),p||(p=!0,t("body").addClass("fileDragged")))}});var a=function(i){var a=new FormData,c=new s;c.setLegend(r.UPLOAD_LEGEND+" "+i.name),c.append(),c.setProgress(.01);var l=function(e){if(e.lengthComputable){var t=e.loaded/e.total;c.setProgress(.7*t),t>.96&&c.expWait()}return!0},d=!1,u=function(t){c.endWait(function(){d||(e.fire("fileAppended",{link:t,from:o.VISITOR}),d=!0)})},p=function(t){c.remove(),e.fire("showLabel",{loading:!1,text:413===t.status?r.UPLOAD_ERROR:r.UPLOAD_ERROR_TYPE}),setTimeout(function(){e.fire("hideLabel")},5e3)};a.append("file",i),t.ajax({url:n.FILE_UPLOAD,type:"POST",xhr:function(){var e=t.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",l,!1),e},success:u,error:p,data:a,cache:!1,contentType:!1,processData:!1})};l.free||(t("<div id='dropArea'><div><div>"+r.DROP_HERE+"</div></div></div>").appendTo("#online"),t("#dropArea").on({drop:function(e){e.preventDefault();for(var t=e.originalEvent,n=t.dataTransfer.files,i=0;i<n.length;i++)a(n[i]);return!1}}),t("#uploadedFile").change(function(){a(t(this)[0].files[0])}),t("#fileUploadWrapper .text").html(r.FILE_UPLOAD))};e.addEventListener("ready",h)}var f;e.addEventListener("ready",function(){var i={};f=t('<iframe src="'+n.FILE_FRAME+'"/>'),f.bind("load",function(t){if(f[0].contentWindow.location.href.indexOf("web.redhelper.ru/nx/upload")>-1||f[0].contentWindow.location.href.indexOf("web.redhelper.com/nx/upload")>-1){var a=f[0].contentWindow.document.body.innerHTML;if(a.indexOf("Too Large")>-1)return i.remove(),e.fire("showLabel",{loading:!1,text:r.UPLOAD_ERROR}),setTimeout(function(){e.fire("hideLabel")},5e3),void(f[0].contentWindow.document.location.href=n.FILE_FRAME);if(-1===a.indexOf("http://data.redhelper.ru")&&-1===a.indexOf("//media.redhelper.ru"))return i.remove(),e.fire("showLabel",{loading:!1,text:r.UPLOAD_ERROR_UNKNOWN}),setTimeout(function(){e.fire("hideLabel")},5e3),void(f[0].contentWindow.document.location.href=n.FILE_FRAME);(a.indexOf("<body>")>-1||a.indexOf('"')>-1)&&(a=a.substring(a.indexOf("http://")),a=a.substring(0,a.indexOf("<"))),f[0].contentWindow.document.location.href=n.FILE_FRAME;var s=!0;i.endWait(function(){s&&(e.fire("fileAppended",{link:a,from:o.VISITOR}),s=!1)})}e.fire("ready:fileFrame",f[0].contentWindow)});var c=new a;c.addHandler("fileUploadStarted",function(){i=new s,i.setLegend(r.UPLOAD_LEGEND),i.append(),i.expWait()}),f[0].allowTransparency="true",f[0].frameBorder="0",f.appendTo("#fileSend"),c.init(f[0].contentWindow,"*","*",!0)})}}),define("view/copyright",["config/lang"],function(e){var t='<div id="rh-copy"><span class="rh-textWrapper">'+e.COPYRIGHT+'</span> <a href="'+e.WEBSITE+'?copy" target="_blank">'+e.COPYRIGHT_NAME+"</a></div>";return t}),define("view/standalone",["application/dispatcher","view/copyright","jquery","config/setup"],function(e,t,n,i){e.addEventListener("templateReceived",function(){i.STANDALONE&&n("body").append(t)})}),define("view/androidFix",["common/extensions/jquery.plugins"],function(e){if(navigator.userAgent.indexOf("Android")>-1){var t=function(){return parseInt(e("#online .center").css("padding-top"),10)?void e("#onlinePanel").css("height",e("#online").height()-parseInt(e("#online .center").css("padding-top"),10)-parseInt(e("#online .center").css("padding-bottom"),10)+"px"):void setTimeout(t,100)};setTimeout(t,500)}}),define("xmpp/departments",["application/session.objects","application/dispatcher"],function(e,t){var n=function(){var n=e.departments;if(n&&n.length){for(var i in n)n[i].online=Array.prototype.reduce.call(e.onlineOperators,function(t,r){try{t=t||Array.prototype.indexOf.call(r.departments,n[i].id)>-1&&("online"===r.status||r.name===e.chatStarted)}catch(o){}return t},!1);n.sort(function(e,t){return t.online===e.online?t.priority-e.priority:t.online?1:-1}),e.departments=n,t.fire("departmentsRefreshed")}};return t.addEventListener("sessionLoaded",function(){n()}),t.addEventListener("operatorsRefreshed",n),t.addEventListener("hideDepartments",function(t){e.departmentsShown=!1}),t.addEventListener("showDepartments",function(t){e.departmentsShown=!0}),t.addEventListener("changeDepartment",function(e){e.saveOperator||t.fire("refreshOperator")}),t.addEventListener("changeRealDepartment",function(n){e.currentDepartment=n.id,e.previousOperator=e.currentOperator,e.chatStarted="",e.currentOperator="-",e.realDepartment=n.id,t.fire("changeDepartment",{id:n.id,name:n.name})}),t.addEventListener("operatorRedirectOk",function(n){var i=n.operator.extractNode().toLowerCase();for(var r in e.onlineOperators)if(e.onlineOperators.hasOwnProperty(r)&&e.onlineOperators[r].name.toLowerCase()===i){var o=e.onlineOperators[r].departments;if(o&&o.length){for(var a in o)if(o.hasOwnProperty(a)&&o[a]===e.currentDepartment)return;e.currentDepartment=o[0]}else e.currentDepartment=0;t.fire("changeDepartment",{saveOperator:!0})}}),{getDepartment:function(t){for(var n in e.onlineOperators)if(e.onlineOperators.hasOwnProperty(n)&&e.onlineOperators[n].name.toLowerCase()===t)return e.onlineOperators[n].departments[0];return 0},getResponsible:function(t){if(t)return Array.prototype.reduce.call(e.onlineOperators,function(e,n){return Array.prototype.indexOf.call(n.departments,t)>-1&&e.push(n.name.toLowerCase()),e},[]);var n=e.departments[0].priority,i=[];for(var r in e.departments)if(e.departments.hasOwnProperty(r)&&e.departments[r].priority===n)for(var o in e.onlineOperators)e.onlineOperators.hasOwnProperty(o)&&e.onlineOperators[o].departments&&Array.prototype.indexOf.call(e.onlineOperators[o].departments,e.departments[r].id)>-1&&-1===i.indexOf(e.onlineOperators[o].name.toLowerCase())&&i.push(e.onlineOperators[o].name.toLowerCase());return i}}}),define("common/extensions/utils",["common/extensions/browserDetect"],function(e){return{enablePlaceholders:function(){this.hasPlaceholder()||($(".tmp-plc").remove(),$("input[placeholder], textarea[placeholder]").each(function(e,t){var n=$(t),i=n.width(),r=n.height(),o=n.prop("tagName"),a=$("<"+o+" class='tmp-plc'/>");a.css({position:"absolute",top:n.position().top+2*parseInt(n.css("borderWidth")),left:n.position().left+(parseInt(n.css("borderLeftWidth"),10)||0),width:i,height:r,paddingLeft:n.css("paddingLeft"),paddingTop:n.css("paddingTop"),lineHeight:n.css("lineHeight"),font:n.css("font"),border:"none",borderRadius:n.css("borderRadius"),color:"#ccc",background:"transparent",boxSizing:"content-box",boxShadow:"none"}).val(n.attr("placeholder")).mousedown(function(){$(this).focusout().hide(),setTimeout(function(){n.focus()},10)}),n.focus(function(){a.hide()}).focusout(function(){setTimeout(function(){n.val()||a.show()},100)}).after(a),n.val()&&a.hide()}))},hasPlaceholder:function(){return"placeholder"in document.createElement("input")}}}),define("view/departments",["application/dispatcher","common/extensions/jquery.plugins","xmpp/departments","application/session.objects","config/lang","common/constants/sender","common/extensions/utils","common/extensions/browserDetect"],function(e,t,n,i,r,o,a,s){function c(e){if(e&&e.name)t(".showDepartments .txt").html(e.name);else{for(var n=r.DEPARTMENTS_BUTTON,o=0;o<i.departments.length;o++)i.departments[o].id===i.currentDepartment&&(n=i.departments[o].name);t(".showDepartments .txt").html(n)}}e.addEventListener("templateProcessed",function(){t("#departments").append(Array.prototype.reduce.call(i.departments,function(e,t){return e+"<li class='"+(t.online?"online":"offline")+"' data-department='"+t.id+"' title='"+r.CHOOSE_DEPARTMENT+" "+t.name+"'><span></span></span><div class='name'>"+t.name+'</div><div class="description">'+t.description+"</div></li>"},"")),t("#chooseDepartment").disableTextSelect(),t("#departmentsContainer").trigger("sizeChange"),e.addEventListener("showDepartments",function(){t("body").addClass("departmentsShow")}),e.addEventListener("hideDepartments",function(n){var i=$(window).width();if(t("body").hasClass("departmentsShow")){var r=t("#online, #offline").css({position:"absolute",left:-i});t("#chooseDepartment").css({position:"absolute",left:0}),t("body, li").attr("style","cursor: wait !important");var o=function(){t("body, li").css("cursor","");var n=t("#chooseDepartment"),c=function(){setTimeout(function(){t("#online, #chooseDepartment, #offline").css({position:"relative",left:0}),t("body").removeClass("departmentsShow"),t("body").removeClass("departmentsForce"),e.fire("renderChat"),a.enablePlaceholders()},10)};!("Explorer"===s.browser||"Firefox"===s.browser),n.animate({left:i},{duration:200,useCSS3:!1,complete:c}),r.animate({left:0},{duration:200,useCSS3:!1,complete:c}),e.removeEventListener("changeState",o)};n.immediate?o():e.addEventListener("changeState",o)}}),t("#departments li").on("click",function(){e.fire("hideDepartments"),e.fire("changeRealDepartment",{id:t(this).data("department"),name:t(this).find(".name").html()})}),i.departmentsType&&"hide"!==i.departmentsType&&i.departments.length>1&&t("body").addClass("departments"),"force"!==i.departmentsType||i.currentDepartment||!i.isPartiallyOnline||i.currentOperator||i.departments.length>1&&(t("body").addClass("departmentsForce departmentsShow"),t(".chooseDepartmentText").height()>20&&t("#departmentsWrapper").css("top","9.7em"),t("#departmentsContainer").trigger("sizeChange")),t(".showDepartments").click(function(){e.fire("showDepartments")}),e.addEventListener("showDepartments",function(){t("#online, #offline").css({position:"absolute",left:"0%"});var e=t("#chooseDepartment").css({position:"absolute",left:"100%"});t(".chooseDepartmentText").height()>20&&t("#departmentsWrapper").css("top","9.7em"),t("body").addClass("departmentsShow"),t("#departmentsContainer").trigger("sizeChange");var n=t("#online, #offline"),i=function(){setTimeout(function(){t("#online, #chooseDepartment, #offline").css({position:"relative",left:0})},10)};n.animate({left:-n.width()},{duration:200,useCSS3:!0,complete:i}),e.animate({left:0},{duration:200,useCSS3:!0,complete:i})}),e.addEventListener("forceDepartments",function(){t("body").addClass("departmentsForce"),t("body").hasClass("departmentsShow")||e.fire("showDepartments")}),t(".hideDepartments").click(function(){e.fire("hideDepartments",{immediate:!0})});for(var n=r.DEPARTMENTS_BUTTON,o=0;o<i.departments.length;o++)i.departments[o].id===i.currentDepartment&&(n=i.departments[o].name);t(".showDepartments").attr("title",r.MOVE_TO_DEPARTMENTS).find(".txt").html(n),t(".hideDepartments").attr("title",r.BACK_TO_CONVERSATION).find(".txt").html(r.BACK_TO_CONVERSATION),t(".hideDepartments.offline, .offline .hideDepartments").attr("title",r.BACK_TO_OFFLINE).find(".txt").html(r.BACK_TO_OFFLINE),t("#chooseDepartment .topText").html(i.free?r.DEFAULT_FIRST_MESSAGE:i.currentTopText||i.defaultText),t(".chooseDepartmentText").html(r.CHOOSE_DEPARTMENT)}),e.addEventListener("showDepartments",function(){e.fire("requestOnlineOperators"),t(".hideDepartments").attr("title",r.BACK_TO_CONVERSATION).find(".txt").html(r.BACK_TO_CONVERSATION),t(".hideDepartments.offline, .offline .hideDepartments").attr("title",r.BACK_TO_OFFLINE).find(".txt").html(r.BACK_TO_OFFLINE)}),i.dispatcher.addEventListener("onCurrentDepartmentChanged",function(e){e.inCurrentTab===!1&&c()}),e.addEventListener("changeDepartment",c),e.addEventListener("departmentsRefreshed",function(){for(var e in i.departments)t("li[data-department="+i.departments[e].id+"]").removeClass("online offline").addClass(i.departments[e].online?"online":"offline");t("#departmentsContainer").trigger("sizeChange")}),e.addEventListener("departmentChosen",function(){for(var e=r.DEPARTMENTS_BUTTON,n=0;n<i.departments.length;n++)i.departments[n].id===i.currentDepartment&&(e=i.departments[n].name);t(".showDepartments .txt").html(e)}),e.addEventListener("message.received",function(){e.fire("hideDepartments",{immediate:!0})})}),define("view/hints",["common/extensions/jquery.plugins","config/lang","application/dispatcher"],function(e,t,n){n.addEventListener("ready:fileFrame",function(e){$(e.document).find("#file").attr("title",t.FILE_SEND_TITLE)}),n.addEventListener("templateProcessed",function(){e("#chatSend").attr("title",t.CHAT_SEND_TITLE),e("#like, #dislike").attr("title",t.RATE_TITLE),e(".showDepartment").attr("title",t.CHOOSE_DEPARTMENT_TITLE),e("#operatorLabel").text(t.OPERATOR+":")})}),define("view/holdMessage",["application/session.objects","application/dispatcher","common/constants/sender","config/lang"],function(e,t,n,i){var r=108e5;t.addEventListener("sessionLoaded",function(){function n(n){l?clearTimeout(l):d&&t.fire("hideLabel"),e.showHoldMessage=!1,d=!1,l=0}function o(){e.showHoldMessage=!0,d=!0,l=0,t.fire("showLabel",{text:i.HOLD_MESSAGE})}function a(){return(new Date).getTime()-e.lastOperatorChat<r}function s(t){d||l||a()||(l=c(1e3*e.holdMessage.timeout))}function c(e){return e=e||200,setTimeout(o,e)}if(e.holdMessage&&e.holdMessage.enabled){var l=0,d=!1;t.addEventListener("message.new.incoming",n),t.addEventListener("message.new.outcoming",s),e.showHoldMessage&&t.addOneShotEventListener("operator",c)}})}),define("xmpp/leaveContacts",["application/dispatcher","config/setup","common/extensions/jquery.plugins","application/session.objects"],function(e,t,n,i){e.addEventListener("sendContacts",function(r){var o=function(){n.ajax({url:t.NX_URL+"contacts/"+t.CLIENT_NAME,data:{name:r.name,email:r.email,phone:r.phone,vid:i.vid,operName:i.currentOperator,page:(t.CURRENT_URL||"").substr(0,256)},method:"GET",dataType:"jsonp",cache:!1,success:function(){e.fire("sendContactsSuccess")}})};if(i.vid)o();else{var a=function(){o(),e.fire("disconnect"),e.removeEventListener("authenticated",a)};e.addEventListener("authenticated",a),e.fire("xmppManagerStart")}})}),define("view/leaveContacts",["application/dispatcher","application/session.objects","common/constants/sender","common/extensions/jquery.plugins","config/lang","xmpp/leaveContacts"],function(e,t,n,i,r,o){var a=108e5;e.addEventListener("sessionLoaded",function(){e.addEventListener("templateProcessed",function(){var n=0,o=!1;t.leaveContactsSuggestions&&t.leaveContactsSuggestions.enabled&&(t.hideLeaveContacts||(e.addEventListener("message.new.incoming",function(t){n&&(clearTimeout(n),o=!1),o&&(e.fire("hideContactsForm"),o=!1)}),e.addEventListener("message.new.outcoming",function(i){!o&&!n&&(new Date).getTime()-t.lastOperatorChat>a&&(n=setTimeout(function(){e.fire("showContactsForm"),o=!0,n=0},1e3*t.leaveContactsSuggestions.timeout))}),e.addEventListener("showContactsForm",function(){if(!t.contactsGot){o=!0;var n=i("<form onsubmit='return false;'><div id='leaveContactsText'>"+r.LEAVE_CONTACTS+"</div></form>");t.leaveContactsSuggestions.fields.indexOf("name")>-1&&n.append("<div class='leaveContactsInput'><input tabindex='1' placeholder='"+r.NAME+"' id='leaveContactsName'></div>"),t.leaveContactsSuggestions.fields.indexOf("email")>-1&&n.append("<div class='leaveContactsInput'><input tabindex='2' placeholder='"+r.EMAIL+"' id='leaveContactsEmail'></div>"),t.leaveContactsSuggestions.fields.indexOf("phone")>-1&&n.append("<div class='leaveContactsInput'><input tabindex='3' placeholder='"+r.PHONE+"' id='leaveContactsPhone'></div>"),n.append("<div class='leaveContactsError'></div>"),n.append("<div class='leaveContactsInput'><button type='button' id='leaveContactsSubmit'>"+r.SEND_BUTTON+"</button></div>"),e.fire("appendMessage",{html:i("<div></div>").append(n).html()}),e.addEventListener("hideMessage",function(){t.showLeaveContacts=!1,o=!1}),t.showLeaveContacts=!0,i("#leaveContactsPhone").mask("(999) 999-99-99"),i("#leaveContactsPhone").placeholder(),i("#leaveContactsEmail").placeholder(),i("#leaveContactsName").placeholder();var a=function(){var n=!1;return i(".leaveContactsInput input").removeClass("warning"),i("#leaveContactsName").length&&!i("#leaveContactsName").val()&&(n=!0,i("#leaveContactsName").addClass("warning")),i("#leaveContactsEmail").length&&!i("#leaveContactsEmail").val().match(/^[^@?&]+[@][a-zA-Z0-9\.\-]+[.][^@]{2,16}$/)&&(n=!0,i("#leaveContactsEmail").addClass("warning")),i("#leaveContactsPhone").length&&!i("#leaveContactsPhone").val().match(/^\+?([\(\)\-]?\d[\(\)\-]?\s?){6,20}$/)&&(n=!0,i("#leaveContactsPhone").addClass("warning")),n?(i(".leaveContactsError").text(r.INCORRECT_CONTACTS).show(),void e.fire("renderChat")):(i(".leaveContactsError").hide(),e.fire("sendContacts",{name:i("#leaveContactsName").val()||"",email:i("#leaveContactsEmail").val()||"",phone:i("#leaveContactsPhone").val()||""}),t.showLeaveContacts=!1,t.hideLeaveContacts=!0,!1)};i("#leaveContactsSubmit").click(a)}}),e.addEventListener("hideContactsForm",function(){e.fire("hideMessage")}),e.addEventListener("sendContactsSuccess",function(){t.contactsGot=!0,e.fire("appendMessage",{html:r.CONTACTS_SUCCESS})}),i("#chatItself").on("change","#leaveContactsName",function(){i("#leaveContactsName").val()?i("#leaveContactsName").css("border-color",""):i("#leaveContactsName").css("border-color","red")}),i("#chatItself").on("change","#leaveContactsEmail",function(){i("#leaveContactsEmail").val().match(/^[^@?&]+[@][a-zA-Z0-9\.\-]+[.][^@]{2,16}$/)?i("#leaveContactsEmail").css("border-color",""):i("#leaveContactsEmail").css("border-color","red")}),i("#chatItself").on("change","#leaveContactsPhone",function(){i("#leaveContactsPhone").val().match(/^\+?([\(\)\-]?\d[\(\)\-]?\s?){6,20}$/)?i("#leaveContactsPhone").css("border-color",""):i("#leaveContactsPhone").css("border-color","red")}),t.showLeaveContacts&&e.fire("showContactsForm")))})})}),define("common/extensions/color",{parseRGB:function(e){var t=[];return t.push(parseInt(e.substr(1,2),16)),t.push(parseInt(e.substr(3,2),16)),t.push(parseInt(e.substr(5,2),16)),t},rgb2hsl:function(e){var t=e[0]/255,n=e[1]/255,i=e[2]/255,r=Math.max(t,n,i),o=Math.min(t,n,i),a=(r+o)/2,s=0,c=0;r!==o&&(s=.5>a?(r-o)/(r+o):(r-o)/(2-r-o),c=t===r?(n-i)/(r-o):n===r?2+(i-t)/(r-o):4+(t-n)/(r-o)),a=100*a,s=100*s,c=60*c,0>c&&(c+=360);var l=[c,s,a];return l},hsl2rgb:function(e){var t,n,i,r=e[0],o=e[1]/100,a=e[2]/100,s=(1-Math.abs(2*a-1))*o,c=r/60,l=s*(1-Math.abs(c%2-1));void 0===r||isNaN(r)||null===r?t=n=i=0:c>=0&&1>c?(t=s,n=l,i=0):c>=1&&2>c?(t=l,n=s,i=0):c>=2&&3>c?(t=0,n=s,i=l):c>=3&&4>c?(t=0,n=l,i=s):c>=4&&5>c?(t=l,n=0,i=s):c>=5&&6>c&&(t=s,n=0,i=l);var d,u,p,h=a-s/2;return d=255*(t+h),u=255*(n+h),p=255*(i+h),d=Math.round(d),u=Math.round(u),p=Math.round(p),[d,u,p]},blend:function(e,t,n){return e=this.parseRGB(e),t=this.parseRGB(t),[Math.floor(e[0]*n+t[0]*(1-n)),Math.floor(e[1]*n+t[1]*(1-n)),Math.floor(e[2]*n+t[2]*(1-n))]},rgb2string:function(e){return"#"+e[0].toString(16)+e[1].toString(16)+e[2].toString(16)},toRGB:function(e){return e=e.replace("#",""),3==e.length&&(e=e.replace(/(.)/g,"$1$1")),e=parseInt(e,16),[e>>16,(65280&e)>>8,255&e]}}),define("view/view",["application/session.objects","config/lang","config/setup","common/extensions/jquery.plugins","view/chat","common/constants/sender","common/constants/chatWindowStage","application/dispatcher","config/api","view/template","common/extensions/browserDetect","view/minbox","view/operatorRates","view/sendFile","view/standalone","view/androidFix","view/departments","view/hints","view/holdMessage","view/leaveContacts","common/extensions/utils","common/extensions/browserDetect","common/extensions/color"],function(Session,Lang,Setup,jQuery,Chat,Sender,ChatWindowStage,Dispatcher,API,Template,browserDetect,rqMinbox,operatorRates,sendFile,rqStandalone,rqAndroidFix,departments,rqHints,rqHold,rqLeaveContacts,Utils,BrowserDetect,Color){var templateLoadedHandlers=[],templateLoaded=!1;API.replaceCSS&&jQuery(function(){jQuery("#rh-css").attr("href",API.replaceCSS)});var redirectOkListener=function(e){Chat.hideLabel();var t=Lang.OPERATOR_REDIRECT_OK+" "+e.displayName;Chat.hideTyping(),Dispatcher.fire("showLabel",{text:t})},View={_firstMessageAppended:!1,_shown:!1,initLanguage:function(){if(!Session.locale)return void setTimeout(function(){View.initLanguage()},100);if(Lang.initLanguage(),jQuery("#offline .header").html(Lang.OFFLINE_HEADER),jQuery("#offline .description").html(Lang.OFFLINE_TEXT),jQuery("#name").attr("placeholder",Lang.NAME_LABEL),jQuery("#email").attr("placeholder",Lang.EMAIL_LABEL),jQuery("#message").attr("placeholder",Lang.MESSAGE_LABEL),jQuery("#phone").attr("placeholder",Lang.PHONE_LABEL),jQuery("#sendButton").text(Lang.SEND_BUTTON),jQuery("#throbber").text(Lang.THROBBER),jQuery("#offlineSuccess div").text(Lang.MAIL_SUCCESS),jQuery("#footer a").attr("href",Lang.WEBSITE),jQuery("#typingLabel .text").html(Lang.TYPING_LABEL),!jQuery("#online textarea").is(":focus")){var e=Session.currentTypedText;e&&jQuery("#online textarea").val(e)}jQuery("#rh-copy .rh-textWrapper").text(Lang.COPYRIGHT),jQuery("#rh-copy a").html(Lang.COPYRIGHT_NAME)},show:function(){if(!Setup.empty(Session.skin)&&!Setup.empty(Session.isOnline)){this.initLanguage(),Session.free?(jQuery("body").addClass("free"),jQuery("#rh-copy").find("a").attr("href",Lang.WEBSITE+"/?copy=limited")):jQuery("#rh-copy").find("a").attr("href",Lang.WEBSITE+"/?copy=pale"),!function(){var e=0,t=jQuery("#offline"),n=2.6;t.find(".inputField").hide(),Session.offlineFields.indexOf("name")>-1&&(e+=n,n+=.357,t.find(".name").css("display","block")),Session.offlineFields.indexOf("email")>-1&&(e+=n,t.find(".email").css("display","block")),Session.offlineFields.indexOf("phone")>-1&&(n+=.357,e+=n,e>=8.8&&"Presto"!==browserDetect.browser&&(e=8.6),t.find(".phone").css("display","block"));var i=jQuery("#offline").css("display");"none"===i&&jQuery("#offline").show(),"none"===i&&jQuery("#offline").hide(),Session.offlineFields.indexOf("message")>-1&&t.find(".message").css("top",e+"em").show(),Session.offlineFields&&0===Session.offlineFields.length&&(t.find("#actionPanel").hide(),t.find(".topPanel").css("height","auto"))}(),document.title=Lang.PAGE_TITLE,(Session.currentOfflineText||Session.offlineText)&&jQuery("#offline .description").html(Session.currentOfflineText||Session.offlineText),Session.offlineHeader&&jQuery("#offline .header").html(Session.currentOfflineHeader||Session.offlineHeader),Dispatcher.fire("refreshOfflineForm"),Session.currentHeader?jQuery("#topHeader, .topHeader").html(Session.currentHeader):jQuery("#topHeader, .topHeader").html(Session.defaultHeader);var e=function(){var e=jQuery("#topText"),t=jQuery("#topHeader"),n=e.minBox(30),i=t.minBox(28),r=jQuery("#online").css("display");"none"===r&&jQuery("#online").show();var o=jQuery(window).width()-(i>n?t.width():e.width())+Math.max(i,n)+5;"none"===r&&jQuery("#online").hide(),Dispatcher.fire("sendResize",{width:o})};if(jQuery("#topText").html(Session.currentTopText||Session.defaultText),e(),Dispatcher.addEventListener("chatOpened",function(){jQuery("#departmentsContainer")[0].innerWidth,jQuery("#departmentsContainer")[0].innerHeight,Dispatcher.fire("departmentsRefreshed"),e(),Dispatcher.fire("refreshOfflineForm")}),jQuery("#topText").height()>0&&Dispatcher.fire("refreshOfflineForm"),!Session.free){if("mac"==Session.skin)Session.chatColor&&jQuery(".colorifier").css("background","#"+Session.chatColor),Session.dispatcher.addEventListener("onChatColorChanged",function(){Session.chatColor?jQuery(".colorifier").css("background","#"+Session.chatColor):jQuery(".colorifier").css("background","none")}),Session.chatIntensity&&jQuery(".colorifier").css({opacity:Session.chatIntensity/600}),Session.dispatcher.addEventListener("onChatIntensityChanged",function(){Session.chatIntensity?jQuery(".colorifier").css({opacity:Session.chatIntensity/600}):jQuery(".colorifier").css({opacity:.6})});else{if(Session.chatColor){var t=Color.toRGB(Session.chatColor),n=.2126*t[0]+.7152*t[1]+.0722*t[2];jQuery("html, body").css("background-color","#"+Session.chatColor),jQuery("#container").css("z-index","20000").addClass(n>170?"darkText":"lightText"),jQuery(".colorifier").css("background","#"+Session.chatColor),n>=221?jQuery("#offline input, #offline textarea, #departmentsWrapper, #online #chatInput, #chatContainer").css("background-color","#fff"):jQuery("#offline input, #offline textarea, #departmentsWrapper, #online #chatInput, #chatContainer").css("background-color","#f2f2f2")}Session.dispatcher.addEventListener("onChatColorChanged",function(){if(Session.chatColor){jQuery("html, body").css("background-color","#"+Session.chatColor),jQuery("#container").css("z-index","20000"),jQuery(".colorifier").css("background","#"+Session.chatColor);var e=Color.toRGB(Session.chatColor),t=.2126*e[0]+.7152*e[1]+.0722*e[2];t>170?jQuery(".colorText").css("color","#333"):jQuery(".colorText").css("color","#f5f5f5"),t>=221?jQuery("#offline input, #offline textarea, #departmentsWrapper, #online #chatInput, #chatContainer").css("background-color","#fff"):jQuery("#offline input, #offline textarea, #departmentsWrapper, #online #chatInput, #chatContainer").css("background-color","#f2f2f2")}else jQuery("html, body").css("background-color","#fff"),jQuery(".colorifier").css("background","none"),jQuery("#container").css("background-color","#e5e5e5"),jQuery(".colorText").css("color","none"),jQuery("#offline input, #offline textarea").css("background-color","#f2f2f2")})}var i=function(){(Session.defaultFace||Session.operAvatar)&&(jQuery("#face, .face").attr("src",Session.currentOperAvatar||Setup.getImageUrl(Session.operAvatar||Session.defaultFace)).attr("title",Session.operDisplayName||""),jQuery("#operatorName").text(Session.operDisplayName||""))};i(),Session.dispatcher.addEventListener("onCurrentOperAvatarChanged",i),Session.dispatcher.addEventListener("onOperDisplayNameChanged",i),Session.dispatcher.addEventListener("onOperAvatarChanged",i),Session.dispatcher.addEventListener("onFaceChanged",i)}jQuery(".topPanel, #footer, #sendButton, label").disableTextSelect(),jQuery(".topPanel").mousedown(function(e){e.stopPropagation()}),jQuery(Session.chatWindowStage===ChatWindowStage.ONLINE?"#offline":"#online").hide(),jQuery(Session.chatWindowStage===ChatWindowStage.ONLINE?"#online":"#offline").show(),Session.dispatcher.addEventListener("onIsOnlineChanged",function(e){e.inCurrentTab===!1&&Dispatcher.fire("changeState")}),Session.dispatcher.addEventListener("onChatWindowStageChanged",function(e){e.inCurrentTab===!1&&Dispatcher.fire("changeState")}),Dispatcher.addEventListener("changeState",function(e){"undefined"!=typeof e.online&&(Session.chatWindowStage=e.online?ChatWindowStage.ONLINE:ChatWindowStage.OFFLINE_FORM),Session.chatWindowStage===ChatWindowStage.ONLINE?(jQuery("#offline").hide(),jQuery("#online").show(),Dispatcher.fire("enableChat"),Dispatcher.fire("renderChat")):Session.chatStarted?Dispatcher.fire("disableChat",{reason:Lang.ALL_OFFLINE+(Session.offlineEnabled?"<br><a href='#offline'>"+Lang.LEAVE_MESSAGE+"</a>":"")}):(jQuery("#online").hide(),jQuery("#offline").show(),Utils.enablePlaceholders()),jQuery("body").removeClass("online offline").addClass(Session.chatWindowStage===ChatWindowStage.ONLINE?"online":"offline")}),Dispatcher.addEventListener("typing",function(){Chat.showTyping(),Chat.hideLabel()}),Dispatcher.addEventListener("typingStop",function(){Chat.hideTyping()}),Dispatcher.addEventListener("message.received",function(e){e.sender===Sender.OPERATOR&&Chat.hideTyping()}),Dispatcher.addEventListener("operatorRedirect",function(){Dispatcher.fire("showLabel",{text:Lang.OPERATOR_REDIRECT})}),Dispatcher.removeEventListener("operatorRedirectOk",redirectOkListener),Dispatcher.addEventListener("operatorRedirectOk",redirectOkListener),Dispatcher.addEventListener("operatorRedirectFail",function(){Chat.hideLabel()}),Session.rateEnabled&&jQuery("body").addClass("operatorRates"),Utils.enablePlaceholders()}},hide:function(){jQuery("#online, #offline").hide()},setTemplate:function(template){var scriptQueue=[];template=template.replace(/<template/i,"<div"),template=template.replace(/\/template/i,"/div"),jQuery(template).each(function(e){0!==e&&(jQuery(this).attr("src")?scriptQueue.push({src:jQuery(this).attr("src")}):scriptQueue.push({code:jQuery(this).html()
}))});var templateJQ=jQuery(template),noProcess=templateJQ.find("#fromOperator, #fromOperatorHeader, #fromVisitor, #fromVisitorHeader, #promptContainer").detach();if(template=Template.processTemplate(templateJQ),jQuery("#container").html(jQuery(template).html()+jQuery("<div/>").append(noProcess).html()),scriptQueue.length){var currentScript=-1,scriptLoader=function(){currentScript++,scriptQueue[currentScript].src?jQuery.getScript(scriptQueue[currentScript].src,scriptLoader):(eval(scriptQueue[currentScript].code),scriptLoader())};Dispatcher.addEventListener("ready",function(){scriptLoader()})}Dispatcher.fire("templateProcessed"),operatorRates.init(),jQuery("#chatContainer").length&&(jQuery("#chatItself").addClass("scroller"),jQuery("#chatContainer").addClass("scroller-parent"),Chat._baron=jQuery("#chatItself").baron({bar:"#chat_bar",freeze:!1,barOnCls:"baron"})),jQuery("#departmentsWrapper").length&&(jQuery("#departmentsContainer").addClass("scroller"),jQuery("#departmentsWrapper").addClass("scroller-parent"),Chat._baron=jQuery("#departmentsContainer").baron({bar:"#departments_bar",freeze:!1,barOnCls:"baron"}),jQuery("#departmentsContainer").trigger("sizeChange"))}},receivedHandler=function(e){Dispatcher.removeEventListener(receivedHandler),View.setTemplate(e.template),jQuery("body").addClass(e.isDefault?"rh-defaultTemplate":"rh-customTemplate"),"Explorer"===BrowserDetect.browser&&parseInt(BrowserDetect.version,10)<9&&jQuery("body").addClass("ie8")};return Dispatcher.addEventListener("templateReceived",receivedHandler),View}),define("common/application/basicActivity",["application/dispatcher"],function(e){function t(e,t){this._prefix=t||"",this._dispatcher=null,this._CHECK_INTERVAL=e,this._intervalId=null,this._isUserAway=!1,this._flag=!1,this._children=[]}t.prototype={check:function(){return this._flag||this._isUserAway?void(this._flag=!1):(this._dispatcher.fire(this._prefix+"userAway"),void(this._isUserAway=!0))},isActive:function(){return!this._isUserAway},update:function(){var e;for(this._flag=!0,this._isUserAway&&(this._dispatcher.fire(this._prefix+"userBack"),this._isUserAway=!1),e=0;e<this._children.length;e++)this._children[e].update()},start:function(){if(!this._intervalId){var e=this;this._intervalId=setInterval(function(){e.check()},this._CHECK_INTERVAL)}},stop:function(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)},init:function(e,t){t&&(this._CHECK_INTERVAL=t),this._dispatcher=e},changeInterval:function(e){this._CHECK_INTERVAL!==e&&(this._CHECK_INTERVAL=e,this._intervalId&&(this.stop(),this.start()))},getChild:function(e,n){var i=new t(e,n);return i.init(this._dispatcher),this._children.push(i),i}};var n=window.redhlpSettings?window.redhlpSettings.activityInterval||3e5:3e5,i=new t(n);return i.init(e),i}),define("application/timer",["application/session.objects","common/application/basicActivity"],function(e,t){var n=function(){var n=null,i=0,r=t.getChild(3e4,"timer_");return r.start(),{start:function(){n||(n=setInterval(function(){e.time++,i++},1e3))},stop:function(){clearInterval(n),n=null},getActivity:function(){return r},flush:function(){var e=i;return i=0,e}}}();return n.start(),n}),define("xmpp/xmppException",[],function(){}),define("xmpp/update",["application/session.objects","xmpp/connection","config/setup","application/timer","xmpp/xmppException","common/extensions/strophe"],function(e,t,n,i,r,o){var a={_firstUpdateSent:!1,simple:function(){if(e.vid){var r=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(e.vid.toString()).up().c("clientName").t(n.CLIENT_NAME.toString()).up().c("time").t(i.flush().toString()).up();if(!a._firstUpdateSent){a._firstUpdateSent=!0;try{}catch(o){}}t.isConnected()&&t._connection.sendIQ(r,null,null,5e3)}},state:function(i){if(e.vid){var r=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(e.vid.toString()).up().c("clientName").t(n.CLIENT_NAME.toString()).up();void 0===i&&(i="browse"),r.c("chatState").t(i),t.isConnected()&&t._connection.sendIQ(r,null,null,5e3)}},invite:function(i,r,o){if(e.vid&&t._isConnected){e.inviteState=r,void 0===o&&(o=e.trigger||""),e.trigger=o,e.stringChatState=i;var s=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(e.vid.toString()).up().c("clientName").t(n.CLIENT_NAME.toString()).up();s.c("trigger").t(o).up().c("inviteState").t(r).up().c("chatState").t(i).up(),t._connection.sendIQ(s,null,null,5e3)}else setTimeout(function(){a.invite(i,r,o)},400)},currentOperator:function(){if(!e.vid||!e.currentOperator)throw new r("currentOperator or vid not specified");var i=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(e.vid.toString()).up().c("currentOperator").t(e.currentOperator).up().c("departmentId").t(e.currentDepartment).up().c("clientName").t(n.CLIENT_NAME.toString()).up();t._connection.sendIQ(i,null,null,5e3)},inviteSniff:function(i,r){if(e.vid&&t._isConnected){var o=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(e.vid.toString()).up().c("clientName").t(n.CLIENT_NAME.toString()).up();if(void 0===i||""===i)return;void 0===r&&(r=""),o.c("trigger").t(i).up().c("operator").t(r).up(),t._connection.sendIQ(o,null,null,2e3)}},customFields:function(n){if(!e.free&&t.isConnected()){if(!e.vid)return void setTimeout(function(){a.customFields(n)},2e3);var i=$iq({type:"set"}).c("query",{xmlns:"consultant:update"}).c("vid").t(e.vid.toString()).up().c("keys");for(var r in n)n.hasOwnProperty(r)&&i.c("key").c("name").t(n[r].name).up().c("value").t(n[r].value).up().up();i.up(),t._connection.sendIQ(i,null,null,5e3)}}};return a}),define("xmpp/requestOnline",["application/dispatcher","config/setup","common/extensions/jquery.plugins","application/session.objects"],function(e,t,n,i){var r=function(){var r=t.PARENT_URI;-1!=location.search.indexOf("page=")&&(r=location.search.split("page=").pop().split("&").shift()),n.ajax({url:t.APP_URL+"nx/presence/"+t.CLIENT_NAME+"?page="+encodeURI(r),dataType:"jsonp",success:function(t){i.onlineOperators=t.operators,e.fire("operatorsRefreshed")},error:function(){e.fire("operatorsRefreshed")}})};e.addEventListener("requestOnlineOperators",r),e.addEventListener("operatorsRefreshed",function(){if(!i.isPartiallyOnline)for(var t in i.onlineOperators)i.onlineOperators.hasOwnProperty(t)&&(i.isPartiallyOnline||void 0!==i.onlineOperators[t].onPage&&!i.onlineOperators[t].onPage||"offline"===i.onlineOperators[t].status||(i.isPartiallyOnline=!0,e.fire("xmppManagerStart")))})}),define("xmpp/currentOperator",["application/session.objects","application/dispatcher","common/constants/sender"],function(e,t,n){t.addEventListener("message.received",function(t){e.chatStarted=e.currentOperator}),t.addEventListener("invitation",function(t){t.from&&(e.chatStarted=t.from,e.currentOperator=t.from)}),t.addEventListener("message.new",function(){e.lastChat=(new Date).getTime()}),e.lastChat&&(new Date).getTime()-e.lastChat>864e5&&(e.chatStarted="",e.currentOperator="",e.currentDepartment=0,e.realDepartment=0)}),define("common/extensions/mozvisibility",[],function(){MozVisibility={_MAX_TRIES:10,_date:new Date,_tries:0,_timer:null,_isVisible:void 0,_proxy:function(e,t){return t=t||window,function(){e.apply(t,arguments)}},_getEvent:function(){return this._event||(this._event=document.createEvent("HTMLEvents"),this._event.initEvent("mozvisibilitychange",!0,!0),this._event.eventName="mozvisibilitychange"),this._event},_setVisibilityState:function(e){this._isVisible="visible"===e,document.mozVisibilityState=e,document.mozHidden=!this._isVisible,document.dispatchEvent(this._getEvent())},_visibilityCheck:function(){this._date=new Date,this._tries=0,this._timer=setTimeout(this._invisibilityCheckTimeout,0)},_invisibilityCheckTimeoutTemplate:function(){var e=new Date,t=e-this._date;this._date=e,this._tries++,t>1e3?this._setVisibilityState("hidden"):this._tries<this._MAX_TRIES&&(this._timer=setTimeout(this._invisibilityCheckTimeout,0))},_onFocus:function(){clearTimeout(this._timer),this._isVisible||this._setVisibilityState("visible")},_onBlur:function(){this._isVisible&&this._visibilityCheck()},canBeEmulated:function(){var e=/(mozilla)(?:.*? rv:([\w.]+))?/,t=navigator.userAgent.toLowerCase(),n=t.indexOf("compatible")<0&&e.exec(t)||[];return window.top===window&&n[2]&&parseInt(n[2])>=5&&!document.visibilityState&&!document.MozVisibilityState},emulate:function(){return this.canBeEmulated()?(this._invisibilityCheckTimeout=this._proxy(this._invisibilityCheckTimeoutTemplate,this),window.addEventListener("focus",this._proxy(this._onFocus,this),!1),window.addEventListener("blur",this._proxy(this._onBlur,this),!1),this._visibilityCheck(),!0):!1}},MozVisibility.emulate()}),define("common/extensions/visibility.fallback",["common/extensions/mozvisibility"],function(){if(!(document.visibilityState||document.webkitVisibilityState||document.msVisibilityState||document.mozVisibilityState||document.oVisibilityState)){document.hidden=!1,document.visibilityState="visible";var e=null,t=function(){document.createEvent?(e||(e=document.createEvent("HTMLEvents"),e.initEvent("visibilitychange",!0,!0)),document.dispatchEvent(e)):"object"==typeof Visibility&&Visibility._onChange.call(Visibility,{})},n=function(){document.hidden=!1,document.visibilityState="visible",t()},i=function(){document.hidden=!0,document.visibilityState="hidden",t()};document.addEventListener?(window.addEventListener("focus",n,!0),window.addEventListener("blur",i,!0)):(document.attachEvent("onfocusin",n),document.attachEvent("onfocusout",i))}}),define("common/extensions/visibility.core",["common/extensions/visibility.fallback"],function(){var e=function(e){return"undefined"!=typeof e},t={onVisible:function(e){if(!this.isSupported()||!this.hidden())return e(),this.isSupported();var n=this.change(function(i,r){t.hidden()||(t.unbind(n),e())});return n},change:function(e){if(!this.isSupported())return!1;this._lastCallback+=1;var t=this._lastCallback;return this._callbacks[t]=e,this._setListener(),t},unbind:function(e){delete this._callbacks[e]},afterPrerendering:function(e){if(!this.isSupported()||"prerender"!=this.state())return e(),this.isSupported();var n=this.change(function(i,r){"prerender"!=r&&(t.unbind(n),e())});return n},hidden:function(){return this._prop("hidden",!1)},state:function(){return this._prop("visibilityState","visible")},isSupported:function(){return e(this._prefix())},_doc:window.document,_prefixes:["webkit","moz","o","ms"],_chechedPrefix:null,_listening:!1,_lastCallback:-1,_callbacks:{},_hiddenBefore:!1,_init:function(){this._hiddenBefore=this.hidden()},_prefix:function(){if(null!==this._chechedPrefix)return this._chechedPrefix;if(e(this._doc.visibilityState))return this._chechedPrefix="";for(var t,n=0;n<this._prefixes.length;n++)if(t=this._prefixes[n]+"VisibilityState",e(this._doc[t]))return this._chechedPrefix=this._prefixes[n]},_name:function(e){var t=this._prefix();return""==t?e:t+e.substr(0,1).toUpperCase()+e.substr(1)},_prop:function(e,t){return this.isSupported()?this._doc[this._name(e)]:t},_onChange:function(e){var t=this.state();for(var n in this._callbacks)this._callbacks[n].call(this._doc,e,t);this._hiddenBefore=this.hidden()},_setListener:function(){if(!this._listening){var e=this._prefix()+"visibilitychange",n=function(){t._onChange.apply(t,arguments)};this._doc.addEventListener?this._doc.addEventListener(e,n,!1):this._doc.attachEvent(e,n),this._listening=!0,this._hiddenBefore=this.hidden()}}};return t._init(),t}),define("application/command",["application/parent","application/dispatcher","jquery","xmpp/connection","application/session.objects"],function(e,t,n,i,r){function o(e){e.length>p&&e.splice(0,e.length-p),window.localStorage.setItem(u,JSON.stringify(e))}function a(){var e=window.localStorage.getItem(u);(void 0===e||null===e)&&(e="");try{var t=JSON.parse(e);return void 0===t?[]:t}catch(n){return[]}}function s(t){try{t.command in l&&l[t.command](t.args),e.send("command.received",t)}catch(n){}}function c(){for(var e=a(),t={},n=(new Date).getTime(),i=0;i<e.length;i++){var r=e[i];!(r.id in d)&&n-r.time<=r.ignoreAfter&&s(r),t[r.id]=!0}d=t}var l={},d=[],u="rhlp.commandQueue",p=5,h=function(e){var t="key"in e?e.key:"";t===u&&c()};window.addEventListener?(window.addEventListener("storage",h,!1),window.addEventListener("onstorage",h,!1)):(window.attachEvent("onstorage",h),document.attachEvent("onstorage",h)),setInterval(c,1e3);var f={execute:function(e,t,n){var i=a();i.push({id:(new Date).getTime(),command:e,args:t,time:(new Date).getTime(),ignoreAfter:n||1e3}),o(i)},setHandler:function(e,t){l[e]=t},clearHandler:function(e){delete l[e]}};return e.addHandler("command.send",function(e){f.execute(e.command,e.arguments,e.ignoreAfter)}),f}),define("common/extensions/tabs",["common/extensions/compatibility","config/setup","common/extensions/visibility.core","common/extensions/browserDetect","application/command"],function(e,t,n,i,r){var o="rhlp.tabs."+t.CLIENT_NAME+".",a=o+"i",s=o+"leader",c=o+"state",l=1200,d=function(){},u=function(){},p=function(){},h=function(){},f={id:(new Date).getTime(),setId:function(e){var t=v();f.id=e,t&&_()}},m=function(){return localStorage.getItem(c)||localStorage.setItem(c,"election"),localStorage.getItem(c)},E=function(){return parseInt(localStorage.getItem(s)||"0",10)},_=function(){localStorage.setItem(s,f.id),T()},v=function(){return E()===f.id},g=function(){localStorage.setItem(c,"election"),_(),setTimeout(function(){O()},l)},O=function(){v()&&localStorage.setItem(c,"elected")},T=function(){localStorage.setItem(a,(new Date).getTime())},A=function(){return(new Date).getTime()-parseInt(localStorage.getItem(a),10)<1500},S=m();return v(),setInterval(function(){"election"===m()&&(E()<f.id||!A())&&(_(),setTimeout(function(){O()},l)),v()&&T(),A()||g(),m()!==S&&(S=m(),"election"===m()?p():(h(),v()?d():u()))},"Explorer"===i.browser?500:300),{active:function(e){d=e,"elected"===m()&&v()&&e()},inactive:function(e){u=e,"elected"!==m()||v()||e()},election:function(e){p=e,"election"===m()&&e()},electionEnd:function(e){h=e,"elected"===m()&&e()},forceElection:function(){g()},isLeader:function(){return v()},isLeaderElected:function(){return"elected"===m()&&A()},actualize:function(){f.setId((new Date).getTime()),v()?d():g()}}}),define("xmpp/queue",["xmpp/connection","application/session.objects","config/setup","common/extensions/jquery.plugins","xmpp/update","application/dispatcher","common/extensions/strophe","common/constants/sender","common/constants/chatWindowStage","config/lang","xmpp/requestOnline","xmpp/currentOperator","xmpp/departments","common/extensions/tabs"],function(e,t,n,i,r,o,a,s,c,l,d,u,p,h){var f={getOperator:function(){try{if(!h.isLeaderElected())return void setTimeout(f.getOperator,100);if(!h.isLeader())return;if(null===e._connection||!t.vid)return void setTimeout(f.getOperator,100);var i=t.currentOperator,r=t.chatStarted,a=t.realDepartment;i=r||i,(!t.lastChat||(new Date).getTime()-t.lastChat>864e5)&&(r="",i="");var s=[],c=$iq({type:"get"}).c("query",{xmlns:"consultant:queue"}).c("client").t(n.CLIENT_NAME).up().c("vid").t(t.vid.toString()).up();"string"==typeof n.REQUIRE_OPERATOR&&""!==n.REQUIRE_OPERATOR&&c.c("require").t(n.REQUIRE_OPERATOR).up();var l=t.onlineOperators;for(var d in l)l.hasOwnProperty(d)&&void 0===l[d].onPage&&(l[d].onPage=1);if(t.requiredOperator){var u=t.requiredOperator.toLowerCase().split(",");for(d in l)l.hasOwnProperty(d)&&-1===u.indexOf(l[d].name.toLowerCase())&&(l[d].onPage=0)}var m=[];for(d in l)l.hasOwnProperty(d)&&l[d].onPage&&m.push(l[d].name);var E={};if(i&&"-"!==i)for(d in l)l.hasOwnProperty(d)&&l[d].name.toLowerCase()===(r||i).toLowerCase()&&(E=l[d]);if(i&&"-"!==i)s=a&&E.departments&&E.departments.indexOf(a)>-1?p.getResponsible(a):"force"!==t.departmentsType||1===t.departments.length?m:[r||i];else if(a){var _=!1;for(d in t.departments)t.departments.hasOwnProperty(d)&&t.departments[d].id===a&&(_=!0,s=p.getResponsible(a));if(!_){if(t.realDepartment=0,t.currentDepartment=0,"force"===t.departmentsType&&t.departments.length>1)return void o.fire("forceDepartments");s=m}}else if(m.length>0){if("force"===t.departmentsType&&t.departments.length>1)return void o.fire("forceDepartments");s=m}i&&"-"!==i&&c.c("operator").t(i).up(),c.c("responsible").t("'"+s.join("','")+"'").up(),e._connection.sendIQ(c,f.onGetOperator,f.onGetOperatorFail,5e3)}catch(v){}},checkOperator:function(){function r(e){(t.chatWindowStage===c.ONLINE&&!i("operator",e).text()||t.chatWindowStage===c.OFFLINE_FORM&&i("operator",e).text())&&o.fire("changeState",{online:!!i("operator",e).text()});var n=i("operator",e).text().toLowerCase();if(n){if(t.chatStarted&&t.currentOperator&&t.currentOperator!==n&&o.fire("showLabel",{text:l.OPERATOR_REDIRECT_OK+t.operDisplayName,loading:!1}),t.currentOperator=n,!t.currentDepartment){for(var r in t.onlineOperators)t.onlineOperators.hasOwnProperty(r)&&t.onlineOperators[r].name.toLowerCase()===n.toLowerCase()&&t.onlineOperators[r].departments&&(t.currentDepartment=t.onlineOperators[r].departments[0],"force"===t.departmentsType&&(t.realDepartment=t.currentDepartment));o.fire("departmentChosen"),"force"===t.departmentsType&&o.fire("hideDepartments",{immediate:!0})}o.fire("operator")}}var a=$iq({type:"get"}).c("query",{xmlns:"consultant:queue"}).c("client").t(n.CLIENT_NAME).up().c("vid").t(t.vid.toString()).up();"string"==typeof n.REQUIRE_OPERATOR&&""!==n.REQUIRE_OPERATOR&&a.c("require").t(n.REQUIRE_OPERATOR).up(),t.currentOperator&&"-"!==t.currentOperator&&t.chatStarted===t.currentOperator&&a.c("operator").t(t.currentOperator),e._connection.sendIQ(a,r,r,1e4)},onGetOperator:function(n){try{if(i("operator",n).text()){if(t.currentOperator&&t.currentOperator!==i("operator",n).text()){o.fire("showLabel",{text:l.OPERATOR_REDIRECT_OK+" "+i("displayName",n).text()});var a=function(e){e.sender===s.OPERATOR&&(o.fire("hideLabel"),o.removeEventListener("message.received",a))};o.addEventListener("message.received",a)}var c=i("operator",n).text().toLowerCase(),d=t.chatStarted&&t.currentOperator&&t.currentOperator!==c;if(t.currentOperator=c,t.operDisplayName=i("displayName",n).text(),t.operAvatar=i("avatar",n).text(),!t.currentDepartment){for(var u in t.onlineOperators)t.onlineOperators.hasOwnProperty(u)&&t.onlineOperators[u].name.toLowerCase()===t.currentOperator.toLowerCase()&&t.onlineOperators[u].departments&&(t.currentDepartment=t.onlineOperators[u].departments[0]);o.fire("departmentChosen")}if(r.currentOperator(),o.fire("operator"),o.fire("changeState",{online:!0}),d&&o.fire("showLabel",{text:l.OPERATOR_REDIRECT_OK+" "+t.operDisplayName,loading:!1}),t.previousOperator&&t.realDepartment){var p=$msg({type:"chat",content:"notify-department-change",to:t.previousOperator.toOperatorJid(),jid:t.vid.toVisitorJid()});p.c("body").up().c("department").t(t.currentDepartment).up().c("operator").t(c).up(),e._connection.send(p.tree()),t.previousOperator=""}t.preferredOperator&&t.currentOperator!==t.preferredOperator&&(o.fire("showLabel",{text:t.preferredOperatorError||l.NO_PREFERRED_OPERATOR,loading:!1}),o.addOneShotEventListener("message.new",function(){o.fire("hideLabel")}))}else if(t.departments&&t.departments.length>1&&"force"===t.departmentsType&&!t.realDepartment){var h=t.onlineOperators;for(var f in h)if(h.hasOwnProperty(f)&&"online"===h[f].status&&(void 0!==h[f].onPage&&h.onPage||void 0===h[f].onPage))return void o.fire("forceDepartments")}else t.isOnline=!1,o.fire("changeState",{online:!1}),t.free&&o.fire("disconnect")}catch(m){}},onGetOperatorFail:function(){t.isOnline=!1,o.fire("changeState",{online:!1}),n.QUEUE_DELAY_COUNT++,setTimeout(function(){f.getOperator()},3e3)}};return f}),define("common/extensions/mouse",["common/extensions/jquery.plugins"],function(e){function t(e){return{x:e.x||0,y:e.y||0,width:e.width,height:e.height,scrollX:e.scrollX,scrollY:e.scrollY,windowHeight:e.windowHeight,windowWidth:e.windowWidth}}function n(){if(g){var e=0;for(e=0;e<d.length;e+=1)d[e].send("getMouse");for(e=0;e<u.length;e+=1)u[e].send("getMouse");f()}}var i="unknown",r=50,o={},a={},s=!1,c=!1,l=0,d=[],u=[],p={},h={},f=function(){},m=function(e){},E=!1,_=!1,v=!1,g=!1,O=function(){return"innerHeight"in window?window.innerHeight:e(window).height()};return{init:function(){return e("body").hover(function(){s=!0},function(){s=!1}).mouseleave(function(){s=!1,c=!1,l=0}).mouseenter(function(){s=!0,c=!0}),o.width=Math.max(e("html").width(),e(window).width()),o.height=Math.max(e("html").height(),e(window).height()),o.windowHeight=O(),o.windowWidth=e(window).width(),o.scrollX=e("body").scrollLeft(),o.scrollY=e("body").scrollTop(),o.x=0,o.y=0,e("body").bind("scroll",function(){o.scrollX=e("body").scrollLeft(),o.scrollY=e("body").scrollTop()}),e(window).mousemove(function(t){l+=1,!c&&1>=l||(s=!0,o={x:t.pageX-e("body").scrollLeft(),y:t.pageY-e("body").scrollTop(),width:Math.max(e(document).width(),e(window).width()),height:Math.max(e(document).height(),e(window).height()),windowHeight:O(),windowWidth:e(window).width(),scrollX:e("body").scrollLeft(),scrollY:e("body").scrollTop()})}),e(window).bind("scroll",function(){o.scrollX=e("body").scrollLeft(),o.scrollY=e("body").scrollTop(),s=!0}),e("html").bind("click",function(t){E=!0,_=!1,v=!1,s=!0,o={x:t.pageX-e("body").scrollLeft(),y:t.pageY-e("body").scrollTop(),width:Math.max(e(document).width(),e(window).width()),height:Math.max(e(document).height(),e(window).height()),windowHeight:O(),windowWidth:e(window).width(),scrollX:e("body").scrollLeft(),scrollY:e("body").scrollTop()}}),e("html").bind("mouseup",function(t){v=!0,_=!1,o={x:t.pageX-e("body").scrollLeft(),y:t.pageY-e("body").scrollTop(),width:Math.max(e("html").width(),e(window).width()),height:Math.max(e(document).height(),e(window).height()),windowHeight:O(),windowWidth:e(window).width(),scrollX:e("body").scrollLeft(),scrollY:e("body").scrollTop()}}),e("html").bind("mousedown",function(t){_=!0,v=!1,o={x:t.pageX-e("body").scrollLeft(),y:t.pageY-e("body").scrollTop(),width:Math.max(e("html").width(),e(window).width()),height:Math.max(e(document).height(),e(document).height()),windowHeight:O(),windowWidth:e(window).width(),scrollX:e("body").scrollLeft(),scrollY:e("body").scrollTop()}}),this},enable:function(){g=!0},disable:function(){g=!1},setAsSlave:function(n){i="slave",n.addHandler("getMouse",function(){var e=t(o);e.isInside=s,e.clicked=E,e.mouseDown=_,e.mouseUp=v,E=!1,_=!1,v=!1,"function"==typeof m&&m(e),n.send("mouseData",e)});var r=function(){n.send("forceLeave"),e("html").unbind("mousemove",r),setTimeout(function(){e("html").mousemove(r)},1500)};return e("html").mousemove(r),this},setAsMaster:function(){return i="master",setInterval(n,r),this},addParentSlave:function(e){return"function"==typeof e.send&&(d.push(e),e.addHandler("mouseData",function(e){p=e}),e.addHandler("forceLeave",function(){s=!1})),this},addChildSlave:function(e){return"function"==typeof e.send&&(u.push(e),e.addHandler("mouseData",function(e){e.isInside&&(h=e)})),this},setHandler:function(e){return f=e,this},force:function(){return f(),this},setOffsetFunction:function(e){return m=e,this},getMouseData:function(){var e=t(o);return e.isInside=s,e.clicked=E,e.mouseDown=_,e.mouseUp=v,E=!1,_=!1,v=!1,"function"==typeof m&&m(e),h.isInside?(h.mouseUp|=e.mouseUp,a=t(h),h):(p.windowHeight&&(e.scrollX=p.scrollX,e.scrollY=p.scrollY,e.width=p.width,e.height=p.height,e.windowHeight=p.windowHeight,e.windowWidth=p.windowWidth),!e.isInside&&p.isInside?(p.mouseUp|=e.mouseUp,a=t(p),p):(p.x=e.x,p.y=e.y,a=t(e),e))},getParentMouseData:function(){return p},getChildMouseData:function(){return h}}}),define("common/communication/cobrowseEncoder",[],function(){return{encode:function(e){var t=e.id+",";t+=e.width+","+e.height+","+e.chatWidth+",",t+=e.chatHeight+","+e.chatX+","+e.chatY+","+e.chatState+",",t+=e.windowHeight+","+e.windowWidth;var n;for(n=0;n<e.xArr.length;n+=1)t+=";",e.insideArr[n]?(t+=e.clickedArr[n]?"c,":e.downArr[n]?"d,":e.upArr[n]?"u,":"i,",t+=e.xArr[n]+","+e.yArr[n],t+=e.scrollYArr[n]?","+e.scrollYArr[n]:",0",t+=e.scrollXArr[n]?","+e.scrollXArr[n]:",0"):t+=">";return t},decode:function(e){if("[object Object]"===Object.prototype.toString.call(e))return e;try{if(e.indexOf("{")>-1)return JSON.parse(e)}catch(t){return}try{var n=e.split(";"),i={},r=n[0].split(",");i.id=r[0],i.width=r[1],i.height=r[2],i.chatWidth=parseInt(r[3],10),i.chatHeight=parseInt(r[4],10),i.chatX=parseInt(r[5],10),i.chatY=parseInt(r[6],10),i.chatState=parseInt(r[7],10),i.windowHeight=parseInt(r[8],10),i.windowWidth=parseInt(r[9],10),i.xArr=[],i.yArr=[],i.scrollXArr=[],i.scrollYArr=[],i.clickedArr=[],i.upArr=[],i.downArr=[],i.insideArr=[];var o,a=0,s=0,c=0,l=0;for(o=1;o<n.length;o+=1){var d=n[o].split(",");"c"===d[0]?i.clickedArr.push(1):i.clickedArr.push(0),"u"===d[0]?i.upArr.push(1):i.upArr.push(0),"d"===d[0]?i.downArr.push(1):i.downArr.push(0),">"===d[0]?(i.xArr.push(c),i.yArr.push(l),i.insideArr.push(0)):(c=parseInt(d[1],10),l=parseInt(d[2],10),i.xArr.push(c),i.yArr.push(l),i.insideArr.push(1)),d[3]&&(s=parseInt(d[3],10)),d[4]&&(a=parseInt(d[4],10)),i.scrollXArr.push(a),i.scrollYArr.push(s)}return i}catch(u){return}}}}),define("application/connectionQueue",["application/parent","application/dispatcher","jquery","xmpp/connection","application/session.objects"],function(e,t,n,i,r){function o(e){e.length>l&&e.splice(0,e.length-l),window.localStorage.setItem(c,JSON.stringify(e))}function a(){var e=window.localStorage.getItem(c);(void 0===e||null===e)&&(e="");try{var t=JSON.parse(e);return void 0===t?[]:t}catch(n){return[]}}function s(){if(i.isConnected()&&r.vid){var e=a();if(0!==e.length){o([]);for(var t=0;t<e.length;t++)if(e.hasOwnProperty(t)){var s=e[t].value,c=n.parseXML(s);i._connection.send(c.documentElement)}}}}var c="rhlp.connection.packetQueue",l=15,d=function(e){var t="key"in e?e.key:"";t===c&&s()};return window.addEventListener?(window.addEventListener("storage",d,!1),window.addEventListener("onstorage",d,!1)):(window.attachEvent("onstorage",d),document.attachEvent("onstorage",d)),setInterval(s,1e3),{send:function(e,t){var n=a();t&&(n=n.filter(function(e){return e.type!==t})),n.push({type:t,value:e.toString()}),o(n),s()},clear:function(e){var t=a();t=t.filter(function(t){return t.type!==e}),o(t),s()}}}),define("xmpp/desktopCommands",["application/dispatcher","application/session.objects","xmpp/connection"],function(e,t,n){function i(e){var t=e.indexOf("@");return-1===t?e:e.substring(0,t)}function r(e,n){var r,a=i(e);n.type===d.subscribe?(r=JSON.parse(t.watchingOperators),r[a]=+new Date,t.watchingOperators=JSON.stringify(r)):n.type===d.unsubscribe?(r=JSON.parse(t.watchingOperators),delete r[a],t.watchingOperators=JSON.stringify(r)):n.type===d.getInvitationHistory&&(r=JSON.parse(t.invitationHistory),o(a,d.getInvitationHistory,r))}function o(e,t,n){a(e,{type:t,value:"string"==typeof n?n:JSON.stringify(n)})}function a(e,i){if(n.isConnected())c(e,i);else{var r=JSON.parse(t.commandQueue);r.push({to:e,obj:i}),t.commandQueue=JSON.stringify(r)}}function s(){for(var e=JSON.parse(t.commandQueue),n=0;n<e.length;n++)c(e[n].to,e[n].obj);t.commandQueue="[]"}function c(e,i){try{var r=$msg({to:e.toOperatorJid(),jid:t.vid.toVisitorJid(),type:"chat",content:"desktopcommand"}).c("body").t(JSON.stringify(i)).up();n._connection.send(r.tree()),n._connection.flush(),n._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"}))}catch(o){}}function l(e,n){var i=JSON.parse(t.watchingOperators);for(var r in i)i.hasOwnProperty(r)&&o(r,e,n)}var d={subscribe:"Subscribe",unsubscribe:"Unsubscribe",getInvitationHistory:"GetInvitationHistory"};return setInterval(function(){n.isConnected()&&s()},1e3),e.addEventListener("connected",s),{received:r,send:o,sendToAll:l}}),define("common/extensions/guid",[],function(){return{generate:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}}}),define("xmpp/messages",["application/session.objects","xmpp/connection","xmpp/queue","application/dispatcher","common/constants/sender","common/extensions/jquery.plugins","common/application/time","common/extensions/mouse","common/extensions/strophe","common/communication/cobrowseEncoder","application/parent","common/constants/chatState","common/constants/chatWindowStage","xmpp/departments","application/connectionQueue","xmpp/desktopCommands","common/extensions/guid"],function(e,t,n,i,r,o,a,s,c,l,d,u,p,h,f,m,E){i.addEventListener("message.new.outcoming",function(){f.clear("partial")});var _={_isTypedTextChanged:"",_firstMessageSent:!1,_isTyping:!1,_lockOperatorTyping:!1,_notTypingCount:0,_mouseOperators:{},_isMouseSniffed:!1,_immediateMouse:!1,_receivedMessage:{},_typingTimer:null,sniff:function(){if(e.vid&&e.currentOperator){var t=e.currentTypedText.replace(/[\n]+$/g," "),n=$msg({to:e.currentOperator.toOperatorJid(),jid:e.vid.toVisitorJid(),type:"chat",content:"partial"}).c("body").t(t).up();this._isTypedTextChanged&&t?(this._isTypedTextChanged=!1,this._isTyping||(n.c("composing",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),this._isTyping=!0,this._lockOperatorTyping=!0),f.send(n,"partial")):_._isTyping&&(this._notTypingCount<3?this._notTypingCount++:(this._notTypingCount=0,n.c("paused",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),f.send(n,"partial"),_._isTyping=!1))}},touchOperator:function(){var t=$msg({to:e.currentOperator.toOperatorJid(),jid:e.vid.toVisitorJid(),type:"chat",content:"partial"}).c("body").t("").up();t.c("composing",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),f.send(t,"partial"),t=$msg({to:e.currentOperator.toOperatorJid(),jid:e.vid.toVisitorJid(),type:"chat",content:"partial"}).c("body").t("").up(),t.c("paused",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),f.send(t,"partial")},typedTextChanged:function(){this._isTypedTextChanged=!0},onMessageReceived:function(t){var n;try{if(t.getElementsByTagName("error").length>0)return;var s=t.getAttribute("to");if(null===s)return;var c=s.split("@");c[0].toLowerCase(),s=c.join("@");var l=t.getAttribute("from"),u=l.split("@");u[0].toLowerCase(),l=u.join("@");var f=t.getAttribute("displayName"),E=t.getAttribute("type");if(t.getElementsByTagName("result").length){var v=t.getElementsByTagName("result")[0];"consultant:queue"===v.getAttribute("xmlns")&&setTimeout(function(){i.fire("refreshOperator")},5e3)}if("invitation"===t.getAttribute("content")){var g=o("body",t).text(),O=t.getAttribute("id");return l.extractNode()===e.currentOperator?i.fire("invitation",{type:"invitation",message:g,id:O}):(i.fire("invitation",{type:"invitation",message:g,id:O,from:l.extractNode()}),i.fire("updateServerInfo")),!0}if("mouse"===t.getAttribute("content"))"on"===o("state",t).text()?i.fire("sniffMouse",{operator:l.extractNode()}):i.fire("stopSniffMouse",{operator:l.extractNode()});else if("session"===t.getAttribute("content"))if("on"===o("state",t).text()){var T=e.sessionViewers;T.push(l.extractNode()),e.sessionViewers=T,d.send("cloneSession"),e.isCloneSessionActive=!0}else e.isCloneSessionActive=!1;else if("typing"===t.getAttribute("content")){if(!o("body",t).text()||"start"===o("body",t).text()){if(!_._firstMessageSent&&e.currentOperator!==e.chatStarted||_._lockOperatorTyping){var A=function(e){if(e.sender===r.VISITOR){var t=setTimeout(function(){i.fire("typing")},2500),n=function(e){e.sender===r.OPERATOR&&(clearTimeout(t),i.removeEventListener("message.received",n))};i.addEventListener("message.received",n)}i.removeEventListener("message.received",A)};i.addEventListener("message.received",A)}else i.fire("typing");clearTimeout(_._typingTimer),_._typingTimer=setTimeout(function(){i.fire("typingStop")},1500)}}else if("desktopcommand"===t.getAttribute("content")){try{n=JSON.parse(o("body",t).text())}catch(S){}m.received(l,n)}else if("command"===t.getAttribute("content")){try{n=JSON.parse(o("body",t).text())}catch(S){}"highlight"===n.type&&i.fire(n),"redirect"===n.type&&i.fire(n),"html"===n.type&&(e.compress=void 0!==n.compress&&n.compress,i.fire("sniffMouse",{operator:l.extractNode(),
html:!0,time:0,force:!0})),"mouse"===n.type&&("on"===n.state?i.fire("sniffMouse",{operator:l.extractNode()}):i.fire("stopSniffMouse",{operator:l.extractNode()})),"forms"===n.type&&d.send("sniffFormData"),"url"===n.type&&i.fire("retrieveURL",{to:l})}else if("rename"===t.getAttribute("content")){var L=Strophe.getText(t.getElementsByTagName("body")[0]);L&&i.fire("setCustomName",{name:L})}else if(!t.getAttribute("content")||"normal"===t.getAttribute("content")){var N,y=Strophe.getText(t.getElementsByTagName("body")[0]);if(y){if(N=t.getElementsByTagName("body")[0].getAttribute("mid"),N&&_._receivedMessage[N])return!0;N&&(_._receivedMessage[N]=!0)}if(e.chatWindowStage===p.OFFLINE_FORM&&(e.currentOperator=l.extractNode()||e.currentOperator,"-"==e.currentOperator&&(e.currentOperator=""),i.fire("refreshOperator")),o("replace",t).length)return i.fire("replaceMessage",{type:"replaceMessage",guid:o("replace",t).attr("id"),text:y}),!0;if(y&&(0===y.indexOf(":g")||0===y.indexOf(":"))){var R=y.substr(3);return i.fire("redirect",{link:R}),!0}if(y&&0===y.indexOf(":sv"))return d.send("startSessionView",{from:l.extractNode()}),!0;if(y&&0===y.indexOf(":ssv"))return d.send("stopSessionView",{from:l.extractNode()}),!0;if(y&&0===y.indexOf(":r"))return i.fire("operatorRedirect"),!0;if(y&&y.indexOf(":ok redirect")>-1)return i.fire("operatorRedirectOk",{operator:l,displayName:f}),!0;if(y&&0===y.indexOf(":seize"))return e.lastChat=(new Date).getTime(),i.fire("operatorRedirectOk",{operator:l,displayName:f}),!0;if(y&&0===y.indexOf(":fail redirect"))return i.fire("operatorRedirectFail"),!0;if(y&&0===y.indexOf(":ban"))return i.fire("disconnect"),i.fire("changeState",{online:!1}),!1;if("chat"===E&&y){var I=a.now().toString();i.fire("message.received",{type:"message",time:I,text:y,sender:r.OPERATOR,displayName:f,guid:o("body",t).attr("mid"),id:(new Date).getTime(),unixTime:(new Date).getTime()}),e.currentOperator||(e.currentOperator=l.extractNode(),e.operDisplayName=f,e.currentDepartment=h.getDepartment(l),"force"===e.departmentsType&&(e.realDepartment=e.currentDepartment),i.fire("refreshOperator"),"force"===e.departmentsType&&i.fire("hideDepartments",{immediate:!0})),d.send("message.displayed")}}return!0}catch(C){return!0}},onMessageSent:function(n){if(n.raw)return void t._connection.send(o(n.text));if("-"!==e.currentOperator&&""!==e.currentOperator){if(!n.sent)return void(n.sender===r.VISITOR&&(_._firstMessageSent=!0));if(n.sender===r.VISITOR&&"chat"!==e.stringChatState&&(e.stringChatState="chat",i.fire("updateChatState",{state:"chat"})),n.sender===r.VISITOR){_._lockOperatorTyping=!1;var a=$msg({to:e.currentOperator.toOperatorJid(),jid:e.vid.toVisitorJid(),id:n.guid,type:"chat",st:n.st}).c("body").attrs({mid:n.guid}).t(n.text).up();if(n.invitations&&n.invitations.length>0){a.c("invitations");for(var s=0;s<n.invitations.length;s++){var c=n.invitations[s];a.c("invitation",{id:c.id,accepted:c.accepted,time:c.time}).t(c.text).up()}a.up()}n.firstMessage&&a.c("firstMessage",{id:E.generate()}).t(n.firstMessage).up(),_._firstMessageSent||a.c("active",{xmlns:"http://jabber.org/protocol/chatstates"}).up(),t._connection.receipts.sendMessage(a,n.guid),t._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"})),n.sender===r.VISITOR&&(_._firstMessageSent=!0)}}}};return _}),define("view/cssChecker",["common/extensions/jquery.plugins","application/dispatcher"],function(e,t){var n={_defaultCssLoadSelector:"rh-loadCss",_checkLoadInterval:50,check:function(e,t){void 0===e&&(e=this._defaultCssLoadSelector),this._listenCssLoad(e,t)},_listenCssLoad:function(i,r){"1"===e("#"+i).css("z-index")?void 0!==r?t.fire(r):setTimeout(function(){t.fire("cssLoaded")},200):setTimeout(function(){n._listenCssLoad(i,r)},n._checkLoadInterval)}};return n}),define("application/statistics",["application/session.objects"],function(e){var t=12e5,n=!1,i=!1,r=!1;return{checkNewVisit:function(){if(!i){var r=new Date(e.lastVisit),o=new Date;e.lastVisit=(new Date).toString(),n=o.getTime()-r.getTime()>t}return n},checkNewDay:function(){var t=new Date(e.previousDay),n=new Date;return r=n.getTime()-t.getTime()>864e5,r&&(e.previousDay=(new Date).toString()),r}}}),define("common/extensions/punycode",[],function(){var e={};return function(e){function t(e){throw RangeError(N[e])}function n(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function i(e,t){var i=".";return n(e.split(i),t).join(i)}function r(e){for(var t,n,i=[],r=0,o=e.length;o>r;)t=e.charCodeAt(r++),55296==(63488&t)&&o>r?(n=e.charCodeAt(r++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):i.push(t,n)):i.push(t);return i}function o(e){return n(e,function(e){var t="";return e>65535&&(e-=65536,t+=I(e>>>10&1023|55296),e=56320|1023&e),t+=I(e)}).join("")}function a(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:m}function s(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function c(e,t,n){var i=0;for(e=n?R(e/g):e>>1,e+=R(e/t);e>y*_>>1;i+=m)e=R(e/y);return R(i+(y+1)*e/(e+v))}function l(e){var n,i,r,s,l,d,u,p,h,v,g=[],S=e.length,L=0,N=T,y=O;for(i=e.lastIndexOf(A),0>i&&(i=0),r=0;i>r;++r)e.charCodeAt(r)>=128&&t("not-basic"),g.push(e.charCodeAt(r));for(s=i>0?i+1:0;S>s;){for(l=L,d=1,u=m;s>=S&&t("invalid-input"),p=a(e.charCodeAt(s++)),(p>=m||p>R((f-L)/d))&&t("overflow"),L+=p*d,h=y>=u?E:u>=y+_?_:u-y,!(h>p);u+=m)v=m-h,d>R(f/v)&&t("overflow"),d*=v;n=g.length+1,y=c(L-l,n,0==l),R(L/n)>f-N&&t("overflow"),N+=R(L/n),L%=n,g.splice(L++,0,N)}return o(g)}function d(e){var n,i,o,a,l,d,u,p,h,v,g,S,L,N,y,C=[];for(e=r(e),S=e.length,n=T,i=0,l=O,d=0;S>d;++d)g=e[d],128>g&&C.push(I(g));for(o=a=C.length,a&&C.push(A);S>o;){for(u=f,d=0;S>d;++d)g=e[d],g>=n&&u>g&&(u=g);for(L=o+1,u-n>R((f-i)/L)&&t("overflow"),i+=(u-n)*L,n=u,d=0;S>d;++d)if(g=e[d],n>g&&++i>f&&t("overflow"),g==n){for(p=i,h=m;v=l>=h?E:h>=l+_?_:h-l,!(v>p);h+=m)y=p-v,N=m-v,C.push(I(s(v+y%N,0))),p=R(y/N);C.push(I(s(p,0))),l=c(i,L,o==a),i=0,++o}++i,++n}return C.join("")}function u(e){return i(e,function(e){return L.test(e)?l(e.slice(4).toLowerCase()):e})}function p(e){return i(e,function(e){return S.test(e)?"xn--"+d(e):e})}var h,f=2147483647,m=36,E=1,_=26,v=38,g=700,O=72,T=128,A="-",S=/[^ -~]/,L=/^xn--/,N={overflow:"Overflow: input needs wider integers to process.","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=m-E,R=Math.floor,I=String.fromCharCode;h={version:"1.1.1",ucs2:{decode:r,encode:o},decode:l,encode:d,toASCII:p,toUnicode:u,decodeUri:function(e){var t=e.split("//").pop().split("/")[0],n=u(t);return e.replace(t,n)},encodeUri:function(e){var t=e.split("//").pop().split("/")[0],n=p(t);return e.replace(t,n)}},e.punycode=h}(e),e.punycode}),define("xmpp/authentication",["xmpp/connection","application/dispatcher","application/session.objects","common/constants/sender","common/extensions/jquery.plugins","common/application/time","application/statistics","config/setup","common/extensions/browserDetect","common/extensions/strophe","common/communication/encoder","common/extensions/debug","common/extensions/punycode"],function(e,t,n,i,r,a,s,c,l,d,u,p,h){var f={resendAuth:function(){n.viewedPages!==n.viewedPages&&(n.viewedPages=0);try{e._connection.send($pres().tree());try{var t=c.CURRENT_URL.split("//")[0],i=c.CURRENT_URL.split("//")[1],r=i.split("/"),a=h.toUnicode(r.shift()),d=decodeURIComponent(r.join("/"));i=t+"//"+a+"/"+d}catch(m){i=c.CURRENT_URL}try{var E=n.referrer.split("//")[0],_=n.referrer.split("//")[1],v=_.split("/"),g=h.toUnicode(v.shift()),O=decodeURIComponent(v.join("/"));_=E+"//"+g+"/"+O}catch(m){_=n.referrer}var T=$iq({type:"set"}).c("query",{xmlns:"consultant:auth"}).c("client").t(c.CLIENT_NAME).up().c("clientName").t(c.CLIENT_NAME).up().c("os").t(l.OS).up().c("browserName").t(l.browser+" "+l.version).up().c("ip").t(n.ip).up().c("currentUrl").t(i).up().c("currentPageTitle").t(c.CURRENT_TITLE).up().c("referrer").t(_).up().c("visits").t(n.visits.toString()).up().c("timeOnSite").t(n.time.toString()).up().c("currentOperator").t("-"==n.currentOperator?"":n.currentOperator).up().c("departmentId").t(n.currentDepartment).up().c("viewedPages").t(n.viewedPages.toString()).up().c("inviteState").t(n.inviteState?n.inviteState.toString():"none").up().c("chatState").t(n.stringChatState||"browse").up().c("trigger").t(n.trigger).up().c("country").t(n.country).up().c("region").t(n.region).up().c("city").t(n.city).up().c("companyId").t(n.companyId).up();n.customName&&T.c("customName").t(n.customName).up();try{if(!n.free&&n.customFields){var A=u.parse(n.customFields);"string"==typeof A&&(A=u.parse(A)),T.c("keys");for(o in A)A.hasOwnProperty(o)&&T.c("key").c("name").t(A[o].name).up().c("value").t(A[o].value).up().up();T.up()}}catch(m){p.log(m)}try{if(n.extraAuth){var S,L=u.parse(n.extraAuth);for(S in L)L.hasOwnProperty(S)&&T.c(S).t(L[S]).up()}}catch(N){p.log(N)}s.checkNewVisit()&&T.c("newVisit").t("1").up(),s.checkNewDay()&&T.c("newDay").t("1").up(),n.vid>0&&T.c("vid").t(n.vid.toString()),e._connection.sendIQ(T.tree(),f.onReauth,null,7e3)}catch(N){p.log(N)}},onReauth:function(e){r("vid",e).text()&&(n.vid=r("vid",e).text()),r("time",e).text()&&a.setTimeDifference(r("time",e).text())},init:function(){var t;n.viewedPages!==n.viewedPages&&(n.viewedPages=0);try{e._connection.send($pres().tree());try{var i=c.CURRENT_URL.split("//")[0],r=c.CURRENT_URL.split("//")[1],o=r.split("/"),a=h.toUnicode(o.shift()),d=decodeURIComponent(o.join("/"));r=i+"//"+a+"/"+d}catch(m){r=c.CURRENT_URL}try{var E=n.referrer.split("//")[0],_=n.referrer.split("//")[1],v=_.split("/"),g=h.toUnicode(v.shift()),O=decodeURIComponent(v.join("/"));_=E+"//"+g+"/"+O}catch(m){_=n.referrer}var T=$iq({type:"set"}).c("query",{xmlns:"consultant:auth"}).c("client").t(c.CLIENT_NAME).up().c("clientName").t(c.CLIENT_NAME).up().c("os").t(l.OS).up().c("browserName").t(l.browser+" "+l.version).up().c("ip").t(n.ip).up().c("currentUrl").t(r).up().c("currentPageTitle").t(c.CURRENT_TITLE).up().c("referrer").t(_).up().c("visits").t(n.visits.toString()).up().c("timeOnSite").t(n.time.toString()).up().c("currentOperator").t("-"==n.currentOperator?"":n.currentOperator).up().c("departmentId").t(n.currentDepartment).up().c("viewedPages").t(n.viewedPages.toString()).up().c("inviteState").t(n.inviteState?n.inviteState.toString():"none").up().c("chatState").t(n.stringChatState||"browse").up().c("trigger").t(n.trigger).up().c("country").t(n.country).up().c("region").t(n.region).up().c("city").t(n.city).up();n.customName&&T.c("customName").t(n.customName).up();try{if(!n.free&&n.customFields){var A=u.parse(n.customFields);"string"==typeof A&&(A=u.parse(A)),T.c("keys");for(t in A)A.hasOwnProperty(t)&&T.c("key").c("name").t(A[t].name).up().c("value").t(A[t].value).up().up();T.up()}}catch(m){p.log(m)}try{if(n.extraAuth){var S,L=u.parse(n.extraAuth);for(S in L)L.hasOwnProperty(S)&&T.c(S).t(L[S]).up()}}catch(N){p.log(N)}s.checkNewVisit()&&T.c("newVisit").t("1").up(),s.checkNewDay()&&T.c("newDay").t("1").up(),n.vid>0&&T.c("vid").t(n.vid.toString()),e._connection.sendIQ(T.tree(),f.onAuthenticate,null,1e4)}catch(N){p.log(N)}},onAuthenticate:function(e){r("vid",e).text()&&(n.vid=r("vid",e).text()),r("time",e).text()&&a.setTimeDifference(r("time",e).text()),t.fire("authenticated")},onHistory:function(e){t.fire("historyReceived");var o,s=r("message",e);for(o=0;o<s.length;o++){var c=r(s[o]),l=c.attr("from")===n.vid.toVisitorJid(),d=l?i.VISITOR:i.OPERATOR,u=a.parse(c.attr("time")).toString(),p=c.children("body").text(),h=c.attr("displayName")||"";t.fire("message.history",{type:"message",time:u,id:a.parse(c.attr("time")).getTime(),text:p,sender:d,displayName:h})}}};return f}),define("common/extensions/lzjb",["common/extensions/base64"],function(e){return Iuppiter={},function(){NBBY=8,MATCH_BITS=6,MATCH_MIN=3,MATCH_MAX=(1<<MATCH_BITS)+(MATCH_MIN-1),OFFSET_MASK=(1<<16-MATCH_BITS)-1,LEMPEL_SIZE=256,Iuppiter.compress=function(t){var n,i,r,o,a,s,c,l,d,u=[],p=0,h=0,f=1<<NBBY-1,m=new Array(LEMPEL_SIZE);for(l=0;l<LEMPEL_SIZE;l++)m[l]=3435973836;for(t.constructor==Array?(n=t,d=!0):(n=e.toByteArray(t),d=!1),i=n.length;i>p;){if((f<<=1)==1<<NBBY){if(h>=i-1-2*NBBY){for(a=i,p=0,h=0;a;a--)u[h++]=n[p++];return u}f=1,o=h,u[h++]=0}if(p>i-MATCH_MAX)u[h++]=n[p++];else if(c=(n[p]+13^n[p+1]-13^n[p+2])&LEMPEL_SIZE-1,s=p-m[c]&OFFSET_MASK,m[c]=p,r=p-s,r>=0&&r!=p&&n[p]==n[r]&&n[p+1]==n[r+1]&&n[p+2]==n[r+2]){for(u[o]|=f,a=MATCH_MIN;a<MATCH_MAX&&n[p+a]==n[r+a];a++);u[h++]=a-MATCH_MIN<<NBBY-MATCH_BITS|s>>NBBY,u[h++]=s,p+=a}else u[h++]=n[p++]}return u},Iuppiter.decompress=function(t,n){var i,r,o,a,s,c,l,d,u=[],p=0,h=0,f=1<<NBBY-1;for(t.constructor==Array?(i=t,l=!0):(i=e.toByteArray(t),l=!1),l="undefined"==typeof n?!1:n,r=i.length,d=function(){return l?u:e.fromByteArray(u)};r>p;)if((f<<=1)==1<<NBBY&&(f=1,a=i[p++]),a&f){if(s=(i[p]>>NBBY-MATCH_BITS)+MATCH_MIN,c=(i[p]<<NBBY|i[p+1])&OFFSET_MASK,p+=2,!((o=h-c)>=0))return d();for(;--s>=0;)u[h++]=u[o++]}else u[h++]=i[p++];return d()}}(),Iuppiter}),define("xmpp/cobrowseMessage",["xmpp/connection","application/session.objects","application/dispatcher","common/extensions/lzjb","common/extensions/base64"],function(e,t,n,i,r){try{var o=[],a=!1;n.addEventListener("connection.canStormPackets",function(e){a=e.canStormPackets}),n.addEventListener("cobrowseMessage",function(a){if(!e.isAuthenticated())return void setTimeout(function(){n.fire(a)},500);var s=JSON.stringify({action:a.action,data:a.data,target:a.target});isUtf8=r.isUtf8(s);var c=void 0!==t.compress&&t.compress,l=c&&s.length>1e3;if(l){var d=s;try{l=!0,s=r.toByteArray(s,isUtf8),s=i.compress(s),s=r.encode(s,!0)}catch(u){s=d}}var p,h=l?4e4:15e3,f=(new Date).getTime(),m=function(e,n,i,s){var c={chunked:!0,id:f,compressed:l,utf8:isUtf8,index:n,body:e.slice(n*i,(n+1)*i),chunks:Math.ceil(e.length/i)},d=t.currentOperator;""==d&&(d=t.lastMouseOperator||"");var u=JSON.stringify(c);u=r.encodeOld(u);var p=$msg({to:d.toOperatorJid(),jid:t.vid.toVisitorJid(),type:"chat",content:"cobrowse",action:a.action,size:u.length});p=p.c("body").t(u).up(),o.push({request:{message:p,to:a.to},notification:s})},E=Math.ceil(s.length/h);for(p=0;E>p;p++)m(s,p,h,p==E-1?{action:a.action,data:a.data,target:a.target}:!1)});var s=function(){var t=o.shift();if(t)try{var i=t.request,r=i.message;if(i.to)for(var c in i.to)i.to.hasOwnProperty(c)&&(r.node.setAttribute("to",i.to[c].toOperatorJid()),e._connection.send(r.tree()),e._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"})),e._connection.flush());else e._connection.send(r.tree()),e._connection.flush(),e._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"}));t.notification&&n.fire("cobrowseMessageSent",t.notification)}catch(i){}a?1:200+200*Math.random(),setTimeout(s,a)};setTimeout(s,400)}catch(c){}}),define("xmpp/cobrowse",["application/dispatcher","common/extensions/mouse","application/session.objects","common/communication/cobrowseEncoder","xmpp/connection","application/parent"],function(e,t,n,i,r,o){function a(e){if(!e)return!0;value=e[0];for(var t in e)if(e[t]!=value)return!1;return!0}var s={_mouseOperators:{},_immediateMouse:!1,sniffMouse:function(o,c,l,d){var u=[],p=[],h=[],f=[],m=[],E=[],_=[],v=[],g=0,O=new Date;c=c||O.getTime(),o=o.extractNode(),o=(o||n.currentOperator).toOperatorJid();var T=!1;return this._mouseOperators[o]&&(l=this._mouseOperators[o].html||l),this._mouseOperators[o]&&!d&&(T=!0),this._mouseOperators[o]={jid:o,start:c,html:!!l},n.mouseOperators=JSON.stringify(this._mouseOperators),n.lastMouseOperator=o,n.isSendMouseActive=!0,n.disableCobrowse?void e.fire("cobrowseMessage",{action:"nocobrowse"}):(this._immediateMouse=!0,this._isMouseSniffed||t.setHandler(function(){if(n.isSendMouseActive&&!n.disableCobrowse){var e=t.getMouseData(),o=new Date,c=e.width,l=e.height,d=e.windowHeight,O=e.windowWidth;u.push(e.x),p.push(e.y),h.push(+e.clicked),m.push(+e.mouseUp),f.push(+e.mouseDown),E.push(e.scrollX),_.push(e.scrollY),v.push(e.isInside),g+=1,g>=20&&!function(){if(!(!n.IsFocused&&a(u)&&a(p)&&a(h)&&a(m)&&a(f)&&a(E)&&a(_)&&a(v))){var e,t={};t.chatX=n.chatX,t.chatY=n.chatY,t.chatWidth=n.chatWidth||n.currentChatWidth,t.chatHeight=n.chatHeight||n.currentChatHeight,t.chatState=n.chatState,t.xArr=u,t.yArr=p,t.clickedArr=h,t.upArr=m,t.downArr=f,t.scrollXArr=E,t.scrollYArr=_,t.insideArr=v,t.width=c,t.height=l,t.windowHeight=d,t.windowWidth=O,t.id=o.getTime();for(e in s._mouseOperators)if(s._mouseOperators.hasOwnProperty(e))if(o.getTime()-s._mouseOperators[e].start>3e5)s.stopSniffMouse(e);else{var T=$msg({to:s._mouseOperators[e].jid,jid:n.vid.toVisitorJid(),type:"chat",content:"mouse"}).c("body").t("'"+i.encode(t)+"'").up().up();r.isAuthenticated()&&(r._connection.send(T.tree()),r._connection.sendIQ($iq({type:"get"}).c("query",{xmlns:"consultant:ping"})),s._immediateMouse&&r._connection.flush())}g=0,u=[],p=[],h=[],m=[],f=[],E=[],_=[],v=[],t=null,s._immediateMouse=!1}}()}}),this._isMouseSniffed=!0,t.enable(),setTimeout(function(){t.force()},300),l&&!T&&e.fire("retrieveHTML",{to:o.extractNode()}),void((n.cloneSession||n.isCloneSessionActive)&&e.fire("cloneSession")))},stopSniffMouse:function(e){delete this._mouseOperators[e.extractNode().toOperatorJid()];var i,r=!1;for(i in this._mouseOperators)if(this._mouseOperators.hasOwnProperty(i)){r=!0;break}n.mouseOperators=JSON.stringify(this._mouseOperators),n.isSendMouseActive="{}"!==n.mouseOperators,r?t.enable():t.disable()}};e.addEventListener("sniffMouse",function(e){s.sniffMouse(e.operator,e.start,e.html,e.force),o.send("sniffMouse")}),e.addEventListener("stopSniffMouse",function(e){s.stopSniffMouse(e.operator),n.isSendMouseActive||o.send("stopSniffMouse")}),e.addEventListener("sessionLoaded",function(){if(n.mouseOperators&&"{}"!==n.mouseOperators){var t=JSON.parse(n.mouseOperators||"{}");for(var i in t)t.hasOwnProperty(i)&&e.fire("sniffMouse",{operator:t[i].jid,start:t[i].start,html:t[i].html})}})}),requirejs.config({baseUrl:"js",paths:{common:"../../common/js"}}),define("xmpp/xmppManager",["application/dispatcher","xmpp/update","xmpp/xmppException","xmpp/queue","xmpp/authentication","application/session.objects","xmpp/connection","xmpp/messages","common/extensions/strophe","common/constants/sender","common/constants/chatWindowStage","config/lang","common/extensions/guid","common/application/time","application/parent","xmpp/cobrowseMessage","xmpp/cobrowse","common/constants/chatState","common/extensions/tabs","common/extensions/browserDetect","application/command","config/setup"],function(e,t,n,i,r,o,a,s,c,l,d,u,p,h,f,m,E,_,v,g,O,T){function A(e){return e.clientName===T.CLIENT_NAME&&(!e.companyId||e.companyId===T.COMPANY_ID)}var S=20;O.setHandler("ensureWeHaveOperator",function(e){o.currentOperator||i.getOperator()}),e.addEventListener("message.send",function(e){var t=o.messageQueue;t.length>S&&t.splice(0,t.length-S),e.clientName=T.CLIENT_NAME,e.companyId=T.COMPANY_ID,t.push(e),o.messageQueue=t}),o.dispatcher.addEventListener("onMessageQueueChanged",function(){e.fire("messageQueueChanged")}),e.addEventListener("operator",function(){e.fire("messageQueueChanged")}),e.addEventListener("connected",function(){e.fire("messageQueueChanged")}),"Explorer"===g.browser&&setInterval(function(){e.fire("messageQueueChanged")},300),e.addEventListener("messageQueueChanged",function(){if(a.isConnected()&&o.vid&&"-"!==o.currentOperator&&""!==o.currentOperator){var t=o.messageQueue.filter(function(e){return A(e)});if(0!==t.length)if(o.currentOperator){o.messageQueue=o.messageQueue.filter(function(e){return!A(e)});for(var n=0;n<t.length;n++)s.onMessageSent(t[n])}else setTimeout(function(){e.fire("messageQueueChanged")},300)}}),e.fire("messageQueueChanged"),setInterval(function(){s.sniff()},1e3);var L={_updateId:null,_sniffId:null,_isAuthenticated:!1,_isConnected:!1,_getOperatorId:null,_UPDATE_TIME:35e3,_started:!1,_messagesLogged:!1,flushQueue:function(){v.isLeader()&&(o.messageQueue=[])},runOnConnect:function(){e.removeAllEventListeners("refreshOperator"),e.addEventListener("refreshOperator",function(){a.isConnected()?i.getOperator():v.actualize()})},runOnce:function(){e.addEventListener("authenticated",function(){L.routines();var t=function(){i.getOperator();var e=2e4,t=function(){o.isOnline||(i.getOperator(),e+=2e4),L._getOperatorId=setTimeout(t,e)};o.free||(L._getOperatorId=setTimeout(t,e))};o.chatStarted||o.chatState===_.MAXIMIZED||o.chatState===_.WINDOW?t():e.addEventListener("chatOpened",t)}),e.addEventListener("operator",function(){e.fire("messageQueueChanged"),o.isOnline=!0}),e.addEventListener("connected",function(){L._isConnected=!0,r.init()}),e.addEventListener("global:userBack",function(){L._userAway=!1}),e.addEventListener("global:userAway",function(){L._userAway=!0}),e.addEventListener("updateServerInfo",function(){i.checkOperator()}),e.addEventListener("sniffMouse",function(){o.isSendMouseActive=!0}),e.addEventListener("cloneSession",function(){f.send("cloneSession")}),f.addHandler("sendSession",function(t){var n=[],i=JSON.parse(o.mouseOperators);for(var r in i)i.hasOwnProperty(r)&&n.push(i[r].jid.extractNode());e.fire("cobrowseMessage",{action:"session",data:t.data,to:n})}),e.addEventListener("operatorRedirectOk",function(e){o.currentOperator=e.operator.extractNode().toLowerCase(),o.operDisplayName=e.displayName,o.chatStarted=o.currentOperator,i.getOperator()}),e.addEventListener("stropheDisconnected",function(){a.disconnecting||(o.reconnects+=1,a._isAuthenticated=!1,e.fire("disconnected"))}),e.addEventListener("reconnect",a.reconnect),e.addEventListener("pause:connection",function(){a.pause()}),e.addEventListener("resume:connection",function(){a.resume()}),e.addEventListener("disconnect",function(){clearInterval(L._updateId),e.removeEventListener("message.send",s.onMessageSent),e.removeEventListener("rawMessage",s.onMessageSent),a.disconnect()}),o.dispatcher.addEventListener("onCustomFieldsChanged",function(){t.customFields(JSON.parse(o.customFields))}),e.addEventListener("xmppGotOperator",function(e){i.onGetOperator(e.stanza),o.lastMessageFrom===l.VISITOR&&o.lastMessageTime>(new Date).getTime()-3e5&&s.touchOperator()}),e.addEventListener("urlChanged",function(){r.resendAuth()}),e.addEventListener("fileAppended",function(t){e.fire("message."+(t.from===l.VISITOR?"send":"new"),{type:"message",text:t.link,id:(new Date).getTime(),time:h.now().toString(),sender:t.from,displayName:t.from===l.VISITOR?u.YOU_LABEL:o.operDisplayName,sent:t.from===l.VISITOR,unixTime:(new Date).getTime(),guid:p.generate()})}),e.addEventListener("setCustomName",function(e){o.customName=e.name,r.resendAuth()}),e.addEventListener("message.received",function(e){o.lastOperatorChat=(new Date).getTime()})},optimizeConnections:function(){return"string"==typeof o.optimizeConnections?"true"===o.optimizeConnections:"boolean"==typeof o.optimizeConnections?o.optimizeConnections:!!o.optimizeConnections},waitForActivityAndThenConnect:function(){var t,n=!1,i=function(){n||t||(setTimeout(function(){v.actualize()},200),n=!0)};e.addOneShotEventListener("invitation.accepted",i),e.addOneShotEventListener("chatOpened",i)},noRecentActivity:function(){return(new Date).getTime()-o.lastChat>3e8},start:function(t){if(!t&&!o.isPartiallyOnline&&!o.isOnline)return void(!o.vid&&o.visIdFromNx&&(o.vid=o.visIdFromNx));if(!t&&L.optimizeConnections()&&L.noRecentActivity()&&o.chatState!=_.MAXIMIZED&&o.chatState!=_.WINDOW)return void L.waitForActivityAndThenConnect();if(a.paused&&a.isConnected())return void this.resume();var n=!1;for(var i in o.onlineOperators)n=n||"online"===o.onlineOperators[i].status||o.onlineOperators[i].name===o.chatStarted&&"offline"!==o.onlineOperators[i].status;return n||!o.free||t?(this._started||this.runOnce(),this._started=!0,void(a.isConnected()||a.isConnecting()||(this.runOnConnect(),e.fire("xmppConnecting"),a.setMessageHandler(s.onMessageReceived),a.removeErrorHandlers(),a.init(),e.fire("xmppStart")))):void e.fire("disconnect")},counter:function(e){o.lastMessageTime=e.unixTime,o.lastMessageFrom=e.sender,e.isIncoming===!1&&(o.lastVisitorMessageTime=e.unixTime)},routines:function(){L._updateId&&clearInterval(L._updateId),L._sniffId&&clearInterval(L._sniffId),L._getOperatorId&&clearInterval(L._getOperatorId),L._updateId=setInterval(function(){t.simple()},this._UPDATE_TIME),e.removeEventListener("rawMessage",s.onMessageSent),e.removeEventListener("message.new",L.counter),e.addEventListener("rawMessage",s.onMessageSent),e.addEventListener("message.new",L.counter),a._isAuthenticated=!0},stop:function(){e.fire("disconnect")},pause:function(){e.fire("pause:connection")},resume:function(){e.fire("resume:connection")}};return e.addEventListener("xmppManagerStart",function(){L.start(!0)}),o.isPartiallyOnline||o.isOnline||!o.vid&&o.visIdFromNx&&(o.vid=o.visIdFromNx),L}),define("common/constants/offlineError",{UNDEFINED:0,INCORRECT_EMAIL:1}),define("view/uiEvents",["common/extensions/jquery.plugins","application/session.objects","config/lang","config/setup","application/dispatcher","common/constants/sender","common/constants/offlineError","common/application/basicActivity","common/application/time","common/extensions/guid","common/extensions/browserDetect","common/constants/chatState","common/extensions/utils"],function(e,t,n,i,r,o,a,s,c,l,d,u,p){var h=8e3,f=!1,m={_isSendingOffline:!1,bind:function(){var a=function(e){return s.update(),e||(t.lastActivity=(new Date).getTime()),!0};e(window).click(a),e(window).mousemove(a),e(window).keydown(a);var E=t.lastActivity;rhlpSetInterval(function(){E!==t.lastActivity&&(a(!0),E=t.lastActivity)},2e4),e(window).resize(function(){var t=e("#chatItself")[0];t.scrollTop=t.scrollHeight});var _=function(){};d.isMobile?e("#chatTextarea").val("").css("color","#000").keypress(function(t){13===t.keyCode&&e("#chatSend").click()}):(e("#textAreaWrapper").append('<div id="textAreaPlaceholder">'+n.CHAT_LABEL+"</div>"),t.currentTypedText||e("#textAreaPlaceholder").show(),e("#chatTextarea").focus(function(){""===e(this).val()&&e("#textAreaPlaceholder").show(),e(this).css("color","#000")}).blur(function(){""===e(this).val().trim()&&e("#textAreaPlaceholder").show(),e(this).css("color","#bbb")}).keydown(function(n){if(f)return!1;if(e("#textAreaPlaceholder").hide(),_(),13===n.keyCode){if(n.ctrlKey||n.shiftKey){var o=this.value;if("number"==typeof this.selectionStart&&"number"==typeof this.selectionEnd){var a=this.selectionStart;this.value=o.slice(0,a)+"\n"+o.slice(this.selectionEnd),this.selectionStart=this.selectionEnd=a+1}else if(document.selection&&document.selection.createRange){this.focus();var s=document.selection.createRange();s.text="\r\n",s.collapse(!1),s.select()}}else{if(i.DEBUG&&n.shiftKey)return r.fire("rawMessage",{type:"rawMessage",text:e("#chatTextarea").val(),raw:!0}),!1;t.byEnter=!0,e("#chatSend").click()}return!1}return t.currentTypedText=e(this).val(),!0}).keyup(function(){var i=e(this).val();i.length>h&&(r.fire("showLabel",{text:n.TOO_LONG}),_=function(){e("#chatTextarea").val().length<=h&&(r.fire("hideLabel"),_=function(){})}),t.currentTypedText=e(this).val(),i||e("#textAreaPlaceholder").show()})),r.addEventListener("disableChat",function(t){t.reason&&r.fire("showLabel",{text:t.reason}),f=!0,e("#chatTextarea").attr("disabled","disabled"),e("#chatSend, #chatTextarea").addClass("disabled")}),r.addEventListener("enableChat",function(){f&&(f=!1,e("#chatTextarea").removeAttr("disabled"),r.fire("hideLabel"),e("#chatSend, #chatTextarea").removeClass("disabled"))}),e("#chatSend").click(function(){if(!f){var i=e("#chatTextarea").val();if(i.length>h)return r.fire("showLabel",{text:n.TOO_LONG}),void(_=function(){e("#chatTextarea").val().length<=h&&(r.fire("hideLabel"),_=function(){})});if(t.currentTypedText="",""!==i.replace(/\n+/g,"\n").trim()&&i.replace(/\n+/g,"")!==n.CHAT_LABEL){var a=c.now().toString(),s=!!t.firstMessageShown;t.firstMessageShown||(t.firstMessageShown=!0);var d=s?[]:JSON.parse(t.invitationHistory),u=t.free?n.DEFAULT_FIRST_MESSAGE:t.currentFirstMessage||t.firstMessage;r.fire("message.send",{type:"message",text:i,id:(new Date).getTime(),time:a,sender:o.VISITOR,displayName:n.YOU_LABEL,sent:!0,unixTime:(new Date).getTime(),guid:l.generate(),st:t.byEnter?"e":"b",invitations:d,firstMessage:s?void 0:u}),t.byEnter=!1}e("#chatTextarea").val("");try{e("#chatTextarea").focus()}catch(p){}}}),e(document).keydown(function(e){return e.ctrlKey&&e.altKey&&69===e.keyCode&&r.fire("refreshHistory"),e.ctrlKey&&e.altKey&&68===e.keyCode?(i.DEBUG=!i.DEBUG,localStorage.setItem("rhlp.debug",i.DEBUG?"true":""),!1):void 0}),e("#chatLabel").on("click","[href='#offline']",function(){e("#online").hide(),e("#offline").show()}),e("#sendButton").click(function(){}).mousedown(function(){e(this).addClass("pressed")}).mouseup(function(){e(this).removeClass("pressed")}).mouseout(function(){e(this).removeClass("pressed")}).click(function(){if(m._isSendingOffline)return!1;e("#mailSuccess").text(""),e(".inputField input,.inputField textarea").removeClass("warning");var i=e("#email"),o=e("#phone"),a=e("#name"),s=e("#message");i.val(e.trim(i.val())),o.val(e.trim(o.val())),a.val(e.trim(a.val())),s.val(e.trim(s.val()));var c=t.offlineFields.indexOf("phone")>-1,l=t.offlineFields.indexOf("email")>-1,d=t.offlineFields.indexOf("message")>-1,u=t.offlineFields.indexOf("name")>-1;!i.val()&&l||!a.val()&&u||!s.val()&&d||!o.val()&&c?(e("#offlineError").text(n.NOT_ALL_FIELDS),e(".inputField:visible input, .inputField:visible textarea").each(function(){$(this).val()||$(this).addClass("warning")})):l&&!i.val().match(/^[^@?&]+[@][a-zA-Z0-9\.\-]+[.][^@]{2,16}$/)?(e("#offlineError").text(n.INCORRECT_EMAIL),i.addClass("warning")):c&&!o.val().match(/^\+?([\(\)\-]?\d[\(\)\-]?\s?){6,20}$/)?(e("#offlineError").text(n.INCORRECT_PHONE),o.addClass("warning")):(m._isSendingOffline=!0,e("#email, #name, #message, #phone").attr("disabled","disabled"),e("#throbber").show(),e("#sendButton").hide(),r.fire("sendOffline",{name:u?a.val():"",email:l?i.val():"",message:d?s.val():"",phone:c?o.val():""}))}),e("input, textarea").keyup(function(){e("#mailSuccess").hide()}),r.addEventListener("offlineSuccess",function(){m.showSuccess()}),r.addEventListener("offlineFailure",function(e){m.showFailure(e)});var v=function(t){var n,i;e("body").hasClass("departmentsShow")||(e("#online").is(":visible")?(i=e("#chatInput textarea"),n=i.val(),i.focus().val("").val(n)):(i=e("#offline input:visible:eq(0)"),n=i.val(),p.enablePlaceholders(),i.val("").val(n),"Explorer"===d.browser||window.opera||i.focus()))};(t.chatStarted||t.chatState===u.MAXIMIZED||t.chatState===u.WINDOW)&&v(),r.addEventListener("chatOpened",v),r.addEventListener("closeChat",function(){e("input, textarea").blur()}),r.addEventListener("renderChat",v)},initPlaceHolder:function(){var e=[8,9,13,16,17,18,19,20,27,32,33,34,35,36,37,38,39,40,44,45,46,91,144,145],t=function(t){if("focusin"!==t.type&&("keydown"!==t.type||16!==t.keyCode)){var i=t.type,r=t.keyCode,o=$(t.currentTarget),a=o.val().trim(),s=o.closest(".redhelper-form-row"),c=s.find(".redhelper-form-row-field"),l=!!o.data("mask"),d=function(){("keydown"!==i||-1===$.inArray(r,e))&&(c.removeClass("redhelper-form-row-field-focus-ready"),s.addClass("redhelper-form-row-field-input-onfocus"),l&&s.addClass("redhelper-form-row-mask-field"),setTimeout(function(){s.is(".redhelper-form-row-field-input-onfocus")&&c.addClass("redhelper-form-row-field-focus-ready")},10))},u=function(){s.removeClass("redhelper-form-row-field-input-fill"),c.removeClass("redhelper-form-row-field-input-label-focus-ready"),s.removeClass("redhelper-form-row-field-input-onfocus")},p=s.is(".redhelper-form-row-field-input-fill, .redhelper-form-row-field-input-onfocus");if("keydown"===i&&8===r&&a.length-1===0&&u(),"keydown"===i&&-1===$.inArray(r,e)&&s.addClass("redhelper-form-row-active"),p)s.addClass("redhelper-form-row-focused");else if("focus"===i||"click"===i)l?d():s.addClass("redhelper-form-row-focused");else{if("change"===i&&0===a.length)return;d()}"selectField"===i&&n(t)}},n=function(e){var t=$(e.currentTarget),n=t.val().trim(),i=t.parents(".redhelper-form-row"),r=i.find(".redhelper-form-row-field");n.length?(i.addClass("redhelper-form-row-field-input-fill"),
r.addClass("redhelper-form-row-field-input-label-focus-ready redhelper-form-row-field-focus-ready")):0===n.length&&(i.removeClass("redhelper-form-row-field-input-fill"),r.removeClass("redhelper-form-row-field-input-label-focus-ready")),i.removeClass("redhelper-form-row-focused").removeClass("redhelper-form-row-field-input-onfocus").removeClass("redhelper-form-row-active")},i=function(e){var i=$(e.target);i.data("superPlaceholder")||(i.data("superPlaceholder",!0),t(e),i.on("click focus keydown change",t).on("blur",n))},r=function(e){var t=$(e.currentTarget),n=t.parents(".redhelper-form-row-select"),i=n.find(".redhelper-plugin-select2");return i.trigger("click"),!1},o=$(".redhelper-input-type-text, .input-textarea"),a=$("textarea");o.trigger("selectField"),$(window).on("blur",function(){o.trigger("blur")}),$(document).on("click",".redhelper-form-row-select .redhelper-form-row-field",r),"function"==typeof $.fn.autosize&&a.autosize(),$(document).on("selectField",".redhelper-input-type-text, .input-textarea",t),$(document).on("click focus keydown change",".redhelper-input-type-text, .input-textarea",i)},showSuccess:function(){m._isSendingOffline=!1,e("#offlineError").text(""),e("#throbber").hide(),e("#sendButton").show(),e("#offlineSuccess").show(),e("#offline").hide(),setTimeout(function(){e("#offlineSuccess").hide(),e("#offline").show(),e("#email, #name, #message, #phone").removeAttr("disabled").val(""),e("#mailSuccess").text(n.MAIL_SENT).show(),r.fire("offlineDone")},1200)},showFailure:function(t){m._isSendingOffline=!1,e("#offlineError").text(t.errorCode===a.INCORRECT_EMAIL?n.EMAIL_INCORRECT:n.FAILED_TO_SEND).show(),e("#offlineSuccess").hide(),e("#email, #name, #message, #phone").removeAttr("disabled"),e("#throbber").hide(),e("#sendButton").show()}};return m}),define("common/extensions/swfobject",[],function(){try{if(document.createElement("audio").canPlayType)return{}}catch(e){}var t=function(){function e(){if(!z){try{var e=H.getElementsByTagName("body")[0].appendChild(_("span"));e.parentNode.removeChild(e)}catch(t){return}z=!0;for(var n=U.length,i=0;n>i;i++)U[i]()}}function n(e){z?e():U[U.length]=e}function i(e){if(typeof F.addEventListener!=C)F.addEventListener("load",e,!1);else if(typeof H.addEventListener!=C)H.addEventListener("load",e,!1);else if(typeof F.attachEvent!=C)v(F,"onload",e);else if("function"==typeof F.onload){var t=F.onload;F.onload=function(){t(),e()}}else F.onload=e}function r(){k?o():a()}function o(){var e=H.getElementsByTagName("body")[0],t=_(b);t.setAttribute("type",P);var n=e.appendChild(t);if(n){var i=0;!function(){if(typeof n.GetVariable!=C){var r=n.GetVariable("$version");r&&(r=r.split(" ")[1].split(","),Y.pv=[parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)])}else if(10>i)return i++,void setTimeout(arguments.callee,10);e.removeChild(t),n=null,a()}()}else a()}function a(){var e=j.length;if(e>0)for(var t=0;e>t;t++){var n=j[t].id,i=j[t].callbackFn,r={success:!1,id:n};if(Y.pv[0]>0){var o=E(n);if(o)if(!g(j[t].swfVersion)||Y.wk&&Y.wk<312)if(j[t].expressInstall&&c()){var a={};a.data=j[t].expressInstall,a.width=o.getAttribute("width")||"0",a.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(a.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(a.align=o.getAttribute("align"));for(var u={},p=o.getElementsByTagName("param"),h=p.length,f=0;h>f;f++)"movie"!=p[f].getAttribute("name").toLowerCase()&&(u[p[f].getAttribute("name")]=p[f].getAttribute("value"));l(a,u,n,i)}else d(o),i&&i(r);else T(n,!0),i&&(r.success=!0,r.ref=s(n),i(r))}else if(T(n,!0),i){var m=s(n);m&&typeof m.SetVariable!=C&&(r.success=!0,r.ref=m),i(r)}}}function s(e){var t=null,n=E(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=C)t=n;else{var i=n.getElementsByTagName(b)[0];i&&(t=i)}return t}function c(){return!V&&g("6.0.65")&&(Y.win||Y.mac)&&!(Y.wk&&Y.wk<312)}function l(e,t,n,i){V=!0,N=i||null,y={success:!1,id:n};var r=E(n);if(r){"OBJECT"==r.nodeName?(S=u(r),L=null):(S=r,L=n),e.id=D,(typeof e.width==C||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==C||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),H.title=H.title.slice(0,47)+" - Flash Player Installation";var o=Y.ie&&Y.win?"ActiveX":"PlugIn",a="MMredirectURL="+F.location.toString().replace(/&/g,"%26")+"&MMplayerType="+o+"&MMdoctitle="+H.title;if(typeof t.flashvars!=C?t.flashvars+="&"+a:t.flashvars=a,Y.ie&&Y.win&&4!=r.readyState){var s=_("div");n+="SWFObjectNew",s.setAttribute("id",n),r.parentNode.insertBefore(s,r),r.style.display="none",function(){4==r.readyState?r.parentNode.removeChild(r):setTimeout(arguments.callee,10)}()}p(e,t,n)}}function d(e){if(Y.ie&&Y.win&&4!=e.readyState){var t=_("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(u(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(u(e),e)}function u(e){var t=_("div");if(Y.win&&Y.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(b)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,o=0;r>o;o++)1==i[o].nodeType&&"PARAM"==i[o].nodeName||8==i[o].nodeType||t.appendChild(i[o].cloneNode(!0))}}return t}function p(e,t,n){var i,r=E(n);if(Y.wk&&Y.wk<312)return i;if(r)if(typeof e.id==C&&(e.id=n),Y.ie&&Y.win){var o="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?o+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(o+=" "+a+'="'+e[a]+'"'));var s="";for(var c in t)t[c]!=Object.prototype[c]&&(s+='<param name="'+c+'" value="'+t[c]+'" />');r.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+o+">"+s+"</object>",G[G.length]=e.id,i=E(e.id)}else{var l=_(b);l.setAttribute("type",P);for(var d in e)e[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?l.setAttribute("class",e[d]):"classid"!=d.toLowerCase()&&l.setAttribute(d,e[d]));for(var u in t)t[u]!=Object.prototype[u]&&"movie"!=u.toLowerCase()&&h(l,u,t[u]);r.parentNode.replaceChild(l,r),i=l}return i}function h(e,t,n){var i=_("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function f(e){var t=E(e);t&&"OBJECT"==t.nodeName&&(Y.ie&&Y.win?(t.style.display="none",function(){4==t.readyState?m(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function m(e){var t=E(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function E(e){var t=null;try{t=H.getElementById(e)}catch(n){}return t}function _(e){return H.createElement(e)}function v(e,t,n){e.attachEvent(t,n),q[q.length]=[e,t,n]}function g(e){var t=Y.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function O(e,t,n,i){if(!Y.ie||!Y.mac){var r=H.getElementsByTagName("head")[0];if(r){var o=n&&"string"==typeof n?n:"screen";if(i&&(R=null,I=null),!R||I!=o){var a=_("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),R=r.appendChild(a),Y.ie&&Y.win&&typeof H.styleSheets!=C&&H.styleSheets.length>0&&(R=H.styleSheets[H.styleSheets.length-1]),I=o}Y.ie&&Y.win?R&&typeof R.addRule==b&&R.addRule(e,t):R&&typeof H.createTextNode!=C&&R.appendChild(H.createTextNode(e+" {"+t+"}"))}}}function T(e,t){if(W){var n=t?"visible":"hidden";z&&E(e)?E(e).style.visibility=n:O("#"+e,"visibility:"+n)}}function A(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=C?encodeURIComponent(e):e}var S,L,N,y,R,I,C="undefined",b="object",w="Shockwave Flash",x="ShockwaveFlash.ShockwaveFlash",P="application/x-shockwave-flash",D="SWFObjectExprInst",M="onreadystatechange",F=window,H=document,B=navigator,k=!1,U=[r],j=[],G=[],q=[],z=!1,V=!1,W=!0,Y=function(){var e=typeof H.getElementById!=C&&typeof H.getElementsByTagName!=C&&typeof H.createElement!=C,t=B.userAgent.toLowerCase(),n=B.platform.toLowerCase(),i=n?/win/.test(n):/win/.test(t),r=n?/mac/.test(n):/mac/.test(t),o=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,s=[0,0,0],c=null;if(typeof B.plugins!=C&&typeof B.plugins[w]==b)c=B.plugins[w].description,!c||typeof B.mimeTypes!=C&&B.mimeTypes[P]&&!B.mimeTypes[P].enabledPlugin||(k=!0,a=!1,c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=parseInt(c.replace(/^(.*)\..*$/,"$1"),10),s[1]=parseInt(c.replace(/^.*\.(.*)\s.*$/,"$1"),10),s[2]=/[a-zA-Z]/.test(c)?parseInt(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof F.ActiveXObject!=C)try{var l=new ActiveXObject(x);l&&(c=l.GetVariable("$version"),c&&(a=!0,c=c.split(" ")[1].split(","),s=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)]))}catch(d){}return{w3:e,pv:s,wk:o,ie:a,win:i,mac:r}}();return function(){Y.w3&&((typeof H.readyState!=C&&"complete"==H.readyState||typeof H.readyState==C&&(H.getElementsByTagName("body")[0]||H.body))&&e(),z||(typeof H.addEventListener!=C&&H.addEventListener("DOMContentLoaded",e,!1),Y.ie&&Y.win&&(H.attachEvent(M,function(){"complete"==H.readyState&&(H.detachEvent(M,arguments.callee),e())}),F==top&&!function(){if(!z){try{H.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),Y.wk&&!function(){return z?void 0:/loaded|complete/.test(H.readyState)?void e():void setTimeout(arguments.callee,0)}(),i(e)))}(),function(){Y.ie&&Y.win&&window.attachEvent("onunload",function(){for(var e=q.length,n=0;e>n;n++)q[n][0].detachEvent(q[n][1],q[n][2]);for(var i=G.length,r=0;i>r;r++)f(G[r]);for(var o in Y)Y[o]=null;Y=null;for(var a in t)t[a]=null;t=null})}(),{registerObject:function(e,t,n,i){if(Y.w3&&e&&t){var r={};r.id=e,r.swfVersion=t,r.expressInstall=n,r.callbackFn=i,j[j.length]=r,T(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return Y.w3?s(e):void 0},embedSWF:function(e,t,i,r,o,a,s,d,u,h){var f={success:!1,id:t};Y.w3&&!(Y.wk&&Y.wk<312)&&e&&t&&i&&r&&o?(T(t,!1),n(function(){i+="",r+="";var n={};if(u&&typeof u===b)for(var m in u)n[m]=u[m];n.data=e,n.width=i,n.height=r;var E={};if(d&&typeof d===b)for(var _ in d)E[_]=d[_];if(s&&typeof s===b)for(var v in s)typeof E.flashvars!=C?E.flashvars+="&"+v+"="+s[v]:E.flashvars=v+"="+s[v];if(g(o)){var O=p(n,E,t);n.id==t&&T(t,!0),f.success=!0,f.ref=O}else{if(a&&c())return n.data=a,void l(n,E,t,h);T(t,!0)}h&&h(f)})):h&&h(f)},switchOffAutoHideShow:function(){W=!1},ua:Y,getFlashPlayerVersion:function(){return{major:Y.pv[0],minor:Y.pv[1],release:Y.pv[2]}},hasFlashPlayerVersion:g,createSWF:function(e,t,n){return Y.w3?p(e,t,n):void 0},showExpressInstall:function(e,t,n,i){Y.w3&&c()&&l(e,t,n,i)},removeSWF:function(e){Y.w3&&f(e)},createCSS:function(e,t,n,i){Y.w3&&O(e,t,n,i)},addDomLoadEvent:n,addLoadEvent:i,getQueryParamValue:function(e){var t=H.location.search||H.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return A(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return A(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(V){var e=E(D);e&&S&&(e.parentNode.replaceChild(S,e),L&&(T(L,!0),Y.ie&&Y.win&&(S.style.display="block")),N&&N(y)),V=!1}}}}();return t}),define("common/extensions/audio",["common/extensions/swfobject","config/setup","common/extensions/browserDetect"],function(e,t,n){var i=function(){var t,i,r,o=!0,a=!0;return{init:function(s){if(void 0!==s&&(o=!!s),n.isMobile||"Android"===n.OS||"iPhone"===n.OS)return a=!1,void(r=function(){});if(t=document.createElement("audio"),t.canPlayType)t.canPlayType("audio/mp3")?t.setAttribute("src","/container/images/common/msg.mp3"):t.setAttribute("src","/container/images/common/msg.ogg"),t.volume=.4,r=function(){t.play()};else{try{if(!e.hasFlashPlayerVersion("1"))return r=function(){},void(a=!1)}catch(c){return r=function(){},void(a=!1)}var l={AllowScriptAccess:"always"},d={data:"/container/images/common/mp3player.swf",width:"0",height:"0"};i=e.createSWF(d,l,"audio"),r=function(){try{i.SetVariable("method:setVolume","40"),i.SetVariable("method:setUrl","/container/images/common/msg.mp3"),i.SetVariable("method:play","")}catch(e){}}}},play:function(){o&&r()},turnOn:function(){o=!0},turnOff:function(){o=!1},soundCheck:function(){return a}}}();return i}),define("xmpp/history.cache",["application/dispatcher","application/session.objects","config/setup","common/extensions/compatibility","jquery","common/extensions/browserDetect","application/command"],function(e,t,n,i,r,o,a){function s(){f.length>u&&(f.splice(0,p),a.execute("decreaseHistoryPointer")),window.localStorage.setItem(d,JSON.stringify(f))}function c(){E&&window.localStorage.setItem("pityIE",(new Date).getTime());var e=window.localStorage.getItem(d)||"[]";e.length!==h&&(h=e.length,f=JSON.parse(e))}function l(e,t){e.ignore||!e.text||e.hide||(f.push({clientName:n.CLIENT_NAME,companyId:n.COMPANY_ID,time:e.time,id:e.id,text:e.text,sender:e.sender,displayName:e.displayName,guid:e.guid,isIncoming:t,unixTime:(new Date).getTime()}),s(),_())}if(window.localStorage){var d="rhlp.global.history",u=500,p=100,h=-1,f=[];c();var m=f.length,E="Explorer"===o.browser;a.setHandler("decreaseHistoryPointer",function(){m-=p});var _=function(){for(c();m<f.length;m++){var t=f[m];t.clientName!==n.CLIENT_NAME||t.companyId&&t.companyId!==n.COMPANY_ID||(e.fire("message.new."+(t.isIncoming?"incoming":"outcoming"),t),e.fire("message.new",t))}};setInterval(_,1e3);var v=function(e){"key"in e&&-1!==e.key.indexOf(d)&&_()};window.addEventListener?(window.addEventListener("storage",v,!1),document.addEventListener("storage",v,!1),window.addEventListener("onstorage",v,!1),document.addEventListener("onstorage",v,!1)):(document.attachEvent("onstorage",v),window.attachEvent("onstorage",v)),e.addEventListener("message.clearHistory",function(){for(var e=[],t=0,i=f.length;i>t;t++)(f[t].clientName!==n.CLIENT_NAME||f[t].companyId&&f[t].companyId!==n.COMPANY_ID)&&e.push(f[t]);f=e,s()}),e.addEventListener("message.received",function(e){l(e,!0)}),e.addEventListener("message.send",function(e){l(e,!1)}),e.addEventListener("replaceMessage",function(e){for(var t=0,n=f.length;n>t;t++)if(f[t].guid===e.guid){f[t].text=e.text;break}s()}),e.addEventListener("message.getHistory",function(){if(t.vid){var i;c();var r=!1;for(i in f)f.hasOwnProperty(i)&&(f[i].clientName!==n.CLIENT_NAME||f[i].companyId&&f[i].companyId!==n.COMPANY_ID||(f[i].companyId||(f[i].companyId=n.COMPANY_ID,r=!0),e.fire("message.history",f[i])));r&&s(),e.fire("historyShown")}}),"Explorer"===o.browser&&o.version<9}}),define("xmpp/offline",["common/extensions/jquery.plugins","application/dispatcher","common/extensions/browserDetect","config/lang","config/setup","common/constants/offlineError","application/session.objects","common/communication/encoder"],function(e,t,n,i,r,o,a,s){var c="noreply@redhelper.ru",l=function(){return{send:function(l,d,u,p){var h,f=i.OFFLINE_FROM_VISITOR+" #{vid}\n---\n"+i.PAGE+": "+r.CURRENT_URL+(r.CURRENT_TITLE?" ("+r.CURRENT_TITLE+")\n":"\n")+i.TIMEONSITE+": "+Math.floor(a.time/60)+":"+a.time%60+"\nIP: "+a.ip+"\n"+i.BROWSER+": "+n.browser+" "+n.version+" ("+n.OS+")\n"+i.REFERRER+": "+(a.referrer||i.NOREFERRER)+"\n"+(a.country?i.LOCATION+": "+("ru"==a.locale?(a.city_ru||i.NOTDEFINED)+", "+a.country_ru:(a.city||i.NOTDEFINED)+", "+a.country)+"\n":"")+"---\n"+(l?i.OFFLINE_VISITOR_NAME+": "+l+"\n":"")+(d?i.OFFLINE_BODY_HEADER1+": "+d+" ("+i.OFFLINE_BODY_HEADER2+")\n":"\n");if(!a.free&&a.customFields)try{var m=s.parse(a.customFields);for(h in m)m.hasOwnProperty(h)&&void 0!==m[h].name&&void 0!==m[h].value&&(f+=m[h].name+": "+m[h].value+"\n")}catch(E){}p&&(f+=i.PHONE_MESSAGE+": "+p+"\n"),f+=u?"\n"+i.MESSAGE_LABEL+":\n":"";var _=function(){e.ajax({url:r.NX_URL+"offline/"+r.CLIENT_NAME,data:{message:f.replace("#{vid}","#"+a.vid)+u,name:l,email:d||c,domain:r.CURRENT_URL.split("//").pop().split("/").shift(),vid:a.vid,page:window.redhlpSettings&&window.redhlpSettings.page?window.redhlpSettings.page:r.CURRENT_URL},dataType:"jsonp",type:"POST",success:function(e){if("OK"===e)t.fire("offlineSuccess");else{var n=o.INCORRECT_EMAIL;t.fire("offlineFailure",{errorCode:n})}}})};if(a.vid)_();else{var v=function(){_(),t.fire("disconnect"),t.removeEventListener("authenticated",v)};t.addEventListener("authenticated",v),t.fire("xmppManagerStart")}}}}();t.addEventListener("sendOffline",function(e){l.send(e.name,e.email,e.message,e.phone)})}),define("config/settings",["common/communication/encoder"],function(e){try{return e.decompress(location.hash.split("#")[1])}catch(t){return{}}}),define("application/redhelper",["application/dispatcher","application/session.objects","application/parent","common/extensions/guid","common/constants/sender"],function(e,t,n,i,r){var o,a;window.RedHelper={execFunction:function(t,n){e.fire("sendExecFunction",{name:t,args:n})}},n.addHandler("execFunction",function(e){try{window[e.name].apply(null,e.args)}catch(t){}}),n.addHandler("sendMessage",function(n){e.fire("message.send",{sent:!0,text:n.text,unixTime:(new Date).getTime(),guid:i.generate(),hide:!n.show,st:"b",displayName:t.operDisplayName,sender:r.VISITOR})}),window.RedHelper.session={};var s=function(e){window.RedHelper.session[e]=t[e],t.dispatcher.addEventListener("on"+e.charAt(0).toUpperCase()+e.substr(1)+"Changed",function(){window.RedHelper.session[e]=t[e]})};for(o=0,a=t.fields.length;a>o;o++)s(t.fields[o])}),define("text",["module"],function(e){var t,n,i,r,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,d=l&&location.protocol&&location.protocol.replace(/\:/,""),u=l&&location.hostname,p=l&&(location.port||void 0),h={},f=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(i){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,o=e.lastIndexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),n=e.substring(o+1)):t=e,i=n||t,o=i.indexOf("!"),-1!==o&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var o,a,s,c=t.xdRegExp.exec(e);return c?(o=c[2],a=c[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==n||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==r)):!0},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,f.isBuild&&(h[e]=i),r(i)},load:function(e,n,i,r){if(r&&r.isBuild&&!r.inlineText)return void i();f.isBuild=r&&r.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=n.toUrl(a),c=f.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void i():void(!l||c(s,d,u,p)?t.get(s,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)}))},write:function(e,n,i,r){if(h.hasOwnProperty(n)){var o=t.jsEscape(h[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,r,o){var a=t.parseName(n),s=a.ext?"."+a.ext:"",c=a.moduleName+s,l=i.toUrl(a.moduleName+s)+".js";t.load(c,i,function(n){var i=function(e){return r(l,e)};i.asModule=function(e,t){return r.asModule(e,l,t)},t.write(e,c,i,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");"\ufeff"===r[0]&&(r=r.substring(1)),t(r)}catch(o){i&&i(o)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,r){var o,a=t.createXhr();if(a.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(t){var r,o;4===a.readyState&&(r=a.status||0,r>399&&600>r?(o=new Error(e+" HTTP status: "+r),o.xhr=a,i&&i(o)):n(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,e))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),c="";try{for(n=new java.lang.StringBuffer,i=s.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=s.readLine());)n.append(a),n.append(i);c=String(n.toString())}finally{s.close()}t(c)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,a,s,c={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(s,1,0,!1),a=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),c),a.close(),n.close(),t(c.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),t}),define("text!common/../../container/template.html",[],function(){return'<template>\n    <div id="chooseDepartment" style="display: none">\n        <div class="colorifier"></div>\n        <div class="topPanel">\n            <div class="topHeader"></div>\n            <div class="topText"></div>\n        </div>\n        <div class="chooseDepartmentTextWrapper">\n            <div class="chooseDepartmentText"></div>\n            <span class="hideDepartments"><span class="icon"><div class="colorifier"></div><span></span></span><span class="txt"></span></span>\n        </div>\n        <div id="departmentsWrapper">\n            <div id="departmentsContainer">\n                <ul id="departments"></ul>\n                <div class="scroller__track">\n                    <div class="scroller__bar" id="departments_bar"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div id="offline" style="display: none;">\n   <div class="colorifier"></div>\n    <div class="center">\n      <div class="topPanel">\n                <span class="showDepartments"><span class="icon"><div class="colorifier"></div><span></span></span><span class="txt"></span></span>\n       <div class="header"></div>\n        <div class="description"></div>\n     </div>\n      <div id="offlineError"></div>\n     <div id="mailSuccess"></div>\n      <div id="feedbackForm">\n       <div class="inputField name inputField_name">\n         <input id="name" type="text" name="name"/>\n        </div>\n        <div class="inputField email">\n          <input id="email" type="email" name="email"/>\n       </div>\n                <div class="inputField phone">\n                    <input id="phone" type="text" name="phone"/>\n                </div>\n        <div class="inputField message">\n          <textarea id="message" name="message"></textarea>\n       </div>\n        <div id="actionPanel">\n          <div id="sendButton"></div>\n         <div id="throbber" style="display: none;"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div id="offlineSuccess" style="display: none;">\n    <div></div>\n </div>\n  <div id="online" style="display: none;">\n    <div class="colorifier"></div>\n    <div id="onlinePanel">\n      <div class="center">\n        <div class="wrapper">\n         <div class="topPanel">\n            <div id="faceWrapper">\n              <div id="faceRate">\n                                <div id="faceImgWrapper"><img id="face" alt=""></div>\n                                <div id="rate">\n                                    <div class="colorifier"></div>\n                                    <a id="like">&nbsp;</a>\n                                    <a id="dislike">&nbsp;</a>\n                                </div>\n                            </div>\n              <div id="topDescription">\n               <div id="topHeader"></div>\n                <div id="topText"></div>\n                                <div style="clear: both;"></div>\n                                <a class="showDepartments"><span class="icon"><div class="colorifier"></div><span></span></span><span class="txt"></span></a>\n             </div>\n            </div>\n          </div>\n          <div id="scrollBarContainer">\n           <div id="scrollBar"></div>\n          </div>\n                    <div id="chatContainer">\n                        <div id="chatItself">\n                            <div id="invitation"></div>\n\n                            <div class="msg" id="typingLabel">\n                                <div class="textWrapper">\n                                    <div class="text">%text%</div>\n                                </div>\n                            </div>\n                            <div class="msg" id="chatLabel">\n                                <div class="textWrapper">\n                                    <div class="text">%text%</div>\n                                </div>\n                            </div>\n                            <div class="scroller__track">\n                                <div class="scroller__bar" id="chat_bar"></div>\n                            </div>\n                        </div>\n                    </div>\n          <div id="chatInput">\n            <div id="textAreaWrapper">\n              <textarea id="chatTextarea" spellcheck="false"></textarea>\n            </div>\n            <a id="chatSend"><div class="colorifier"></div></a>\n                        <a id="fileSend"><div class="colorifier"></div></a>\n          </div>\n                    <div id="fileUploadWrapper">\n                        <div class="text">\n                        </div>\n                        <input type="file" name="file" id="uploadedFile"/>\n                    </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n    <div id="fromOperatorHeader" class="msgHeader fromOperator">\n    <span class="sender">%displayName%</span>\n </div>\n\n  <div id="fromOperator" class="msg">\n   <span class="time" title="%date%">%time%</span>\n   <div class="textWrapper">\n     <div class="text">%text%</div>\n    </div>\n  </div>\n\n  <div id="fromVisitorHeader" class="msgHeader fromVisitor">\n    <span class="sender">%displayName%</span>\n </div>\n\n  <div id="fromVisitor" class="msg">\n    <span class="time" title="%date%"><span class="delivery"></span>%time%</span>\n   <div class="textWrapper">\n     <div class="text">%text%</div>\n    </div>\n  </div>\n  <div id="promptContainer" class="msg">\n    <span class="time" title="%date%">%promptTime%</span>\n   <div class="textWrapper">\n     <div class="text">%text%</div>\n    </div>\n  </div>\n</template>'}),define("text!common/../../container/template-modern.html",[],function(){return'<template>\n  <div id="chooseDepartment" style="display: none">\n   <div class="center">\n      <div class="topPanel">\n        <div class="topHeader colorText"></div>\n       <div class="topText colorText"></div>\n       <div style="clear:both;"></div>\n     </div>\n      <div class="chooseDepartmentTextWrapper">\n       <div class="chooseDepartmentText colorText"></div>\n        <span class="hideDepartments"><span class="icon"><div class="colorifier"></div><span></span></span><span class="txt colorText"></span></span>\n     </div>\n      <div id="departmentsWrapper">\n       <div id="departmentsContainer">\n         <ul id="departments"></ul>\n          <div class="scroller__track">\n           <div class="scroller__bar" id="departments_bar"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div id="offline" style="display: none;">\n   <div class="center">\n      <div class="topPanel">\n        <div class="topHeader header colorText"></div>\n        <div class="topText description colorText"></div>\n       <span class="showDepartments"><span class="icon"><div class="colorifier"></div><span></span></span><span class="txt colorText"></span></span>\n       <div style="clear: both;"></div>\n      </div>\n\n      <div id="offlineError"></div>\n     <div id="mailSuccess"></div>\n      <div id="feedbackForm">\n       <div class="inputField name inputField_name">\n         <input id="name" type="text" name="name"/>\n        </div>\n        <div class="inputField email">\n          <input id="email" type="email" name="email"/>\n       </div>\n        <div class="inputField phone">\n          <input id="phone" type="text" name="phone"/>\n        </div>\n        <div class="inputField message">\n          <textarea id="message" name="message"></textarea>\n       </div>\n        <div id="actionPanel">\n          <div id="sendButton"></div>\n         <div id="throbber" style="display: none;"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div id="offlineSuccess" style="display: none;">\n    <div></div>\n </div>\n  <div id="online" style="display: none;">\n    <div id="onlinePanel">\n      <div class="center">\n        <div class="wrapper">\n         <div class="topPanel">\n            <div id="faceWrapper">\n              <div id="faceRate">\n               <div id="faceImgWrapper"><img id="face" alt=""></div>\n               <div id="rate">\n                 <a id="like">&nbsp;</a>\n                 <a id="dislike">&nbsp;</a>\n                </div>\n              </div>\n              <div id="topDescription">\n               <div id="topHeader" class="topHeader colorText"></div>\n                <div id="topText" class="topText colorText"></div>\n              </div>\n              <div style="clear: both;"></div>\n            </div>\n            <div id="chatOperatorInfo">\n             <a class="showDepartments"><span class="icon"><div class="colorifier"></div><span></span></span><span class="txt colorText"></span></a>\n             <span id="operatorArrow" class="colorText">&raquo;</span>\n             <span id="operatorLabel" class="colorText"></span>\n              <span id="operatorName" class="colorText"></span>\n           </div>\n          </div>\n\n          <div id="scrollBarContainer">\n           <div id="scrollBar"></div>\n          </div>\n          <div id="chatContainer">\n            <div id="chatItself">\n             <div id="invitation"></div>\n\n             <div class="msg" id="typingLabel">\n                <div class="textWrapper">\n                 <div class="text">%text%</div>\n                </div>\n              </div>\n              <div class="msg" id="chatLabel">\n                <div class="textWrapper">\n                 <div class="text">%text%</div>\n                </div>\n              </div>\n              <div class="scroller__track">\n               <div class="scroller__bar" id="chat_bar"></div>\n             </div>\n            </div>\n          </div>\n          <div id="chatResize"></div>\n         <div id="chatInput">\n            <div id="textAreaWrapper">\n              <textarea id="chatTextarea" spellcheck="false"></textarea>\n            </div>\n            <a id="chatSend"></a>\n           <a id="fileSend"></a>\n         </div>\n          <div id="fileUploadWrapper">\n            <div class="text">\n            </div>\n            <input type="file" name="file" id="uploadedFile"/>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div id="fromOperatorHeader" class="msgHeader fromOperator">\n    <span class="time" title="%date%">%time%</span>\n   <div class="msgHeaderFace">\n     <div class="chatFace"><img class="face" width="21" alt=""/></div>\n     <div class="speak"></div>\n   </div>\n  </div>\n\n  <div id="fromOperator" class="msg">\n   <div class="textWrapper">\n     <div class="text">%text%</div>\n    </div>\n    <div style="clear: both;"></div>\n  </div>\n\n  <div id="fromVisitorHeader" class="msgHeader fromVisitor">\n    <span class="time" title="%date%">%time%</span>\n   <div class="msgHeaderFace">\n     <div class="chatFace"><img src="../container/images/modern/visitor_small.png?v=2" alt=""/></div>\n      <div class="speak"></div>\n   </div>\n  </div>\n\n  <div id="fromVisitor" class="msg">\n    <div class="textWrapper">\n     <div class="text">%text%</div>\n    </div>\n    <div style="clear: both;"></div>\n  </div>\n  \n  <div id="promptContainer" class="msg">\n    <span class="time" title="%date%">%promptTime%</span>\n   %text%\n  </div>  \n</template>';
}),define("application/DOMObserver",["application/parent","application/dispatcher","application/session.objects"],function(e,t,n){e.addHandler("sendMutations",function(e){if(n.mouseOperators&&"{}"!==n.mouseOperators){var i=[],r=JSON.parse(n.mouseOperators);for(var o in r)r.hasOwnProperty(o)&&i.push(r[o].jid.extractNode());t.fire("cobrowseMessage",{action:"mutations",data:e.mutationsList,to:i})}})}),define("common/extensions/lzw",[],function(){return{compress:function(e){var t,n,i,r={},o="",a=[],s=256;for(t=0;256>t;t+=1)r[String.fromCharCode(t)]=t;for(t=0;t<e.length;t+=1)n=e.charAt(t),i=o+n,r.hasOwnProperty(i)?o=i:(a.push(r[o]),r[i]=s++,o=String(n));return""!==o&&a.push(r[o]),a=String.fromCharCode.apply(String,a)},decompress:function(e){var t,n,i,r,o,a=[],s="",c=256,l=[];for(t=0,n=e.length;n>t;t++)l.push(e.charCodeAt(t));for(t=0;256>t;t+=1)a[t]=String.fromCharCode(t);for(i=String.fromCharCode(l[0]),r=i,t=1;t<l.length;t+=1){if(o=l[t],a[o])s=a[o];else{if(o!==c)return null;s=i+i.charAt(0)}r+=s,a[c++]=i+s.charAt(0),i=s}return r}}}),define("application/cobrowseContent",["application/parent","application/dispatcher","common/extensions/lzw","application/session.objects"],function(e,t,n,i){var r=function(e){if(!i.disableCobrowse){var n,r=JSON.parse(i.mouseOperators),o=[];if(e.to)o=e.to instanceof Array?e.to:[e.to];else for(n in r)r.hasOwnProperty(n)&&r[n].html&&o.push(r[n].jid.extractNode());var a={html:e.html,htmlId:e.htmlId||"id",htmlClass:e.htmlClass||"class",url:e.url,windowWidth:e.windowWidth,windowHeight:e.windowHeight,chatX:i.chatX,chatY:i.chatY,chatWidth:i.chatWidth||i.currentChatWidth,chatHeight:i.chatHeight||i.currentChatHeight,chatState:i.chatState,focus:i.IsFocused};t.fire("cobrowseMessage",{action:"html",data:a,to:o})}};t.addEventListener("retrieveHTML",function(t){e.send("retrieveHTML",{to:t.to})}),t.addEventListener("retrieveURL",function(t){e.send("retrieveURL",{force:!0,to:t.to})}),e.addHandler("sendHTML",r),e.addHandler("sendURL",function(e){var n=JSON.parse(i.mouseOperators||"{}"),r=[];e.to&&(r=[e.to]);var o;for(o in n)n.hasOwnProperty(o)&&n[o].html&&r.push(n[o].jid.extractNode());t.fire("cobrowseMessage",{action:"url",data:e.url,to:r})}),setInterval(function(){e.send("retrieveURL")},1e3)}),define("application/standalone",["config/setup","application/dispatcher","config/lang","xmpp/connection","application/timer","xmpp/update","application/session.objects","common/extensions/tabs"],function(e,t,n,i,r,o,a,s){t.addEventListener("sessionLoaded",function(){e.STANDALONE&&(e.CURRENT_URL="standalone",e.CURRENT_TITLE=n.TITLE_NEW_TAB,location.search.indexOf("operator=")>-1&&(a.requiredOperator=location.search.split("operator=")[1].split("&")[0]),document.title=n.PAGE_TITLE,t.fire("start"),t.addEventListener("operator",function(){o.state("chat")}),t.addEventListener("userBack",function(){s.forceElection(),t.fire("refreshHistory")}),t.addEventListener("userAway",function(){t.fire("disconnect")}),t.addEventListener("timer_userBack",function(){r.start()}),t.addEventListener("timer_userAway",function(){r.stop()}),t.fire("xmppStart"))})}),define("application/iframe",["application/dispatcher","application/parent","application/session.objects","xmpp/update","xmpp/connection","config/setup","common/extensions/mouse","application/timer","common/application/basicActivity","view/chat","common/extensions/tabs"],function(e,t,n,i,r,o,a,s,c,l,d){e.addEventListener("sessionLoaded",function(){if(!o.STANDALONE){e.addEventListener("updateChatState",function(e){i.state(e.state)}),t.addHandler("init",function(){t.send("ready")}),t.addHandler("echo",function(){t.send("echo")});var l=function(e){if(t.removeHandler("start",l),o.CURRENT_URL=e.url,o.CURRENT_TITLE=e.title,o.CURRENT_PAGE=e.page,t.setOrigin(e.url),d.forceElection(),"object"==typeof e.rhSettings){window.redhlpSettings||(window.redhlpSettings={});for(it in e.rhSettings)e.rhSettings.hasOwnProperty(it)&&(window.redhlpSettings[it]||(window.redhlpSettings[it]=e.rhSettings[it]))}window.redhlpSettings&&window.redhlpSettings.activityInterval&&c.changeInterval(window.redhlpSettings.activityInterval)};t.addHandler("start",l);var u=!0,p=!0;t.addHandler("active",function(){u=!0,c.isActive()||(d.forceElection(),e.fire("global:userBack"))}),t.addHandler("inactive",function(){u=!1,c.isActive()||(e.fire("global:userAway"),e.fire("disconnect"))}),e.addEventListener("userBack",function(){u||(e.fire("global:userBack"),d.forceElection(),e.fire("refreshHistory"),e.fire("retrieveHTML"))}),e.addEventListener("userAway",function(){u||(e.fire("global:userAway"),e.fire("disconnect"))}),t.addHandler("timer_active",function(){p=!0,s.getActivity().isActive()||s.start()}),t.addHandler("timer_inactive",function(){p=!1,s.getActivity().isActive()||s.stop()}),e.addEventListener("timer_userBack",function(){p||s.start()}),e.addEventListener("timer_userAway",function(){p||s.stop()}),t.addHandler("message.invitation",function(t){e.fire("message.new.incoming",t)}),t.addHandler("reconnect",function(){e.fire("reconnect")}),t.send("ready"),a.init().setAsMaster().addParentSlave(t),a.setOffsetFunction(function(e){e.x=e.x+n.currentChatX,e.y=e.y+n.currentChatY+20,e.width=a.getParentMouseData().width,e.height=a.getParentMouseData().height,e.scrollX=a.getParentMouseData().scrollX,e.scrollY=a.getParentMouseData().scrollY}),t.addHandler("state",function(e){e.inviteState?i.invite(e.chatState,e.inviteState,e.trigger):i.state(e.chatState)}),t.addHandler("invitationSniff",function(e){i.inviteSniff(e.trigger,"manual"===e.trigger?n.currentOperator:"")}),t.addHandler("chOper",function(e){o.REQUIRE_OPERATOR=e.value}),t.addHandler("chatXChanged",function(e){n.chatX=e.x}),t.addHandler("chatYChanged",function(e){n.chatY=e.y}),t.addHandler("chatWidthChanged",function(e){n.chatWidth!==e.width&&(n.chatWidth=e.width,n.currentChatWidth=e.width)}),t.addHandler("chatHeightChanged",function(e){n.chatHeight!==e.height&&(n.chatHeight=e.height,n.currentChatHeight=e.height)}),t.addHandler("chatStateChanged",function(e){n.chatState=e.chatState}),t.addHandler("chatXChanged",function(e){n.chatX=e.x,n.currentChatX=e.x}),t.addHandler("chatYChanged",function(e){n.chatY=e.y,n.currentChatY=e.y}),t.addHandler("currentChatXChanged",function(e){n.currentChatX=e.x}),t.addHandler("currentChatYChanged",function(e){n.currentChatY=e.y}),t.addHandler("currentChatWidthChanged",function(e){n.currentChatWidth=e.width}),t.addHandler("currentChatHeightChanged",function(e){n.currentChatHeight=e.height}),t.addHandler("chatStateChanged",function(e){n.chatState=e.chatState}),e.addEventListener("invitation",function(e){t.send("invitation",e)}),e.addEventListener("authenticated",function(){t.send("authenticated"),n.isOnline||n.offlineEnabled||t.send("hide")}),e.addEventListener("changeState",function(e){e.online&&t.send("show"),e.online||n.offlineEnabled||n.chatStarted||t.send("hide")}),e.addEventListener("disconnected",function(){t.send("disconnected"),r.reconnect()}),t.addHandler("reload",function(){setTimeout(function(){location.reload()},3e3)}),e.addEventListener("message.new",function(e){t.send("message.displayed",e)}),e.addEventListener("offlineDone",function(){t.send("minimize")}),e.addEventListener("sendExecFunction",function(e){t.send("execFunction",{name:e.name,args:e.args})})}})}),define("application/offlinevid",["application/dispatcher","application/parent","application/session.objects"],function(e,t,n){var i=function(){e.fire("disconnect"),e.removeEventListener("authenticated",i),e.fire("gotVid")},r=!1,o=function(){r=!0};t.addHandler("getOfflineVid",o),e.addEventListener("sessionLoaded",function(){t.removeHandler("getOfflineVid",o),e.addEventListener("getOfflineVid",function(){n.isPartiallyOnline||(e.addEventListener("authenticated",i),e.fire("xmppManagerStart"))}),t.addHandler("getOfflineVid",function(){e.fire("getOfflineVid")}),r&&e.fire("getOfflineVid")})}),define("application/pageVisibilityTracker",["application/dispatcher","jquery","application/session.objects"],function(e,t,n){function i(e){e=e||window.event,o(e.type in evtMap?evtMap[e.type]:!this.hidden)}try{var r=!1;n.IsFocused=!0,n.IsChatFocused=!1;var o=function(t){if(r!==t&&(r=t,n.IsChatFocused=r,!n.IsPageFocused||!n.IsChatFocused)){var i=n.IsPageFocused||n.IsChatFocused;n.IsFocused!==i&&(n.IsFocused=i,e.fire("focus.changed"))}};evtMap={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1},"onfocusin"in document?window.onfocusin=window.onfocusout=document.onfocusin=document.onfocusout=i:(t(window).blur(function(){o(!1)}),t(window).focus(function(){o(!0)}))}catch(a){}}),define("xmpp/strophe.patch",["common/extensions/strophe"],function(){}),requirejs(["common/extensions/compatibility","common/extensions/browserDetect","application/dispatcher","application/distribution","view/view","view/chat","application/session.objects","common/extensions/jquery.plugins","config/lang","xmpp/messages","view/cssChecker","xmpp/xmppManager","view/uiEvents","common/extensions/audio","common/extensions/punycode","application/parent","xmpp/connection","common/constants/sender","common/constants/chatWindowStage","application/timer","common/application/basicActivity","common/extensions/debug","config/setup","xmpp/update","common/extensions/mouse","common/communication/messageTarget","xmpp/history.cache","xmpp/offline","common/extensions/tabs","config/settings","config/api","application/redhelper","common/communication/encoder","text!common/../../container/template.html","text!common/../../container/template-modern.html","common/extensions/guid","application/DOMObserver","application/cobrowseContent","application/standalone","application/iframe","common/constants/chatState","application/offlinevid","application/pageVisibilityTracker","common/extensions/base64","xmpp/strophe.patch","xmpp/queue","xmpp/desktopCommands"],function(e,t,n,i,r,o,a,s,c,l,d,u,p,h,f,m,E,_,v,g,O,T,A,S,L,N,y,R,I,C,b,w,x,P,D,M,F,H,B,k,U,j,G,q,z,V,W){function Y(){try{if(!a.currentOperator||!a.operDisplayName)return void setTimeout(Y,100);if(!a.firstMessage)return;o.showFirstMessage({sender:_.OPERATOR,time:"",text:a.free?c.DEFAULT_FIRST_MESSAGE:a.currentFirstMessage||a.firstMessage,displayName:a.operDisplayName})}catch(e){}}var Q=!1;"Explorer"===t.browser&&setInterval(function(){localStorage.setItem("StupidIE",(new Date).getTime()),sessionStorage.setItem("StupidIE",(new Date).getTime())},50),window.$=window.jQuery=s;var J=function(){n.removeEventListener("start",J),c.initLanguage(),n.addEventListener("sendResize",function(e){m.send("setMinSize",{width:e.width,height:e.height})}),n.addEventListener("message.send",function(e){m.send("message.send",e)}),n.addEventListener("message.received",function(e){m.send("message.received",e)}),n.addEventListener("rateOperator",function(e){m.send("rateOperator",e)});var e=function(){a.isOnline||n.fire("refreshOperator")};if(n.addEventListener("message.new",e),n.addEventListener("invitation",e),n.addEventListener("cssLoaded",function(){o.scrollBottom()}),n.addEventListener("historyShown",function(){o.scrollBottom()}),d.check(),a.isOnline||a.offlineEnabled||m.send("hide"),b.innerCSS&&(b.innerCSS=b.innerCSS.replace("http:",location.protocol),s("<link rel='stylesheet' href='"+b.innerCSS+"'>").appendTo("head")),b.additionalJS)for(var t=b.additionalJS.length-1;t>-1;t--)b.additionalJS[t]=b.additionalJS[t].replace("http:",location.protocol),s.getScript(b.additionalJS[t]);if(m.addHandler("scrollMessages",function(){o.scrollBottom()}),m.addHandler("templateReceived",function(e){n.fire("templateReceived",e)}),A.STANDALONE)if(a.skin=window.redhlpSettings.skin||a.skin,~location.href.indexOf("&tpl=")&&~location.href.indexOf("&standalone")){var i=decodeURIComponent(location.href.split("&tpl=")[1].split("&")[0]);s.support.cors=!0,s.ajax({url:i,dataType:"html",success:function(e){n.fire("templateReceived",{template:e,isDefault:!1})}})}else n.fire("templateReceived",{template:"modern"==a.skin?D:P,isDefault:!0});m.send("templateRequest"),b.waitForTemplate(function(){if(r.show(),o.setOutput("#chatItself"),n.addEventListener("message.history",function(e){o.append(e)}),n.addEventListener("message.new",function(e){o.append(e)}),b.commands)for(var e=b.commands.length,t=0;e>t;t++)s(b.commands[t].applyTo)[b.commands[t].method].apply(s(b.commands[t].applyTo),b.commands[t].arguments);n.fire("message.getHistory"),c.initLanguage(),p.bind(),o.scrollBottom(),n.fire("ready")})};n.addEventListener("xmppConnecting",function(){if(n.fire("showLabel",{text:c.OPERATOR_CONNECTING,loading:!0}),!c.OPERATOR_CONNECTING){var e=!0,t=function(){return e&&c.OPERATOR_CONNECTING?void n.fire("showLabel",{text:c.OPERATOR_CONNECTING,loading:!0}):void(e&&setTimeout(t,100))};setTimeout(t,100)}var i=function(){o.hideLabel(),n.removeEventListener("operator",i)};n.addEventListener("operator",i)}),n.addEventListener("showXmppConnection",function(){if(n.fire("showLabel",{text:c.OPERATOR_CONNECTING,loading:!0}),!c.OPERATOR_CONNECTING){var e=!0,t=function(){return e&&c.OPERATOR_CONNECTING?void n.fire("showLabel",{text:c.OPERATOR_CONNECTING,loading:!0}):void(e&&setTimeout(t,100))};setTimeout(t,100)}var i=function(){o.hideLabel(),n.removeEventListener("operator",i)};n.addEventListener("operator",i)}),n.addEventListener("start",J),m.addHandler("invitation-history.shown",function(e){a.invitation.text=e.text,a.invitation.shown=!0,a.invitation.shownTime=+new Date;var t=JSON.parse(a.invitationHistory);t.push({id:e.id,text:e.text,kind:e.kind,time:e.time}),a.invitationHistory=JSON.stringify(t),W.sendToAll("invitationShown",{id:e.id,text:e.text,kind:e.kind,time:e.time})}),m.addHandler("invitation-history.accepted",function(e){for(var t=e.id,n=JSON.parse(a.invitationHistory),i=n.length-1;i>=0;i--)if(n[i].id===t){n[i].accepted=!0,a.invitationHistory=JSON.stringify(n);break}W.sendToAll("invitationAccepted",e.id)}),m.addHandler("invitation-history.declined",function(e){for(var t=e.id,n=JSON.parse(a.invitationHistory),i=n.length-1;i>=0;i--)if(n[i].id===t){n[i].accepted=!1,a.invitationHistory=JSON.stringify(n);break}W.sendToAll("invitationDeclined",e.id)}),m.addHandler("invitation.shown",function(e){a.invitation.text=e.text,a.invitation.shown=!0,a.invitation.shownTime=+new Date}),m.addHandler("invitation.id",function(e){a.invitation.id=e.id}),m.addHandler("invitation.accepted",function(){a.invitation.accepted=!0,a.invitation.reactionTime=+Date.now()}),m.addHandler("invitation.declined",function(){a.invitation.accepted=!1,a.invitation.reactionTime=+Date.now()}),m.addHandler("closeChat",function(){n.fire("closeChat")}),n.addEventListener("operator.show",function(){s("#chatItself .invitation").length||Y()}),n.addEventListener("operator",function(){n.fire("operator.show"),m.send("operator")}),m.addHandler("page.focus",function(e){if(a.IsPageFocused=e.focused,!a.IsPageFocused||!a.IsChatFocused){var t=a.IsPageFocused||a.IsChatFocused;a.IsFocused!==t&&(a.IsFocused=t,n.fire("focus.send"))}}),m.addHandler("focus.force",function(e){a.IsPageFocused=e.focused,a.IsFocused=!0,n.fire("focus.send")});var X=0;n.addEventListener("focus.send",function(){var e=function(){if(a.mouseOperators){var e,t=[],i=JSON.parse(a.mouseOperators);for(e in i)i.hasOwnProperty(e)&&i[e].html&&t.push(i[e].jid.extractNode());n.fire("cobrowseMessage",{action:"focus",data:{focused:a.IsFocused},to:t})}};clearTimeout(X),X=setTimeout(e,300)}),a.dispatcher.addEventListener("onCurrentTypedTextChanged",function(){l.typedTextChanged()}),n.addEventListener("xmppStart",function(){if(n.addEventListener("message.new",function(){O.update()}),n.addEventListener("authenticated",function(){r.show(),T.timeEnd("Connection")}),n.addEventListener("connected",function(){o.scrollBottom()}),n.addEventListener("highlight",function(e){e.url===A.CURRENT_URL||f.decodeUri(e.url)===A.CURRENT_URL?(h.play(),m.send("highlight",e),n.fire("cobrowseMessage",{action:"confirm",target:"highlight"})):(a.cachedEvent=JSON.stringify(e),n.fire("redirect",{type:"redirect",link:e.url,noFeedback:!0}))}),n.addEventListener("redirect",function(e){a.hideRedHelper?n.fire("redirectOK",e):(h.play(),o.showRedirectPrompt(e.link,e.noFeedback))}),n.addEventListener("redirectCancel",function(e){a.cachedEvent="",n.fire("cobrowseMessage",{action:"reject",target:"redirect"})}),n.addEventListener("redirectOK",function(e){var t=function(i){"confirm"===i.action&&"redirect"===i.target&&m.send("redirect",e),n.removeEventListener("cobrowseMessageSent",t)};n.addEventListener("cobrowseMessageSent",t),n.fire("cobrowseMessage",{action:"confirm",target:"redirect",data:{url:e.link}})}),a.cachedEvent){var e=JSON.parse(a.cachedEvent);a.cachedEvent="",Array.isArray(e)?s.each(e,function(e,t){t.isCached=!0,n.fire(t)}):(e.isCached=!0,n.fire(e))}n.removeAllEventListeners("xmppStart")}),a.onLoad(function(){function e(){a.currentOperator&&(Q?n.fire("operator.show"):n.addEventListener("ready",function(){n.fire("operator.show")}))}var t=function(){i.initializeChatWindowStage(),T.time("Connection");var e=a.onlineOperators;try{e=JSON.parse(e)}catch(t){}if(!a.isOnline&&e.length)for(var r=e.length,o=0;r>o;o++)if("offline"!==e[o].status&&(a.isPartiallyOnline=!0),"offline"!==e[o].status&&e[o].name.match(new RegExp("^"+a.currentOperator+"$","i"))){a.isOnline=!0,m.send("show");break}m.addHandler("urlChanged",function(e){A.CURRENT_TITLE=e.title,A.CURRENT_URL=e.url,n.fire("urlChanged")}),m.addHandler("clearUser",function(){n.fire("message.clearHistory",function(){a.clear(!0)})}),m.addHandler("hideOldMessages",function(){n.fire("message.clearHistory")}),m.addHandler("refreshOperator",function(){n.fire("refreshOperator"),n.fire("hideDepartments")}),O.start(),n.fire("sessionLoaded"),h.init(a.audioEnabled),h.soundCheck()||m.send("hideSoundButton"),n.addEventListener("message.received",function(){h.play()}),m.addHandler("soundOn",function(){a.audioEnabled=!0,h.turnOn()}),m.addHandler("soundOff",function(){a.audioEnabled=!1,h.turnOff()}),n.fire("start")};if(A.STANDALONE){var r=A.PARENT_URI;-1!=location.search.indexOf("page=")&&(r=location.search.split("page=").pop().split("&").shift(),r=decodeURIComponent(r));var o=location.href.split("//")[0];a.chatState=U.WINDOW;var l=o+(location.href.indexOf("://test.")>-1?"//test.nx.redhelper.ru":"//nx.redhelper.ru");l+="/nx/presence/"+A.CLIENT_NAME+"?page="+encodeURIComponent(r),a.vid>0&&(l+="&vid="+encodeURIComponent(a.vid)),s.ajax({dataType:"jsonp",async:!0,url:l,success:function(e){for(var n in e)if(e.hasOwnProperty(n)){if("extra"===n)continue;if(e[n]=JSON.parse(s("<div></div>").text(JSON.stringify(e[n])).html()),"true"===e[n]&&(e[n]=!0),"false"===e[n]&&(e[n]=!1),"operators"!==n)"offlineMode"===n?a.offlineEnabled="yes"===e[n]||"limited"===e.clientType:"clientType"===n?a.free=!("limited"!==e[n]||e.openApi&&parseInt(e.openApi,10)&&"false"!==e.openApi):"vid"===n||"status"!==n&&(a[n]=e[n]);else if(e.operators.length)for(var i=e.operators.length,r=0;i>r;r++)("online"===e.operators[r].status&&(void 0===e.operators[r].onPage||e.operators[r].onPage)||"offline"!==e.operators[r].status&&e.operators[r].name.match(new RegExp("^"+a.currentOperator+"$","i")))&&(!a.realDepartment||e.operators[r].departments&&e.operators[r].departments.indexOf(a.realDepartment)>-1)&&(a.isOnline=!0),"offline"===e.operators[r].status||void 0!==e.operators[r].onPage&&!e.operators[r].onPage||(a.isPartiallyOnline=!0)}if(e.extra){var o;for(o in e.extra)if(e.extra.hasOwnProperty(o))try{e.extra[o]=s("<div></div>").text(e.extra[o]).html(),a[o]=e.extra[o]}catch(c){}a.extraAuth=x.serialize(e.extra)}if("string"==typeof e.operators)try{e.operators=x.parse(e.operators)}catch(l){}a.onlineOperators=e.operators||[],s(t)}})}else s(t);n.addEventListener("ready",function(){Q=!0}),I.active(function(){a.isOnline||a.isPartiallyOnline?u.start():(n.fire("changeState"),n.removeAllEventListeners("refreshOperator"),n.addEventListener("refreshOperator",function(){I.actualize()}))}),I.inactive(function(){u.stop(),e()}),a.dispatcher.addEventListener("onCurrentOperatorChanged",function(t){e()});var d=function(){};I.election(function(){if(u.stop(),n.fire("hideLabel"),n.fire("showLabel",{text:c.OPERATOR_CONNECTING,loading:!0}),d=function(){n.fire("hideLabel")},n.addEventListener("showLabel",function(){d=function(){}}),!c.OPERATOR_CONNECTING){var e=!0,t=function(){return e&&c.OPERATOR_CONNECTING?void n.fire("showLabel",{text:c.OPERATOR_CONNECTING,loading:!0}):void(e&&setTimeout(t,100))};setTimeout(t,100)}}),I.electionEnd(function(){I.isLeader()||u.flushQueue(),d()}),I.forceElection()}),window.onbeforeunload=function(e){try{if(!a.mouseOperators)return;var t,n=[],i=JSON.parse(a.mouseOperators);for(t in i)i.hasOwnProperty(t)&&i[t].html&&n.push(i[t].jid);window.can_leave=!1;var r={chunked:!0,id:(new Date).getTime(),compressed:!1,utf8:!1,index:0,body:JSON.stringify({action:"unload",data:{unloaded:!0}}),chunks:1},o=JSON.stringify(r);o=q.encodeOld(o);for(var t in n){var s=$msg({to:n,jid:a.vid.toVisitorJid(),type:"chat",unload:"unload",content:"cobrowse"}).c("body").t(o).up();E._connection.send(s),E._connection.flush()}}catch(e){}}}),define("application/main",function(){});var rhLocal={define:define,require:require,requirejs:requirejs,protocol:rhGlobal.protocol||"http:",host:rhGlobal.host||"web.redhelper.ru",name:rhLocalName};try{var tag=document.getElementById("rhlpscrtg"),src=tag?tag.src:location.href;rhLocal.protocol=src.split("//")[0]||"http:";var host;host=src.split("?")[0].indexOf("/development/")>-1?"development":src.indexOf("/dev/")>-1?"dev":src.indexOf("/test.web.redhelper.ru/")>-1?"test.web.redhelper.ru":"web.redhelper.ru",rhLocal.host=host}catch(e){rhLocal.host="web.redhelper.ru",rhLocal.protocol="https:"}window[rhLocal.name]=rhLocal,require.config({waitSeconds:200,paths:{jquery:rhLocal.protocol+"//"+rhLocal.host+"/vendor/jquery-new.min"},map:{"*":{jquery:"jquery-private"},"jquery-private":{jquery:"jquery"}}}),define("../../../build/requirejs-production-config",function(){});for(var i=0;i<rhGlobal.modules.length;i++){var m=rhGlobal.modules[i];define(m.a,m.b,m.c)}}();
//# sourceMappingURL=maps/main(3).js.map
